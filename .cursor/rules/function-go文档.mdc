# function-go - AIåŸç”Ÿå…¨æ ˆå¼€å‘æ¡†æ¶

> **ä¸“ä¸ºå¤§æ¨¡å‹è®¾è®¡çš„Goå…¨æ ˆå¼€å‘æ¡†æ¶**
> AIåŸç”Ÿç»“æ„ä½“æ ‡ç­¾ç³»ç»Ÿ | ä¸€ä¸ªæ–‡ä»¶ = ä¸€ä¸ªå®Œæ•´Webåº”ç”¨ | å¤§æ¨¡å‹ç”Ÿæˆä»£ç ç›´æ¥ç¼–è¯‘éƒ¨ç½² | æ¡†æ¶å†…éƒ¨æœ‰è¿è¡Œå…¥å£ï¼Œä¸“æ³¨ä¸šåŠ¡å‡½æ•°

## ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿ - å¤§æ¨¡å‹ä»£ç ç”Ÿæˆæ ¸å¿ƒ

### è®¾è®¡ç†å¿µ

function-goé€šè¿‡ç»“æ„ä½“æ ‡ç­¾å®ç°**å£°æ˜å¼é…ç½®**ï¼Œè®©å¤§æ¨¡å‹èƒ½å¤Ÿï¼š

- **é›¶æ ·æ¿ä»£ç **ï¼šä¸€ä¸ªç»“æ„ä½“ = å®Œæ•´Webåº”ç”¨
- **AIå‹å¥½**ï¼šæ ‡ç­¾å³é…ç½®ï¼Œå¤§æ¨¡å‹ç›´æ¥ç†è§£
- **ä¸šåŠ¡å¯¼å‘**ï¼šä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæ¡†æ¶å¤„ç†æŠ€æœ¯ç»†èŠ‚

### ğŸ’¡ å¤§æ¨¡å‹ä½¿ç”¨æŒ‡å—

**è®°ä½ï¼šæ ‡ç­¾å°±æ˜¯é…ç½®ï¼Œé…ç½®å°±æ˜¯åŠŸèƒ½ï¼**

| æ ‡ç­¾ | ä½œç”¨         | å¤§æ¨¡å‹ä½¿ç”¨åœºæ™¯   |
| ------ | -------------- | ------------------ |
| `runner:"name:å­—æ®µå"`     | å‰ç«¯æ˜¾ç¤ºåç§° | æ‰€æœ‰å­—æ®µéƒ½éœ€è¦   |
| `widget:"type:ç»„ä»¶ç±»å‹"`     | UIç»„ä»¶é€‰æ‹©   | æ ¹æ®æ•°æ®ç±»å‹é€‰æ‹© |
| `validate:"required"`     | æ•°æ®éªŒè¯     | å¿…å¡«å­—æ®µå¿…é¡»åŠ    |
| `search:"like"`     | æœç´¢åŠŸèƒ½     | éœ€è¦æœç´¢çš„å­—æ®µ   |

### å¿«é€Ÿä¸Šæ‰‹æ¨¡æ¿

```go
// å¤§æ¨¡å‹ä»£ç ç”Ÿæˆæ¨¡æ¿
type YourModel struct {
    ID        int    `json:"id" gorm:"primaryKey" runner:"name:ID" permission:"read"` //è¿™ä¸ªå­—æ®µåªè¯»
    Name      string `json:"name" runner:"name:åç§°" widget:"type:input" search:"like" validate:"required"`
    Status    string `json:"status" runner:"name:çŠ¶æ€" widget:"type:select;options:å¯ç”¨,ç¦ç”¨" search:"in"`
    CreatedAt int64  `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" permission:"read"`
}
```

#### 2. **UIæ¸²æŸ“**

- **widgetæ ‡ç­¾**ï¼šé€‰æ‹©æœ€åˆé€‚çš„UIç»„ä»¶è¿›è¡Œæ¸²æŸ“
- **dataæ ‡ç­¾**ï¼šè‡ªåŠ¨è®¾ç½®é»˜è®¤å€¼ã€ç¤ºä¾‹å€¼ã€åŠ¨æ€å€¼ï¼Œæ ¼å¼åŒ–çš„å€¼ï¼Œ
- **runneræ ‡ç­¾**ï¼šè‡ªåŠ¨ç”Ÿæˆä¸­æ–‡æ ‡ç­¾ã€å•ä½ã€æ˜¾ç¤ºåç§°

#### 3. **æ•°æ®éªŒè¯å¼•æ“**

- **validateæ ‡ç­¾**ï¼šè‡ªåŠ¨ç”Ÿæˆå‰ç«¯å’Œåç«¯éªŒè¯è§„åˆ™
- **searchæ ‡ç­¾**ï¼šè‡ªåŠ¨ç”Ÿæˆæœç´¢å’Œè¿‡æ»¤åŠŸèƒ½
- **permissionæ ‡ç­¾**ï¼šè‡ªåŠ¨æ§åˆ¶å­—æ®µåœ¨ä¸åŒåœºæ™¯çš„æ˜¾ç¤ºæƒé™

#### 4. **æ•°æ®åº“æ“ä½œè‡ªåŠ¨åŒ–**

- **gormæ ‡ç­¾**ï¼šè‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“è¡¨ç»“æ„
- **CreateTables**ï¼šæœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨å»ºè¡¨
- **AutoCrudTable**ï¼šè‡ªåŠ¨ç”Ÿæˆå¢åˆ æ”¹æŸ¥æ“ä½œ

#### 5. **å›è°ƒå‡½æ•°é›†æˆ**

- **OnInputFuzzy**ï¼šè‡ªåŠ¨é›†æˆæ¨¡ç³Šæœç´¢å’Œèšåˆè®¡ç®—
- **OnInputValidate**ï¼šè‡ªåŠ¨é›†æˆå®æ—¶å­—æ®µéªŒè¯
- **OnTableAddRows**ï¼štableå‡½æ•°æ–°å¢è®°å½•å›è°ƒ
- **OnTableUpdateRows** tableå‡½æ•°æ›´æ–°è®°å½•å›è°ƒ
- **OnTableDeleteRows** tableå‡½æ•°åˆ é™¤è®°å½•å›è°ƒ

### ğŸ”„ æ ‡ç­¾ç³»ç»Ÿçš„å·¥ä½œæµç¨‹

```
ç»“æ„ä½“å®šä¹‰ â†’ æ ‡ç­¾è§£æ â†’ ä»£ç ç”Ÿæˆ â†’ è¿è¡Œæ—¶æ‰§è¡Œ
     â†“           â†“         â†“         â†“
  ä¸šåŠ¡æ¨¡å‹   é…ç½®ä¿¡æ¯   å‰ç«¯ç•Œé¢   å®Œæ•´åº”ç”¨
  æ•°æ®åº“è¡¨   éªŒè¯è§„åˆ™   APIæ¥å£   ä¸šåŠ¡é€»è¾‘
```

### ğŸŒŸ æ ‡ç­¾ç³»ç»Ÿçš„ä¼˜åŠ¿

| ä¼ ç»Ÿå¼€å‘æ–¹å¼     | function-goæ ‡ç­¾æ–¹å¼ |
| ------------------ | --------------------- |
| æ‰‹åŠ¨ç¼–å†™CRUDä»£ç  | è‡ªåŠ¨ç”ŸæˆCRUDä»£ç     |
| æ‰‹åŠ¨ç¼–å†™éªŒè¯é€»è¾‘ | æ ‡ç­¾å£°æ˜éªŒè¯è§„åˆ™    |
| æ‰‹åŠ¨è®¾è®¡UIç•Œé¢   | è‡ªåŠ¨æ¸²æŸ“UIç•Œé¢      |
| æ‰‹åŠ¨ç®¡ç†æ•°æ®åº“   | è‡ªåŠ¨ç®¡ç†æ•°æ®åº“      |
| ä»£ç é‡å¤§ã€æ˜“å‡ºé”™ | ä»£ç ç®€æ´ã€é›¶é”™è¯¯    |

é€šè¿‡æ ‡ç­¾ç³»ç»Ÿï¼Œå¼€å‘è€…åªéœ€è¦å…³æ³¨**ä¸šåŠ¡é€»è¾‘**ï¼Œæ¡†æ¶è‡ªåŠ¨å¤„ç†æ‰€æœ‰**æŠ€æœ¯ç»†èŠ‚**ï¼ŒçœŸæ­£å®ç°äº†"ä¸€ä¸ªæ–‡ä»¶ = ä¸€ä¸ªå®Œæ•´Webåº”ç”¨"çš„æ„¿æ™¯ã€‚

### æ ‡ç­¾é¡ºåºå»ºè®®

```
json â†’ gorm â†’ runner â†’ widget â†’ data â†’ search â†’ permission â†’ validate
```

### æ ¸å¿ƒæ ‡ç­¾è¯´æ˜

#### runneræ ‡ç­¾ - ä¸šåŠ¡é€»è¾‘é…ç½®

| å±æ€§     | æ ¼å¼ | ç¤ºä¾‹ | è¯´æ˜                         |
| ---------- | ------ | ------ | ------------------------------ |
| å­—æ®µåç§° | `name:æ˜¾ç¤ºåç§°`     | `runner:"name:ç”¨æˆ·å"`     | è®¾ç½®å­—æ®µåœ¨å‰ç«¯çš„æ˜¾ç¤ºåç§°     |
| å­—æ®µå•ä½ | `desc:å­—æ®µä»‹ç»`     | `runner:"name:å¹´é¾„;desc:å¹´é¾„0-100"`     | è®¾ç½®å­—æ®µçš„è¯¦ç»†ä»‹ç»ï¼ˆéå¿…è¦ï¼‰ |

#### widgetæ ‡ç­¾ - UIç»„ä»¶é…ç½®

| å±æ€§     | æ ¼å¼ | ç¤ºä¾‹ | è¯´æ˜           |
| ---------- | ------ | ------ | ---------------- |
| ç»„ä»¶ç±»å‹ | `type:ç»„ä»¶ç±»å‹`     | `widget:"type:input"`     | è®¾ç½®UIç»„ä»¶ç±»å‹ |

#### dataæ ‡ç­¾ - æ•°æ®å’Œå€¼é…ç½®

| åŠŸèƒ½       | æ ¼å¼ | ç¤ºä¾‹ | è¯´æ˜               |
| ------------ | ------ | ------ | -------------------- |
| é»˜è®¤å€¼     | `default_value:å€¼`     | `data:"default_value:é»˜è®¤å€¼"`     | è®¾ç½®å­—æ®µé»˜è®¤å€¼     |
| ç¤ºä¾‹å€¼     | `example:ç¤ºä¾‹å€¼`     | `data:"example:ç¤ºä¾‹æ–‡æœ¬"`     | è®¾ç½®ç¤ºä¾‹å€¼         |
| åŠ¨æ€é»˜è®¤å€¼ | `default_value:$å˜é‡`     | `data:"default_value:$now"`     | ä½¿ç”¨å˜é‡ä½œä¸ºé»˜è®¤å€¼ |
| æ ¼å¼åŒ–     | `format:æ ¼å¼åŒ–ç±»å‹`     | `format:markdown`     | `è®¾ç½®æ ¼å¼åŒ–ç±»å‹ï¼Œcsvæˆ–è€…markdown`                   |

#### validateæ ‡ç­¾ - éªŒè¯è§„åˆ™

| è§„åˆ™     | æ ¼å¼ | ç¤ºä¾‹ | è¯´æ˜         |
| ---------- | ------ | ------ | -------------- |
| å¿…å¡«éªŒè¯ | `required`     | `validate:"required"`     | å­—æ®µå¿…å¡«     |
| é•¿åº¦éªŒè¯ | `min=å€¼,max=å€¼`     | `validate:"min=2,max=50"`     | é•¿åº¦èŒƒå›´éªŒè¯ |
| æ•°å€¼éªŒè¯ | `min=å€¼,max=å€¼`     | `validate:"min=1,max=120"`     | æ•°å€¼èŒƒå›´éªŒè¯ |
| æšä¸¾éªŒè¯ | `oneof=å€¼1 å€¼2`     | `validate:"oneof=ç”· å¥³"`     | æšä¸¾å€¼éªŒè¯   |

#### searchæ ‡ç­¾ - æœç´¢é…ç½®ï¼ˆä»…tableå‡½æ•°ï¼‰

| æœç´¢ç±»å‹ | æ ¼å¼ | ç¤ºä¾‹ | è¯´æ˜                       |
| ---------- | ------ | ------ | ---------------------------- |
| æ¨¡ç³Šæœç´¢ | `like`     | `search:"like"`     | å¯ç”¨æ¨¡ç³Šæœç´¢               |
| ç²¾ç¡®æœç´¢ | `eq`     | `search:"eq"`     | å¯ç”¨ç²¾ç¡®æœç´¢               |
| åŒºé—´æœç´¢ | `gte,lte`     | `search:"gte,lte"`     | å¯ç”¨å¤§äºç­‰äºã€å°äºç­‰äºæœç´¢ |
| å¤šé€‰æœç´¢ | `in`     | `search:"in"`     | å¯ç”¨å¤šé€‰æœç´¢               |

#### permissionæ ‡ç­¾ - æƒé™æ§åˆ¶ï¼ˆä»…tableå‡½æ•°ï¼‰

| æƒé™ç±»å‹ | æ ¼å¼ | ç¤ºä¾‹   | è¯´æ˜                   |
| ---------- | ------ | -------- | ------------------------ |
| ä»…å¯è¯»   | `read`     | `permission:"read"`       | ä»…åˆ—è¡¨æ˜¾ç¤ºï¼Œä¸èƒ½ç¼–è¾‘   |
| ä»…å¯åˆ›å»º | `create`     | `permission:"create"`       | ä»…æ–°å¢æ˜¾ç¤ºï¼Œåˆ—è¡¨ä¸æ˜¾ç¤º |
| ä»…å¯æ›´æ–° | `update`     | `permission:"update"`       | ä»…ç¼–è¾‘æ˜¾ç¤ºï¼Œåˆ—è¡¨ä¸æ˜¾ç¤º |
| å…¨æƒé™   | ä¸å†™ | æ— æ ‡ç­¾ | åˆ—è¡¨ã€æ–°å¢ã€ç¼–è¾‘éƒ½æ˜¾ç¤º |

## ğŸ§© ç»„ä»¶ç³»ç»Ÿ

### åŸºç¡€è¾“å…¥ç»„ä»¶

#### inputç»„ä»¶ - æ–‡æœ¬è¾“å…¥

| ç±»å‹     | é…ç½® | ç¤ºä¾‹ | è¯´æ˜           |
| ---------- | ------ | ------ | ---------------- |
| å•è¡Œæ–‡æœ¬ | `type:input`     | `widget:"type:input"`     | åŸºç¡€æ–‡æœ¬è¾“å…¥æ¡† |
| å¤šè¡Œæ–‡æœ¬ | `mode:text_area`     | `widget:"type:input;mode:text_area"`     | å¤šè¡Œæ–‡æœ¬åŒºåŸŸ   |
| å¯†ç è¾“å…¥ | `mode:password`     | `widget:"type:input;mode:password"`     | å¯†ç è¾“å…¥æ¡†     |

#### numberç»„ä»¶ - æ•°å­—è¾“å…¥

| ç±»å‹     | é…ç½® | ç¤ºä¾‹ | è¯´æ˜         |
| ---------- | ------ | ------ | -------------- |
| æ•´æ•°è¾“å…¥ | `type:number`     | `widget:"type:number;min:1;max:120;unit:å²"`     | æ•´æ•°è¾“å…¥æ¡†   |
| å°æ•°è¾“å…¥ | `precision:å°æ•°ä½`     | `widget:"type:number;min:0;precision:2;prefix:ï¿¥"`     | å°æ•°è¾“å…¥æ¡†   |
| ç™¾åˆ†æ¯”   | `suffix:%`     | `widget:"type:number;min:0;max:100;precision:1;suffix:%"`     | ç™¾åˆ†æ¯”è¾“å…¥æ¡† |

#### selectç»„ä»¶ - ä¸‹æ‹‰é€‰æ‹©

| ç±»å‹     | é…ç½® | ç¤ºä¾‹ | è¯´æ˜       |
| ---------- | ------ | ------ | ------------ |
| å•é€‰ä¸‹æ‹‰ | `type:select`     | `widget:"type:select;options:ç”·,å¥³"`     | å•é€‰ä¸‹æ‹‰æ¡† |
| å¤šé€‰ä¸‹æ‹‰ | `multiple:true`     | `widget:"type:select;options:æŠ€æœ¯,äº§å“,è®¾è®¡;multiple:true"`     | å¤šé€‰ä¸‹æ‹‰æ¡† |

#### datetimeç»„ä»¶ - æ—¥æœŸæ—¶é—´

| ç±»å‹     | é…ç½® | ç¤ºä¾‹ | è¯´æ˜           |
| ---------- | ------ | ------ | ---------------- |
| æ—¥æœŸé€‰æ‹© | `kind:date`     | `widget:"type:datetime;kind:date;format:yyyy-MM-dd"`     | æ—¥æœŸé€‰æ‹©å™¨     |
| æ—¶é—´é€‰æ‹© | `kind:time`     | `widget:"type:datetime;kind:time;format:HH:mm"`     | æ—¶é—´é€‰æ‹©å™¨     |
| æ—¥æœŸæ—¶é—´ | `kind:datetime`     | `widget:"type:datetime;kind:datetime"`     | æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ |
| æ—¥æœŸèŒƒå›´ | `kind:daterange`     | `widget:"type:datetime;kind:daterange;format:yyyy-MM-dd"`     | æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ |

### é«˜çº§ç»„ä»¶

#### multiselectç»„ä»¶ - å¤šé€‰ç»„ä»¶

| é…ç½®         | ç¤ºä¾‹ | è¯´æ˜               |
| -------------- | ------ | -------------------- |
| é™æ€å¤šé€‰     | `widget:"type:multiselect;options:ç´§æ€¥,é‡è¦,API,UI"`     | å›ºå®šé€‰é¡¹å¤šé€‰       |
| å¯åˆ›å»ºæ–°é€‰é¡¹ | `widget:"type:multiselect;options:Java,Python,Go;allow_create:true"`     | æ”¯æŒè‡ªå®šä¹‰åˆ›å»ºé€‰é¡¹ |

#### colorç»„ä»¶ - é¢œè‰²é€‰æ‹©å™¨

| æ ¼å¼     | é…ç½® | ç¤ºä¾‹ | è¯´æ˜         |
| ---------- | ------ | ------ | -------------- |
| Hexæ ¼å¼  | `format:hex`     | `widget:"type:color;format:hex;show_alpha:false"`     | 6ä½hexé¢œè‰²   |
| RGBAæ ¼å¼ | `format:rgba`     | `widget:"type:color;format:rgba;show_alpha:true"`     | RGBAé¢œè‰²æ ¼å¼ |
| HSLæ ¼å¼  | `format:hsl`     | `widget:"type:color;format:hsl;show_alpha:false"`     | HSLé¢œè‰²æ ¼å¼  |

#### file_uploadç»„ä»¶ - æ–‡ä»¶ä¸Šä¼ 

| é…ç½®       | ç¤ºä¾‹ | è¯´æ˜       |
| ------------ | ------ | ------------ |
| å•æ–‡ä»¶ä¸Šä¼  | `widget:"type:file_upload;accept:.jpg,.png;max_size:5MB"`     | å•æ–‡ä»¶ä¸Šä¼  |
| å¤šæ–‡ä»¶ä¸Šä¼  | `widget:"type:file_upload;accept:.pdf,.doc;multiple:true;max_size:10MB"`     | å¤šæ–‡ä»¶ä¸Šä¼  |

#### listç»„ä»¶ - åˆ—è¡¨è¾“å…¥

| ç±»å‹     | ç¤ºä¾‹ | è¯´æ˜             |
| ---------- | ------ | ------------------ |
| ç®€å•åˆ—è¡¨ | `widget:"type:list"`     | å­—ç¬¦ä¸²æˆ–æ•°å­—åˆ—è¡¨ |
| å¤æ‚åˆ—è¡¨ | `widget:"type:list"`     | ç»“æ„ä½“åˆ—è¡¨       |

#### formç»„ä»¶ - åµŒå¥—è¡¨å•

| ç¤ºä¾‹ | è¯´æ˜                               |
| ------ | ------------------------------------ |
| `widget:"type:form"`     | åµŒå¥—è¡¨å•ç»“æ„ï¼Œå¯¹åº”æ•°æ®ç»“æ„æ˜¯ç»“æ„ä½“ |

### å…¶ä»–ç»„ä»¶

#### switchç»„ä»¶ - å¼€å…³

| é…ç½®       | ç¤ºä¾‹ | è¯´æ˜           |
| ------------ | ------ | ---------------- |
| åŸºç¡€å¼€å…³   | `widget:"type:switch"`     | å¸ƒå°”å€¼å¼€å…³     |
| è‡ªå®šä¹‰æ ‡ç­¾ | `widget:"type:switch;true_label:å¯ç”¨;false_label:ç¦ç”¨"`     | è‡ªå®šä¹‰å¼€å…³æ ‡ç­¾ |

#### radioç»„ä»¶ - å•é€‰æ¡†

| é…ç½®       | ç¤ºä¾‹ | è¯´æ˜               |
| ------------ | ------ | -------------------- |
| åŸºç¡€å•é€‰æ¡† | `widget:"type:radio;options:ç”·,å¥³"`     | å•é€‰æŒ‰é’®ç»„         |
| æ°´å¹³æ’åˆ—   | `widget:"type:radio;options:ç”·,å¥³;direction:horizontal"`     | æ°´å¹³æ’åˆ—çš„å•é€‰æŒ‰é’® |

#### checkboxç»„ä»¶ - å¤é€‰æ¡†

| é…ç½®       | ç¤ºä¾‹ | è¯´æ˜         |
| ------------ | ------ | -------------- |
| åŸºç¡€å¤é€‰æ¡† | `widget:"type:checkbox;options:é˜…è¯»,éŸ³ä¹,è¿åŠ¨"`     | å¤šé€‰å¤é€‰æ¡†ç»„ |

#### sliderç»„ä»¶ - æ»‘å—

| é…ç½®     | ç¤ºä¾‹ | è¯´æ˜             |
| ---------- | ------ | ------------------ |
| æ•°å€¼æ»‘å— | `widget:"type:slider;min:0;max:100;unit:%"`     | æ•°å€¼èŒƒå›´æ»‘å—     |
| è¯„åˆ†æ»‘å— | `widget:"type:slider;min:1;max:5;step:0.5;unit:åˆ†"`     | å¸¦æ­¥è¿›çš„è¯„åˆ†æ»‘å— |

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€å­—æ®µé…ç½®

## Formå‡½æ•°æ¨¡å‹ç¤ºä¾‹ - å¤§æ¨¡å‹ä»£ç ç”Ÿæˆæ¨¡æ¿

#### ç”¨æˆ·æ³¨å†Œæ¨¡å‹

```go
// è¯·æ±‚ç»“æ„ä½“ - ç”¨æˆ·è¾“å…¥
type UserRegisterReq struct {
    // åŸºç¡€ä¿¡æ¯
    Username string `json:"username" runner:"name:ç”¨æˆ·å" widget:"type:input" data:"example:john_doe" validate:"required,min=3,max=20"`
    Password string `json:"password" runner:"name:å¯†ç " widget:"type:input;mode:password" data:"example:123456" validate:"required,min=6,max=20"`
    Email    string `json:"email" runner:"name:é‚®ç®±" widget:"type:input" data:"example:john@example.com" validate:"required,email"`
    
    // ä¸ªäººä¿¡æ¯
    RealName string `json:"real_name" runner:"name:çœŸå®å§“å" widget:"type:input" data:"example:å¼ ä¸‰" validate:"required,min=2,max=20"`
    Age      int    `json:"age" runner:"name:å¹´é¾„" widget:"type:number;min:18;max:65;unit:å²" data:"example:25" validate:"required,min=18,max=65"`
    Gender   string `json:"gender" runner:"name:æ€§åˆ«" widget:"type:radio;options:ç”·,å¥³;direction:horizontal" data:"example:ç”·" validate:"required,oneof=ç”· å¥³"`
    
    // å·¥ä½œä¿¡æ¯
    Department string `json:"department" runner:"name:éƒ¨é—¨" widget:"type:select;options:æŠ€æœ¯éƒ¨,äº§å“éƒ¨,è®¾è®¡éƒ¨,è¿è¥éƒ¨" data:"default_value:æŠ€æœ¯éƒ¨" validate:"required"`
    Position   string `json:"position" runner:"name:èŒä½" widget:"type:input" data:"example:è½¯ä»¶å·¥ç¨‹å¸ˆ" validate:"required"`
    Salary     int    `json:"salary" runner:"name:æœŸæœ›è–ªèµ„" widget:"type:number;min:3000;max:50000;unit:å…ƒ" data:"example:15000" validate:"required,min=3000,max=50000"`
    
    // æŠ€èƒ½æ ‡ç­¾
    Skills []string `json:"skills" runner:"name:æŠ€èƒ½æ ‡ç­¾" widget:"type:multiselect;options:Java,Python,Go,JavaScript,React,Vue" data:"example:Java,Go" validate:"required,min=1"`
    
    // é™„ä»¶ä¸Šä¼ 
    Resume *files.Files `json:"resume" runner:"name:ç®€å†" widget:"type:file_upload;accept:.pdf,.doc,.docx;max_size:10MB" validate:"required"`
    Avatar *files.Files `json:"avatar" runner:"name:å¤´åƒ" widget:"type:file_upload;accept:.jpg,.png,.gif;max_size:5MB"`
    
    // å…¶ä»–ä¿¡æ¯
    Bio       string `json:"bio" runner:"name:ä¸ªäººç®€ä»‹" widget:"type:input;mode:text_area" data:"example:çƒ­çˆ±ç¼–ç¨‹ï¼Œæœ‰3å¹´å¼€å‘ç»éªŒ"`
    AgreeTerms bool  `json:"agree_terms" runner:"name:åŒæ„æ¡æ¬¾" widget:"type:switch;true_label:åŒæ„;false_label:ä¸åŒæ„" data:"example:true" validate:"required"`
}

// å“åº”ç»“æ„ä½“ - å¤„ç†ç»“æœ
type UserRegisterResp struct {
    // å¤„ç†ç»“æœ
    Success   bool   `json:"success" runner:"name:æ˜¯å¦æˆåŠŸ" widget:"type:switch;true_label:æˆåŠŸ;false_label:å¤±è´¥"`
    Message   string `json:"message" runner:"name:å¤„ç†ç»“æœ" widget:"type:input;mode:text_area"`
    
    // ç”¨æˆ·ä¿¡æ¯
    UserID    int    `json:"user_id" runner:"name:ç”¨æˆ·ID" widget:"type:number"`
    Username  string `json:"username" runner:"name:ç”¨æˆ·å" widget:"type:input"`
    
    // ç³»ç»Ÿä¿¡æ¯
    CreatedAt int64  `json:"created_at" runner:"name:æ³¨å†Œæ—¶é—´" widget:"type:datetime;kind:datetime"`
    Token     string `json:"token" runner:"name:è®¿é—®ä»¤ç‰Œ" widget:"type:input;mode:password"`
}
```

#### é‡‡è´­ç”³è¯·æ¨¡å‹

```go
// è¯·æ±‚ç»“æ„ä½“ - é‡‡è´­ç”³è¯·
type PurchaseReq struct {
    // åŸºç¡€ä¿¡æ¯
    Title       string `json:"title" runner:"name:é‡‡è´­æ ‡é¢˜" widget:"type:input" data:"example:åŠå…¬ç”¨å“é‡‡è´­" validate:"required,min=5,max=100"`
    Department  string `json:"department" runner:"name:ç”³è¯·éƒ¨é—¨" widget:"type:select;options:æŠ€æœ¯éƒ¨,äº§å“éƒ¨,è®¾è®¡éƒ¨,è¿è¥éƒ¨" validate:"required"`
    Priority    string `json:"priority" runner:"name:ä¼˜å…ˆçº§" widget:"type:select;options:ä½,ä¸­,é«˜,ç´§æ€¥" data:"default_value:ä¸­" validate:"required"`
    
    // ä¾›åº”å•†ä¿¡æ¯
    SupplierID int `json:"supplier_id" runner:"name:ä¾›åº”å•†" widget:"type:select" validate:"required"`
    
    // é‡‡è´­å•†å“åˆ—è¡¨
    Items []PurchaseItem `json:"items" runner:"name:é‡‡è´­å•†å“" widget:"type:list" validate:"required,min=1"`
    
    // å…¶ä»–ä¿¡æ¯
    ExpectedDate int64  `json:"expected_date" runner:"name:æœŸæœ›åˆ°è´§æ—¥æœŸ" widget:"type:datetime;kind:date;format:yyyy-MM-dd" validate:"required"`
    Remarks      string `json:"remarks" runner:"name:å¤‡æ³¨è¯´æ˜" widget:"type:input;mode:text_area"`
}

// é‡‡è´­å•†å“é¡¹
type PurchaseItem struct {
    ProductID int     `json:"product_id" runner:"name:å•†å“" widget:"type:select" validate:"required"`
    Quantity  int     `json:"quantity" runner:"name:æ•°é‡" widget:"type:number;min:1" data:"default_value:1" validate:"required,min=1"`
    UnitPrice float64 `json:"unit_price" runner:"name:å•ä»·" widget:"type:number;min:0;precision:2;prefix:ï¿¥" validate:"required,min=0"`
    Remarks   string  `json:"remarks" runner:"name:å¤‡æ³¨" widget:"type:input"`
}

// å“åº”ç»“æ„ä½“ - é‡‡è´­ç»“æœ
type PurchaseResp struct {
    // å¤„ç†ç»“æœ
    Success      bool   `json:"success" runner:"name:æ˜¯å¦æˆåŠŸ" widget:"type:switch;true_label:æˆåŠŸ;false_label:å¤±è´¥"`
    Message      string `json:"message" runner:"name:å¤„ç†ç»“æœ" widget:"type:input;mode:text_area"`
    
    // é‡‡è´­ä¿¡æ¯
    PurchaseID   int     `json:"purchase_id" runner:"name:é‡‡è´­å•å·" widget:"type:number"`
    TotalAmount  float64 `json:"total_amount" runner:"name:æ€»é‡‘é¢" widget:"type:number;precision:2;prefix:ï¿¥"`
    TotalItems   int     `json:"total_items" runner:"name:å•†å“ç§ç±»" widget:"type:number"`
    
    // çŠ¶æ€ä¿¡æ¯
    Status       string `json:"status" runner:"name:é‡‡è´­çŠ¶æ€" widget:"type:input"`
    CreatedAt    int64  `json:"created_at" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime"`
}
```

### **2. Tableå‡½æ•°æ¨¡å‹ç¤ºä¾‹**

#### ç”¨æˆ·ç®¡ç†æ¨¡å‹

```go
// ç”¨æˆ·æ•°æ®æ¨¡å‹ - è‡ªåŠ¨å»ºè¡¨
type CRMUser struct {
    // ç³»ç»Ÿå­—æ®µ
    ID        int            `json:"id" gorm:"primaryKey;autoIncrement" runner:"name:ç”¨æˆ·ID" permission:"read"`
    CreatedAt int64          `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
    UpdatedAt int64          `json:"updated_at" gorm:"autoUpdateTime:milli" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
    DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index" runner:"-"`

    // åŸºç¡€ä¿¡æ¯
    Username string `json:"username" gorm:"column:username;uniqueIndex" runner:"name:ç”¨æˆ·å" widget:"type:input" search:"like" validate:"required,min=3,max=20"`
    Email    string `json:"email" gorm:"column:email;uniqueIndex" runner:"name:é‚®ç®±" widget:"type:input" search:"like" validate:"required,email"`
    Phone    string `json:"phone" gorm:"column:phone" runner:"name:æ‰‹æœºå·" widget:"type:input" search:"like" validate:"required,min=11,max=11"`
    
    // ä¸ªäººä¿¡æ¯
    RealName   string `json:"real_name" gorm:"column:real_name" runner:"name:çœŸå®å§“å" widget:"type:input" search:"like" validate:"required,min=2,max=20"`
    Age        int    `json:"age" gorm:"column:age" runner:"name:å¹´é¾„" widget:"type:number;min:18;max:65;unit:å²" search:"gte,lte" validate:"required,min=18,max=65"`
    Gender     string `json:"gender" gorm:"column:gender" runner:"name:æ€§åˆ«" widget:"type:select;options:ç”·,å¥³" search:"in" validate:"required,oneof=ç”· å¥³"`
    Avatar     string `json:"avatar" gorm:"column:avatar" runner:"name:å¤´åƒ" widget:"type:input"`
    
    // å·¥ä½œä¿¡æ¯
    Department string `json:"department" gorm:"column:department" runner:"name:éƒ¨é—¨" widget:"type:select;options:æŠ€æœ¯éƒ¨,äº§å“éƒ¨,è®¾è®¡éƒ¨,è¿è¥éƒ¨" search:"in" validate:"required"`
    Position   string `json:"position" gorm:"column:position" runner:"name:èŒä½" widget:"type:input" search:"like" validate:"required"`
    Salary     int    `json:"salary" gorm:"column:salary" runner:"name:è–ªèµ„" widget:"type:number;min:3000;max:50000;unit:å…ƒ" search:"gte,lte" validate:"required,min=3000,max=50000"`
    
    // çŠ¶æ€ä¿¡æ¯
    Status     string `json:"status" gorm:"column:status" runner:"name:çŠ¶æ€" widget:"type:select;options:åœ¨èŒ,ç¦»èŒ,è¯•ç”¨æœŸ" data:"default_value:åœ¨èŒ" search:"in" validate:"required"`
    IsActive   bool   `json:"is_active" gorm:"column:is_active" runner:"name:æ˜¯å¦å¯ç”¨" widget:"type:switch;true_label:å¯ç”¨;false_label:ç¦ç”¨" data:"default_value:true" search:"eq" validate:"required"`
    
    // æ•æ„Ÿä¿¡æ¯ - ä»…æ–°å¢å’Œç¼–è¾‘æ—¶æ˜¾ç¤º
    Password   string `json:"password" gorm:"column:password" runner:"name:å¯†ç " widget:"type:input;mode:password" permission:"create,update"`
}

func (User) TableName() string { return "crm_user" }

// è¯·æ±‚ç»“æ„ä½“ - åˆ†é¡µæœç´¢
type CRMUserListReq struct {
    query.SearchFilterPageReq `runner:"-"`
    
    // è‡ªå®šä¹‰æœç´¢å­—æ®µï¼Œè¿™é‡Œçš„å­—æ®µæ˜¯ä¸å­˜åœ¨äºä¸Šé¢è¡¨ä¸­çš„å­—æ®µï¼Œå­˜åœ¨è¡¨ä¸­çš„å­—æ®µå¯ä»¥ç›´æ¥æ‰“æ ‡ç­¾æ”¯æŒå„ç§æœç´¢ï¼Œ
	//ä¸‹é¢çš„æœç´¢å­—æ®µä¸€èˆ¬æ˜¯joinå­—æ®µï¼Œä¾‹å¦‚ ç”¨æˆ·å…³è”ç»„ç»‡è¡¨ï¼Œç„¶åä¸‹é¢å¯ä»¥ç”¨ç»„ç»‡è¡¨çš„å­—æ®µï¼Œç„¶ååœ¨å¤„ç†å‡½æ•°ç”¨è¯¥å­—æ®µè¿›è¡Œè¿è¡¨æŸ¥è¯¢
    OrgName string `json:"org_name" runner:"name:ç»„ç»‡åç§°" widget:"type:input" search:"like"`
}
```

#### äº§å“ç®¡ç†æ¨¡å‹

```go
// äº§å“æ•°æ®æ¨¡å‹ - è‡ªåŠ¨å»ºè¡¨
type Product struct {
    // ç³»ç»Ÿå­—æ®µ
    ID        int            `json:"id" gorm:"primaryKey;autoIncrement" runner:"name:äº§å“ID" permission:"read"`
    CreatedAt int64          `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
    UpdatedAt int64          `json:"updated_at" gorm:"autoUpdateTime:milli" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
    DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index" runner:"-"`

    // åŸºç¡€ä¿¡æ¯
    Name        string  `json:"name" gorm:"column:name" runner:"name:äº§å“åç§°" widget:"type:input" search:"like" validate:"required,min=2,max=100"`
    Code        string  `json:"code" gorm:"column:code;uniqueIndex" runner:"name:äº§å“ç¼–ç " widget:"type:input" search:"like" validate:"required,min=3,max=20"`
    Category    string  `json:"category" gorm:"column:category" runner:"name:äº§å“åˆ†ç±»" widget:"type:select;options:ç”µå­äº§å“,æœè£…,é£Ÿå“,å®¶å±…,å…¶ä»–" search:"in" validate:"required"`
    
    // è§„æ ¼ä¿¡æ¯
    Brand       string  `json:"brand" gorm:"column:brand" runner:"name:å“ç‰Œ" widget:"type:input" search:"like" validate:"required"`
    Model       string  `json:"model" gorm:"column:model" runner:"name:å‹å·" widget:"type:input" search:"like"`
    Spec        string  `json:"spec" gorm:"column:spec" runner:"name:è§„æ ¼" widget:"type:input" search:"like"`
    Unit        string  `json:"unit" gorm:"column:unit" runner:"name:å•ä½" widget:"type:input" search:"like" validate:"required"`
    
    // ä»·æ ¼ä¿¡æ¯
    CostPrice   float64 `json:"cost_price" gorm:"column:cost_price" runner:"name:æˆæœ¬ä»·" widget:"type:number;min:0;precision:2;prefix:ï¿¥" search:"gte,lte" validate:"required,min=0"`
    SalePrice   float64 `json:"sale_price" gorm:"column:sale_price" runner:"name:é”€å”®ä»·" widget:"type:number;min:0;precision:2;prefix:ï¿¥" search:"gte,lte" validate:"required,min=0"`
    MarketPrice float64 `json:"market_price" gorm:"column:market_price" runner:"name:å¸‚åœºä»·" widget:"type:number;min:0;precision:2;prefix:ï¿¥" search:"gte,lte"`
    
    // åº“å­˜ä¿¡æ¯
    Stock       int     `json:"stock" gorm:"column:stock" runner:"name:åº“å­˜" widget:"type:number;min:0;unit:ä»¶" search:"gte,lte" validate:"required,min=0"`
    MinStock    int     `json:"min_stock" gorm:"column:min_stock" runner:"name:æœ€ä½åº“å­˜" widget:"type:number;min:0;unit:ä»¶" data:"default_value:10" validate:"required,min=0"`
    
    // çŠ¶æ€ä¿¡æ¯
    Status      string  `json:"status" gorm:"column:status" runner:"name:çŠ¶æ€" widget:"type:select;options:ä¸Šæ¶,ä¸‹æ¶,ç¼ºè´§,åœå”®" data:"default_value:ä¸Šæ¶" search:"in" validate:"required"`
    IsHot       bool    `json:"is_hot" gorm:"column:is_hot" runner:"name:æ˜¯å¦çƒ­é”€" widget:"type:switch;true_label:æ˜¯;false_label:å¦" data:"default_value:false" search:"eq"`
    
    // æè¿°ä¿¡æ¯
    Description string  `json:"description" gorm:"column:description" runner:"name:äº§å“æè¿°" widget:"type:input;mode:text_area" search:"like"`
    Images      string  `json:"images" gorm:"column:images" runner:"name:äº§å“å›¾ç‰‡" widget:"type:input"`
}

func (Product) TableName() string { return "product" }

// è¯·æ±‚ç»“æ„ä½“ - åˆ†é¡µæœç´¢
type ProductListReq struct {
    query.SearchFilterPageReq `runner:"-"`
    
    // è‡ªå®šä¹‰æœç´¢å­—æ®µ
    Category    string   `json:"category" runner:"name:åˆ†ç±»ç­›é€‰" widget:"type:select;options:ç”µå­äº§å“,æœè£…,é£Ÿå“,å®¶å±…,å…¶ä»–" search:"in"`
    Brand       string   `json:"brand" runner:"name:å“ç‰Œç­›é€‰" widget:"type:input" search:"like"`
    PriceRange  []float64 `json:"price_range" runner:"name:ä»·æ ¼èŒƒå›´" widget:"type:number;min:0;precision:2" search:"gte,lte"`
    StockStatus string   `json:"stock_status" runner:"name:åº“å­˜çŠ¶æ€" widget:"type:select;options:å……è¶³,ä¸è¶³,ç¼ºè´§" search:"in"`
}
```

### Formå‡½æ•°é…ç½®æ¨¡æ¿

```go
var YourFormOption = &runner.FormFunctionOptions{
    BaseConfig: runner.BaseConfig{
        ChineseName: "åŠŸèƒ½åç§°",
        ApiDesc:     "åŠŸèƒ½æè¿°",
        Tags:        []string{"æ ‡ç­¾1", "æ ‡ç­¾2"},
        Request:     &YourReq{},
        Response:    &YourResp{},
        CreateTables: []interface{}{&YourModel{}}, // å¦‚æœéœ€è¦å»ºè¡¨
        Group:       YourGroup, // å¦‚æœä½¿ç”¨å‡½æ•°ç»„
    },
    
	// å¦‚æœéœ€è¦æ¨¡ç³Šæœç´¢
	OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
		"field_name": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
			// ã€å½“å‰åœºæ™¯ã€‘field_nameæ˜¯å•é€‰å­—æ®µï¼Œåªè¿”å›é™æ€ä¿¡æ¯ï¼Œä¸åšèšåˆè®¡ç®—
			// ã€ç›®æ ‡å­—æ®µã€‘ä¸º YourReq.FieldName æä¾›æ•°æ®é€‰æ‹©
			var items []YourModel
			db := ctx.MustGetOrInitDB()

			if req.IsByFiledValues() {
				// å¤šå€¼æŸ¥è¯¢ï¼šä½¿ç”¨ IN æŸ¥è¯¢ï¼Œè¿™é‡Œå¿…é¡»ç”¨ db = db.Where
				db = db.Where("id in ?", req.GetFiledValues())
			} else if req.IsByFiledValue() {
				// å•å€¼æŸ¥è¯¢ï¼šä½¿ç”¨ç­‰å€¼æŸ¥è¯¢ï¼Œæ€§èƒ½æœ€ä¼˜
				db = db.Where("id = ?", req.GetFiledValue()).Limit(1)
			} else {
				// æ¨¡ç³ŠæŸ¥è¯¢ï¼šå…³é”®å­—æœç´¢
				db = db.Where("name LIKE ? OR category LIKE ?", "%"+req.Keyword()+"%", "%"+req.Keyword()+"%").
					Where("status = ?", "æ­£å¸¸").
					Limit(20)
			}
			db.Find(&items)

			// æ„å»ºè¿”å›æ•°æ®
			fuzzyItems := make([]*usercall.InputFuzzyItem, 0)
			for _, item := range items {
				fuzzyItems = append(fuzzyItems, &usercall.InputFuzzyItem{
					Value: item.ID,
					Label: fmt.Sprintf("%s - %s", item.Name, item.Description),
					DisplayInfo: map[string]interface{}{
						"åç§°": item.Name,
						"æè¿°": item.Description,
						"çŠ¶æ€": item.Status,
					},
				})
			}

			return &usercall.OnInputFuzzyResp{
				Statistics: map[string]interface{}{
					"é…é€æ–¹å¼": "é¡ºä¸°å¿«é€’",
					"ä¿è´¨æœŸ": "12ä¸ªæœˆ",
					"ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ ",
				},
				Values: fuzzyItems,
			}, nil
		},
	},
}
```

### Tableå‡½æ•°é…ç½®æ¨¡æ¿

```go
var YourTableOption = &runner.TableFunctionOptions{
    BaseConfig: runner.BaseConfig{
        ChineseName:  "åŠŸèƒ½åç§°",
        ApiDesc:      "åŠŸèƒ½æè¿°",
        Tags:         []string{"æ ‡ç­¾1", "æ ‡ç­¾2"},
        Request:      &YourListReq{},
        Response:     query.PaginatedTable[[]YourModel]{},
        CreateTables: []interface{}{&YourModel{}},
        Group:        YourGroup, // å¦‚æœä½¿ç”¨å‡½æ•°ç»„
    },
    
    // è‡ªåŠ¨ç”ŸæˆCRUDç•Œé¢
    AutoCrudTable: &YourModel{},
    
    // å¦‚æœéœ€è¦å›è°ƒ
    OnTableAddRows: func(ctx *runner.Context, req *usercall.OnTableAddRowsReq) (*usercall.OnTableAddRowsResp, error) {
        // å®ç°æ–°å¢é€»è¾‘
        return &usercall.OnTableAddRowsResp{}, nil
    },
    
    OnTableUpdateRows: func(ctx *runner.Context, req *usercall.OnTableUpdateRowsReq) (*usercall.OnTableUpdateRowsResp, error) {
        // å®ç°æ›´æ–°é€»è¾‘
        return &usercall.OnTableUpdateRowsResp{}, nil
    },
    
    OnTableDeleteRows: func(ctx *runner.Context, req *usercall.OnTableDeleteRowsReq) (*usercall.OnTableDeleteRowsResp, error) {
        // å®ç°åˆ é™¤é€»è¾‘
        return &usercall.OnTableDeleteRowsResp{}, nil
    },
}
```

### æƒé™æ§åˆ¶ç¤ºä¾‹

```go
type Product struct {
// åªè¯»å­—æ®µ
ID        int    `json:"id" gorm:"primaryKey" runner:"name:ID" permission:"read"`
CreatedAt int64  `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" permission:"read"`

// ä¸šåŠ¡å­—æ®µï¼šå…¨æƒé™
Name      string `json:"name" runner:"name:äº§å“åç§°" widget:"type:input" search:"like" validate:"required"`
Status    string `json:"status" runner:"name:çŠ¶æ€" widget:"type:select;options:å¯ç”¨,ç¦ç”¨" search:"in"`

// å¯†é’¥å­—æ®µï¼šä»…ç¼–è¾‘æ—¶æ˜¾ç¤ºï¼ˆç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œç”¨æˆ·ä¸èƒ½ä¿®æ”¹ï¼‰
SecretKey string `json:"secret_key" runner:"name:å¯†é’¥" widget:"type:input;mode:password" permission:"update"`

// å¤‡æ³¨å­—æ®µï¼šä»…åˆ›å»ºæ—¶æ˜¾ç¤ºï¼ˆåˆ›å»ºåä¸èƒ½ç¼–è¾‘ï¼‰
Remark    string `json:"remark" runner:"name:åˆ›å»ºå¤‡æ³¨" widget:"type:input;mode:text_area" permission:"create"`
}
```

## Function-Go å‘½åè§„èŒƒ

ä¸‹é¢å®šä¹‰äº† Function-Go é¡¹ç›®ä¸­çš„å‘½åè§„èŒƒï¼Œç¡®ä¿ä»£ç çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ï¼ˆæ³¨æ„ï¼šéœ€è¦ä¸¥æ ¼éµå¾ªå‘½åè§„èŒƒï¼‰

## 1. å•æ–‡ä»¶å•å‡½æ•°

### æ–‡ä»¶å‘½å

```go
// æ–‡ä»¶ï¼špdf_to_image.goï¼ˆå…·ä½“åŠŸèƒ½ï¼‰
package pdf
```

### è·¯ç”±å‘½å

```go
// è·¯ç”±å’Œæ–‡ä»¶åç§°ä¿æŒä¸€è‡´
RouterGroup+"/pdf_to_image"
```

### ç»“æ„ä½“å’Œå‡½æ•°å‘½å

```go
// ç»“æ„ä½“å’Œå‡½æ•°ç”¨ PdfToImage å¼€å¤´ï¼ˆå…·ä½“åŠŸèƒ½ï¼‰
type PdfToImageReq struct { ... }
type PdfToImageResp struct { ... }

func PdfToImage(ctx *runner.Context, req *PdfToImageReq, resp response.Response) error { ... }

var PdfToImageOption = &runner.FormFunctionOptions{ ... }
```

### å®Œæ•´ç¤ºä¾‹

æ³¨æ„ä»£ç ç¬¬ä¸€è¡Œå¿…é¡»ç»™å‡ºæ–‡ä»¶åæ³¨é‡Š

```go
//æ–‡ä»¶åï¼špdf_to_image.go
package pdf

import (
    "github.com/yunhanshu-net/function-go/pkg/dto/response"
    "github.com/yunhanshu-net/function-go/runner"
)

// è¯·æ±‚ç»“æ„ä½“
type PdfToImageReq struct {
    File *files.Files `json:"file" runner:"name:PDFæ–‡ä»¶" widget:"type:file_upload"`
}

// å“åº”ç»“æ„ä½“
type PdfToImageResp struct {
    Result *files.Files `json:"result" runner:"name:è½¬æ¢ç»“æœ" widget:"type:file_display"`
}

// å¤„ç†å‡½æ•°
func PdfToImage(ctx *runner.Context, req *PdfToImageReq, resp response.Response) error {
    // PDFè½¬å›¾ç‰‡é€»è¾‘
    return resp.Form(&PdfToImageResp{Result: nil}).Build()
}

// å‡½æ•°é…ç½®
var PdfToImageOption = &runner.FormFunctionOptions{
    BaseConfig: runner.BaseConfig{
        ChineseName: "PDFè½¬å›¾ç‰‡",
        Request:     &PdfToImageReq{},
        Response:    &PdfToImageResp{},
    },
}

// è·¯ç”±æ³¨å†Œ
func init() {
    runner.Post(RouterGroup+"/pdf_to_image", PdfToImage, PdfToImageOption)
}
```

## 2. å•æ–‡ä»¶å¤šå‡½æ•°ï¼ˆéœ€è¦ç”¨å‡½æ•°ç»„ï¼‰

### æ–‡ä»¶å‘½å

```go
// æ–‡ä»¶ï¼špdf_tools.go
package pdf
```

### å‡½æ•°ç»„é…ç½®

```go
var PdfToolsGroup = &runner.FunctionGroup{
    CnName: "PDFå·¥å…·é›†",
    EnName: "pdf_tools",  // ã€æ¡†æ¶è§„èŒƒã€‘ä¸æ–‡ä»¶åä¸€è‡´
}
```

### è·¯ç”±å‘½å

```go
// è·¯ç”±ç”¨ pdf_tools_xxx å¼€å¤´
RouterGroup+"/pdf_tools_convert"
RouterGroup+"/pdf_tools_merge"
RouterGroup+"/pdf_tools_split"
```

### ç»“æ„ä½“å’Œå‡½æ•°å‘½å

```go
// ç»“æ„ä½“å’Œå‡½æ•°ç”¨ PdfTools å¼€å¤´ï¼ˆæ–‡ä»¶åç§°çš„é©¼å³°æ ¼å¼å¼€å¤´ï¼‰
type PdfToolsConvertReq struct { ... }
type PdfToolsMergeReq struct { ... }
type PdfToolsSplitReq struct { ... }

func PdfToolsConvert(ctx *runner.Context, req *PdfToolsConvertReq, resp response.Response) error { ... }
func PdfToolsMerge(ctx *runner.Context, req *PdfToolsMergeReq, resp response.Response) error { ... }
func PdfToolsSplit(ctx *runner.Context, req *PdfToolsSplitReq, resp response.Response) error { ... }

var PdfToolsConvertOption = &runner.FormFunctionOptions{ ... }
var PdfToolsMergeOption = &runner.FormFunctionOptions{ ... }
var PdfToolsSplitOption = &runner.FormFunctionOptions{ ... }
```

### å®Œæ•´ç¤ºä¾‹

```go
//æ–‡ä»¶åï¼špdf_tools
package pdf

import (
    "github.com/yunhanshu-net/function-go/pkg/dto/response"
    "github.com/yunhanshu-net/function-go/runner"
)

// å‡½æ•°ç»„å®šä¹‰
var PdfToolsGroup = &runner.FunctionGroup{
    CnName: "PDFå·¥å…·é›†",
    EnName: "pdf_tools",
}

// è½¬æ¢è¯·æ±‚
type PdfToolsConvertReq struct {
    File *files.Files `json:"file" runner:"name:PDFæ–‡ä»¶" widget:"type:file_upload"`
}

// è½¬æ¢å“åº”
type PdfToolsConvertResp struct {
    Result *files.Files `json:"result" runner:"name:è½¬æ¢ç»“æœ" widget:"type:file_display"`
}

// åˆå¹¶è¯·æ±‚
type PdfToolsMergeReq struct {
    Files *files.Files `json:"files" runner:"name:PDFæ–‡ä»¶" widget:"type:file_upload;multiple:true"`
}

// åˆå¹¶å“åº”
type PdfToolsMergeResp struct {
    Result *files.Files `json:"result" runner:"name:åˆå¹¶ç»“æœ" widget:"type:file_display"`
}

// è½¬æ¢å‡½æ•°
func PdfToolsConvert(ctx *runner.Context, req *PdfToolsConvertReq, resp response.Response) error {
    return resp.Form(&PdfToolsConvertResp{Result: nil}).Build()
}

// åˆå¹¶å‡½æ•°
func PdfToolsMerge(ctx *runner.Context, req *PdfToolsMergeReq, resp response.Response) error {
    return resp.Form(&PdfToolsMergeResp{Result: nil}).Build()
}

// å‡½æ•°é…ç½®
var PdfToolsConvertOption = &runner.FormFunctionOptions{
    BaseConfig: runner.BaseConfig{
        ChineseName: "PDFæ ¼å¼è½¬æ¢",
        Group:       PdfToolsGroup,
        Request:     &PdfToolsConvertReq{},
        Response:    &PdfToolsConvertResp{},
    },
}

var PdfToolsMergeOption = &runner.FormFunctionOptions{
    BaseConfig: runner.BaseConfig{
        ChineseName: "PDFæ–‡ä»¶åˆå¹¶",
        Group:       PdfToolsGroup,
        Request:     &PdfToolsMergeReq{},
        Response:    &PdfToolsMergeResp{},
    },
}

// è·¯ç”±æ³¨å†Œ
func init() {
    runner.Post(RouterGroup+"/pdf_tools_convert", PdfToolsConvert, PdfToolsConvertOption)
    runner.Post(RouterGroup+"/pdf_tools_merge", PdfToolsMerge, PdfToolsMergeOption)
}
```

## æ€»ç»“

- **å•æ–‡ä»¶å•å‡½æ•°**ï¼šå…·ä½“åŠŸèƒ½ï¼ˆå¦‚ `pdf_to_image.go`ï¼‰ï¼Œå‘½åç”¨å…·ä½“åŠŸèƒ½å‰ç¼€ï¼ˆå¦‚ `PdfToImage`ï¼‰ï¼Œè·¯ç”±ç”¨ `RouterGroup+"/pdf_to_image"`
- **å•æ–‡ä»¶å¤šå‡½æ•°**ï¼šæŠ½è±¡å·¥å…·é›†ï¼ˆå¦‚ `pdf_tools.go`ï¼‰ï¼Œå‘½åç”¨æŠ½è±¡å‰ç¼€ï¼ˆå¦‚ `PdfTools`ï¼‰ï¼Œè·¯ç”±ç”¨ `RouterGroup+"/pdf_tools_xxx"`ï¼Œéœ€è¦ç”¨å‡½æ•°ç»„æ¥å½’ç±»è¿™ä¸€ç³»åˆ—ç›¸å…³å‡½æ•°
- **å‘½åä¸€è‡´æ€§**ï¼šç¡®ä¿æ–‡ä»¶åã€åŒ…åã€è·¯ç”±åã€ç»“æ„ä½“åã€å‡½æ•°åéƒ½éµå¾ªç›¸åŒçš„å‘½åæ¨¡å¼

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ ‡ç­¾é…ç½®åŸåˆ™

- **å¿…å¡«å­—æ®µ**ï¼šæ·»åŠ  `validate:"required"`
- **æœç´¢å­—æ®µ**ï¼šæ ¹æ®ç±»å‹é€‰æ‹©åˆé€‚çš„ `search` æ ‡ç­¾
- **æƒé™æ§åˆ¶**ï¼šä½¿ç”¨ `permission` æ ‡ç­¾æ§åˆ¶å­—æ®µæ˜¾ç¤º
- **é»˜è®¤å€¼**ï¼šä½¿ç”¨ `data:"default_value:å€¼"` è®¾ç½®é»˜è®¤å€¼

### 2. ç»„ä»¶é€‰æ‹©åŸåˆ™

- **æ–‡æœ¬è¾“å…¥**ï¼šä½¿ç”¨ `input` ç»„ä»¶
- **æ•°å­—è¾“å…¥**ï¼šä½¿ç”¨ `number` ç»„ä»¶
- **é€‰æ‹©è¾“å…¥**ï¼šä½¿ç”¨ `select`ã€`radio`ã€`checkbox` ç»„ä»¶
- **æ—¥æœŸæ—¶é—´**ï¼šä½¿ç”¨ `datetime` ç»„ä»¶
- **æ–‡ä»¶å¤„ç†**ï¼šä½¿ç”¨ `file_upload` ç»„ä»¶
- **å¤šé€‰åœºæ™¯**ï¼šä½¿ç”¨ `multiselect` ç»„ä»¶

### 3. æœç´¢é…ç½®åŸåˆ™

- **æ–‡æœ¬å­—æ®µ**ï¼šä½¿ç”¨ `like` æ¨¡ç³Šæœç´¢
- **çŠ¶æ€å­—æ®µ**ï¼šä½¿ç”¨ `in` å¤šé€‰æœç´¢
- **æ•°å€¼å­—æ®µ**ï¼šä½¿ç”¨ `gte,lte` åŒºé—´æœç´¢
- **æ—¶é—´å­—æ®µ**ï¼šä½¿ç”¨ `gte,lte` æ—¶é—´èŒƒå›´æœç´¢

### 4. éªŒè¯è§„åˆ™åŸåˆ™

- **å¿…å¡«éªŒè¯**ï¼šå¿…å¡«å­—æ®µå¿…é¡»æ·»åŠ  `required`
- **é•¿åº¦é™åˆ¶**ï¼šé˜²æ­¢è¿‡é•¿è¾“å…¥ï¼Œä½¿ç”¨ `min`ã€`max`
- **æ ¼å¼éªŒè¯**ï¼šé‚®ç®±ã€URLç­‰ç‰¹æ®Šæ ¼å¼ä½¿ç”¨ç›¸åº”éªŒè¯è§„åˆ™
- **ä¸šåŠ¡è§„åˆ™**ï¼šç¬¦åˆå®é™…ä¸šåŠ¡éœ€æ±‚çš„éªŒè¯è§„åˆ™

## ğŸ“‹ Function-Go é¡¹ç›®å¼€å‘ Checklist

### å¼€å‘å‰æ£€æŸ¥

1. **æ£€æŸ¥å‡½æ•°ã€ç»“æ„ä½“ã€å‘½åæ˜¯å¦è§„èŒƒ**

**å•æ–‡ä»¶å•å‡½æ•°ï¼ˆtableï¼‰**
```go
package crm
// æ–‡ä»¶åç§°ï¼šcrm_ticket.go
// å‡½æ•°å’Œç»“æ„ä½“å‘½åç”¨ï¼šCrmTicketXxx 
// è·¯ç”±ç”¨ï¼šRouterGroup+"/crm_ticket_list"ï¼ˆtableå‡½æ•°è·¯ç”±åé¢ä¸€èˆ¬åŠ ä¸ªlistï¼‰
```

**å•æ–‡ä»¶å•å‡½æ•°ï¼ˆformï¼‰**
```go
package crm
// æ–‡ä»¶åç§°ï¼šcrm_ticket.go
// å‡½æ•°å’Œç»“æ„ä½“å‘½åç”¨ï¼šCrmTicketXxx 
// è·¯ç”±ç”¨ï¼šRouterGroup+"/crm_ticket"ï¼ˆå•formå‡½æ•°çš„è·¯ç”±å¯ä»¥å’Œæ–‡ä»¶åç§°å¯¹é½ï¼‰
```

**å•æ–‡ä»¶å¤šå‡½æ•°ï¼ˆtableï¼‰**
```go
package crm
// æ–‡ä»¶åç§°ï¼šcrm_ticket.go
// å‡½æ•°ç»„ï¼šcrm_ticket
// å‡½æ•°å’Œç»“æ„ä½“å‘½åç”¨ï¼šCrmTicketXxx 
// è·¯ç”±ç”¨ï¼š
// RouterGroup+"/crm_ticket_list"ï¼ˆtableå‡½æ•°ï¼‰
// RouterGroup+"/crm_ticket_xxxx"
```

**ä¸¥æ ¼éµå¾ªå‘½åè§„èŒƒ**

2. **æ£€æŸ¥æ˜¯å¦éœ€è¦ä½¿ç”¨å‡½æ•°ç»„**ï¼ˆå•æ–‡ä»¶å•å‡½æ•°ä¸éœ€è¦ï¼Œå•æ–‡ä»¶å¤šå‡½æ•°éœ€è¦ï¼‰
3. **æ£€æŸ¥å…³è”çš„è¡¨æ˜¯å¦æŒ‚è½½äº†å¯¹åº”çš„ç»“æ„ä½“ï¼Œä½¿ç”¨Preloadé˜²æ­¢N+1æŸ¥è¯¢**
4. **æ£€æŸ¥æ ‡ç­¾æ˜¯å¦ä½¿ç”¨åˆç†**ï¼ˆwidgetã€validateã€searchã€permissionç­‰ï¼‰
5. **æ£€æŸ¥å›è°ƒæœºåˆ¶æ˜¯å¦æ­£ç¡®**ï¼ˆOnInputFuzzyå¤šé€‰æ‰èšåˆï¼Œå•é€‰è¿”å›é™æ€ä¿¡æ¯ï¼‰

### å¼€å‘ä¸­æ£€æŸ¥

6. **æ£€æŸ¥æ—¶é—´å­—æ®µé…ç½®**ï¼ˆç³»ç»Ÿæ—¶é—´ç”¨æ¯«ç§’ï¼Œä¸šåŠ¡æ—¥æœŸå¯ç”¨formatï¼‰
7. **æ£€æŸ¥æ–‡ä»¶å­—æ®µå®šä¹‰**ï¼ˆå­˜æ•°æ®åº“ç”¨*files.Files+gorm:type:jsonï¼Œä»…è¾“å…¥è¾“å‡ºç”¨*files.Filesï¼‰
8. **æ£€æŸ¥é”™è¯¯å¤„ç†æ˜¯å¦å‹å¥½**ï¼ˆè¿”å›å…·ä½“é”™è¯¯ä¿¡æ¯æŒ‡å¯¼ç”¨æˆ·æ“ä½œï¼‰

### å¼€å‘åæ£€æŸ¥

9. **æ£€æŸ¥æ˜¯å¦é…ç½®äº†CreateTableså’ŒAutoCrudTable**
10. **ç¦æ­¢å®šä¹‰RouterGroupå˜é‡ï¼Œå› ä¸ºæ¡†æ¶å·²ç»å®šä¹‰å¥½äº†ï¼Œè¯·ç›´æ¥ä½¿ç”¨å³å¯**
11. **æ£€æŸ¥è·¯ç”±æ³¨å†Œæ˜¯å¦æ­£ç¡®**ï¼ˆRouterGroup+"/å‡½æ•°å"ï¼‰
12. **è¾“å‡ºçš„ä»£ç è¯·ç›´æ¥ç”¨markdownæ ¼å¼ï¼Œå®Œæ•´çš„åŒ…è£¹åœ¨```go ``` æ ‡ç­¾é‡Œï¼Œç„¶åä»£ç çš„å¼€å¤´ç¬¬ä¸€ä¸ªè¡Œå¿…é¡»æ˜¯//æ–‡ä»¶åï¼šxxx.goï¼Œè¯´æ˜ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çš„åç§°è¯¥å«å•¥**

### ä»£ç è¾“å‡ºè§„èŒƒ

**ä»£ç è¾“å‡ºæ ¼å¼è¦æ±‚ï¼š**
- ä»£ç å¿…é¡»å®Œæ•´åŒ…è£¹åœ¨ ```go ``` æ ‡ç­¾ä¸­
- ä»£ç ç¬¬ä¸€è¡Œå¿…é¡»æ˜¯ `//æ–‡ä»¶åï¼šxxx.go` æ³¨é‡Š
- æ–‡ä»¶åå¿…é¡»ä¸å®é™…çš„Goæ–‡ä»¶åä¸€è‡´

## tableå‡½æ•°æœ€ä½³å®è·µçš„ç¤ºä¾‹

```go
// æ–‡ä»¶åï¼šcrm_ticket.go
package crm

import (
	"github.com/yunhanshu-net/function-go/pkg/dto/response"
	"github.com/yunhanshu-net/function-go/pkg/dto/usercall"
	"github.com/yunhanshu-net/function-go/runner"
	"github.com/yunhanshu-net/pkg/query"
	"github.com/yunhanshu-net/pkg/typex/files"
	"gorm.io/gorm"
)

// å·¥å•æ•°æ®æ¨¡å‹
type CrmTicket struct {
	// æ¡†æ¶æ ‡ç­¾ï¼šrunner:"name:å·¥å•ID" - è®¾ç½®å­—æ®µåœ¨å‰ç«¯çš„æ˜¾ç¤ºåç§°
	// æ¡†æ¶æ ‡ç­¾ï¼špermission:"read" - å­—æ®µåªè¯»æƒé™ï¼ˆä¸èƒ½ç¼–è¾‘ï¼‰
	// æ³¨æ„ï¼šgorm:"column:id" æ˜ç¡®æŒ‡å®šæ•°æ®åº“åˆ—åï¼Œç¡®ä¿æ˜ å°„æ­£ç¡®
	ID int `json:"id" gorm:"primaryKey;autoIncrement;column:id" runner:"name:å·¥å•ID" permission:"read"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:datetime;kind:datetime" - æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ç»„ä»¶
	// æ³¨æ„ï¼šgorm:"autoCreateTime:milli" è‡ªåŠ¨å¡«å……åˆ›å»ºæ—¶é—´ï¼ˆæ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œå¿…é¡»æ˜¯æ¯«ç§’çº§åˆ«ï¼‰
	CreatedAt int64 `json:"created_at" gorm:"autoCreateTime:milli;column:created_at" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:datetime;kind:datetime" - æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ç»„ä»¶ï¼Œï¼ˆæ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œå¿…é¡»æ˜¯æ¯«ç§’çº§åˆ«ï¼‰
	UpdatedAt int64 `json:"updated_at" gorm:"autoUpdateTime:milli;column:updated_at" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`

	// æ¡†æ¶æ ‡ç­¾ï¼šrunner:"-" - éšè—å­—æ®µï¼ˆä¸åœ¨å‰ç«¯æ˜¾ç¤ºï¼‰
	DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index;column:deleted_at" runner:"-"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=2,max=200" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦2-200å­—ç¬¦
	Title string `json:"title" gorm:"column:title" runner:"name:å·¥å•æ ‡é¢˜" widget:"type:input" search:"like" validate:"required,min=2,max=200"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=10" - å¿…å¡«å­—æ®µï¼Œè‡³å°‘10å­—ç¬¦
	Description string `json:"description" gorm:"column:description" runner:"name:é—®é¢˜æè¿°" widget:"type:input;mode:text_area" validate:"required,min=10"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:ä½,ä¸­,é«˜" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶ï¼ˆé€‰é¡¹ï¼šä½/ä¸­/é«˜ï¼‰
	// æ¡†æ¶æ ‡ç­¾ï¼šdata:"default_value:ä¸­" - è®¾ç½®é»˜è®¤å€¼ä¸º"ä¸­"
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,oneof=ä½,ä¸­,é«˜" - å¿…å¡«å­—æ®µï¼Œå€¼å¿…é¡»æ˜¯é€‰é¡¹ä¹‹ä¸€
	Priority string `json:"priority" gorm:"column:priority" runner:"name:ä¼˜å…ˆçº§" widget:"type:select;options:ä½,ä¸­,é«˜" data:"default_value:ä¸­" validate:"required,oneof=ä½,ä¸­,é«˜"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:å¾…å¤„ç†,å¤„ç†ä¸­,å·²å®Œæˆ,å·²å…³é—­" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šdata:"default_value:å¾…å¤„ç†" - è®¾ç½®é»˜è®¤çŠ¶æ€ä¸º"å¾…å¤„ç†"
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,oneof=å¾…å¤„ç†,å¤„ç†ä¸­,å·²å®Œæˆ,å·²å…³é—­" - å€¼å¿…é¡»æ˜¯æœ‰æ•ˆçŠ¶æ€
	Status string `json:"status" gorm:"column:status" runner:"name:å·¥å•çŠ¶æ€" widget:"type:select;options:å¾…å¤„ç†,å¤„ç†ä¸­,å·²å®Œæˆ,å·²å…³é—­" data:"default_value:å¾…å¤„ç†" validate:"required,oneof=å¾…å¤„ç†,å¤„ç†ä¸­,å·²å®Œæˆ,å·²å…³é—­"`

	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=11,max=20" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦11-20å­—ç¬¦
	Phone string `json:"phone" gorm:"column:phone" runner:"name:è”ç³»ç”µè¯" widget:"type:input" validate:"required,min=11,max=20"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	Remark string `json:"remark" gorm:"column:remark" runner:"name:å¤‡æ³¨" widget:"type:input;mode:text_area"`

	//åˆ›å»ºç”¨æˆ·ï¼šç”¨æˆ·ç»„ä»¶
	CreateBy string `json:"create_by" gorm:"column:create_by" runner:"name:åˆ›å»ºç”¨æˆ·"  widget:"type:user"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:file_upload;multiple:true;..." - å¤šæ–‡ä»¶ä¸Šä¼ ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šaccept:.pdf,.doc,... - å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹
	// æ³¨æ„ï¼šgorm:"type:json" æŒ‡å®šæ•°æ®åº“å­˜å‚¨ä¸ºJSONç±»å‹
	Attachment *files.Files `json:"attachment" gorm:"type:json;column:attachment" runner:"name:é™„ä»¶" widget:"type:file_upload;multiple:true;max_size:10MB;accept:.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.png,.gif,.zip,.rar"`
}

// æ¡†æ¶åŠŸèƒ½ï¼šTableName() æŒ‡å®šæ•°æ®åº“è¡¨å
func (CrmTicket) TableName() string { return "crm_ticket" }

// åˆ†é¡µè¯·æ±‚ç»“æ„
type CrmTicketListReq struct {
	// æ¡†æ¶æ ‡ç­¾ï¼šrunner:"-" - éšè—æœç´¢ï¼Œåˆ†é¡µï¼Œç­‰è¯·æ±‚å‚æ•°ï¼ˆæ— éœ€åœ¨å‰ç«¯æ˜¾ç¤ºï¼‰
	query.SearchFilterPageReq `runner:"-"`
}

// è¡¨æ ¼å¤„ç†å‡½æ•°ï¼Œè¿™é‡Œæ˜¯å‰ç«¯å±•ç¤ºåˆ—è¡¨æ•°æ®çš„æ¥å£
func CrmTicketList(ctx *runner.Context, req *CrmTicketListReq, resp response.Response) error {
	// æ¡†æ¶åŠŸèƒ½ï¼šctx.MustGetOrInitDB() - è·å–æ•°æ®åº“è¿æ¥
	db := ctx.MustGetOrInitDB()
	var rows []CrmTicket

	//ã€æ¡†æ¶è§„èŒƒã€‘è¿™é‡Œæ¡†æ¶ä¼šè‡ªåŠ¨æ‹¿ç€è¯·æ±‚å‚æ•°å’Œdbå»æ•°æ®åº“æŸ¥è¯¢æ•°æ®ï¼Œè‡ªåŠ¨åˆ†é¡µç­‰ç­‰
	queryBuilder := resp.Table(&rows).AutoPaginated(db, &CrmTicket{}, &req.SearchFilterPageReq)
	//æ­¤æ—¶rowsï¼Œå·²ç»æ˜¯æ ¹æ®è¯·æ±‚æ¡ä»¶å’Œåˆ†é¡µæ¡ä»¶æŸ¥è¯¢åˆ°çš„æ•°æ®äº†ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢åˆ°æ•°æ®åå¯¹æ•°æ®è¿›è¡Œå¤„ç†ç­‰ç­‰

	// æ¡†æ¶åŠŸèƒ½ï¼šAutoPaginated() - è‡ªåŠ¨å¤„ç†åˆ†é¡µ/æœç´¢/æ’åº
	return queryBuilder.Build()
}

// è‡ªåŠ¨CRUDé…ç½®
var CrmTicketListOption = &runner.TableFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName: "CRMå·¥å•ç®¡ç†",                               // APIä¸­æ–‡åç§°
		ApiDesc:     "å·¥å•ç®¡ç†ç³»ç»Ÿ",                                // APIæè¿°
		Tags:        []string{"å·¥å•ç³»ç»Ÿ", "æ”¿åŠ¡ç³»ç»Ÿ", "å·¥å•ç®¡ç†", "CRM"}, // æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾åˆ†ç±»
		// æ¡†æ¶åŠŸèƒ½ï¼šCreateTables - æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºæ•°æ®è¡¨
		CreateTables: []interface{}{&CrmTicket{}},
		//å¯¹åº”æŸ¥è¯¢çš„è¯·æ±‚å‚æ•°
		Request: &CrmTicketListReq{},
		//å›ºå®šquery.PaginatedTable[[]table]{} çš„æ ¼å¼
		Response: query.PaginatedTable[[]CrmTicket]{},
	},
	// æ¡†æ¶åŠŸèƒ½ï¼šAutoCrudTable - è‡ªåŠ¨ç”Ÿæˆå¢åˆ æ”¹æŸ¥çš„ç•Œé¢
	AutoCrudTable: &CrmTicket{},

	//ã€æ¡†æ¶è§„èŒƒã€‘æ–°å¢è®°å½•å›è°ƒ
	OnTableAddRows: func(ctx *runner.Context, req *usercall.OnTableAddRowsReq) (*usercall.OnTableAddRowsResp, error) {
		//ã€æ¡†æ¶è§„èŒƒã€‘è¿™é‡Œå¯ä»¥ç›´æ¥è·å–åˆ°gormçš„db
		gormDb := ctx.MustGetOrInitDB()
		var addRows []*CrmTicket
		//ã€æ¡†æ¶è§„èŒƒã€‘è¿™é‡Œè§£æç”¨æˆ·æ–°å¢çš„è®°å½•
		if err := req.DecodeBy(&addRows); err != nil {
			return nil, err
		}
		for _, row := range addRows { //å¦‚æœè®°å½•ä¸­å­˜åœ¨åˆ›å»ºç”¨æˆ·å­—æ®µçš„è¯ï¼Œå¯ä»¥ä»ctx.GetUserInfo()è·å–ç”¨æˆ·ä¿¡æ¯
			row.CreateBy = ctx.GetUserInfo().Username //ã€æ¡†æ¶è§„èŒƒã€‘è·å–ç”¨æˆ·ä¿¡æ¯
		}
		//æŠŠè®°å½•å†™å…¥dbï¼Œå†™å…¥å‰åéƒ½å¯ä»¥åšä¸€äº›æ“ä½œ
		err := gormDb.Create(&addRows).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableAddRowsResp{}, nil
	},
	//ã€æ¡†æ¶è§„èŒƒã€‘æ›´æ–°è®°å½•å›è°ƒ
	OnTableUpdateRows: func(ctx *runner.Context, req *usercall.OnTableUpdateRowsReq) (*usercall.OnTableUpdateRowsResp, error) {
		//ã€æ¡†æ¶è§„èŒƒã€‘è¿™é‡Œå¯ä»¥ç›´æ¥è·å–åˆ°gormçš„db
		gormDb := ctx.MustGetOrInitDB()
		var updateRow CrmTicket
		if err := req.DecodeBy(&updateRow); err != nil { //è¿™é‡Œåªèƒ½è§£æåˆ°æ›´æ–°çš„å­—æ®µçš„æ•°æ®ï¼Œä¾‹å¦‚æ›´æ–°äº†phoneå­—æ®µçš„è¯ï¼Œé‚£ä¹ˆå…¶ä»–å­—æ®µéƒ½æ˜¯ç©ºå€¼ï¼Œåªæœ‰phoneå­˜åœ¨å€¼
			return nil, err
		}
		err := gormDb.Where("id in (?)", req.GetIds()).Updates(&updateRow).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableUpdateRowsResp{}, nil
	},

	//ã€æ¡†æ¶è§„èŒƒã€‘åˆ é™¤è®°å½•å›è°ƒ
	OnTableDeleteRows: func(ctx *runner.Context, req *usercall.OnTableDeleteRowsReq) (*usercall.OnTableDeleteRowsResp, error) {
		gormDb := ctx.MustGetOrInitDB()
		err := gormDb.Delete(&CrmTicket{}, req.GetIds()).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableDeleteRowsResp{}, nil
	},
}

// æ¡†æ¶åŠŸèƒ½ï¼šinit() å‡½æ•°è‡ªåŠ¨æ³¨å†Œè·¯ç”±
func init() {
	// æ¡†æ¶åŠŸèƒ½ï¼šrunner.Get() - æ³¨å†ŒTableè¯·æ±‚è·¯ç”±
	runner.Get(RouterGroup+"/crm_ticket_list", CrmTicketList, CrmTicketListOption)
}

```

formå‡½æ•°æœ€ä½³å®è·µç¤ºä¾‹,åŸºæœ¬å‚æ•°è¾“å…¥ä¸è¾“å‡º

```go
// æ–‡ä»¶åï¼štext_convert.go
package text

import (
	"strings"
	"github.com/yunhanshu-net/function-go/pkg/dto/response"
	"github.com/yunhanshu-net/function-go/runner"
)

// ã€æ¡†æ¶åŠŸèƒ½ã€‘Formå‡½æ•°è¯·æ±‚ç»“æ„ä½“ï¼šå®šä¹‰ç”¨æˆ·è¾“å…¥å­—æ®µï¼Œæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆå‰ç«¯è¡¨å•
type TextConvertReq struct {
	// ã€æ¡†æ¶æ ‡ç­¾ã€‘widget:"type:input;mode:text_area" - è‡ªåŠ¨æ¸²æŸ“ä¸ºå¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡†
	InputText string `json:"input_text" runner:"name:è¾“å…¥æ–‡æœ¬" widget:"type:input;mode:text_area" validate:"required"`

	// ã€æ¡†æ¶æ ‡ç­¾ã€‘widget:"type:select;options:..." - è‡ªåŠ¨æ¸²æŸ“ä¸ºä¸‹æ‹‰é€‰æ‹©æ¡†ï¼Œdata:"default_value"è®¾ç½®é»˜è®¤å€¼
	ConvertType string `json:"convert_type" runner:"name:è½¬æ¢ç±»å‹" widget:"type:select;options:è½¬å¤§å†™,è½¬å°å†™,é¦–å­—æ¯å¤§å†™" data:"default_value:è½¬å¤§å†™"`
}

// ã€æ¡†æ¶åŠŸèƒ½ã€‘Formå‡½æ•°å“åº”ç»“æ„ä½“ï¼šå®šä¹‰è¿”å›ç»“æœï¼Œæ¡†æ¶è‡ªåŠ¨æ¸²æŸ“å‰ç«¯å±•ç¤º
type TextConvertResp struct {
	// ã€æ¡†æ¶æ ‡ç­¾ã€‘widget:"type:input;mode:text_area" - è‡ªåŠ¨æ¸²æŸ“ä¸ºå¤šè¡Œæ–‡æœ¬å±•ç¤ºåŒºåŸŸ
	Result string `json:"result" runner:"name:è½¬æ¢ç»“æœ" widget:"type:input;mode:text_area"`

	// ã€æ¡†æ¶æ ‡ç­¾ã€‘widget:"type:input" - è‡ªåŠ¨æ¸²æŸ“ä¸ºå•è¡Œæ–‡æœ¬å±•ç¤º
	Message string `json:"message" runner:"name:çŠ¶æ€" widget:"type:input"`
}

// ã€æ¡†æ¶åŠŸèƒ½ã€‘Formå‡½æ•°å¤„ç†å‡½æ•°ï¼šæ¡†æ¶è‡ªåŠ¨è°ƒç”¨æ­¤å‡½æ•°å¤„ç†ç”¨æˆ·è¯·æ±‚
func TextConvert(ctx *runner.Context, req *TextConvertReq, resp response.Response) error {
	var result string

	// ä¸šåŠ¡é€»è¾‘ï¼šæ ¹æ®è½¬æ¢ç±»å‹æ‰§è¡Œæ–‡æœ¬è½¬æ¢
	switch req.ConvertType {
	case "è½¬å¤§å†™":
		result = strings.ToUpper(req.InputText)
	case "è½¬å°å†™":
		result = strings.ToLower(req.InputText)
	case "é¦–å­—æ¯å¤§å†™":
		result = strings.Title(strings.ToLower(req.InputText))
	default:
		result = req.InputText
	}

	// ã€æ¡†æ¶åŠŸèƒ½ã€‘resp.Form() - è‡ªåŠ¨å°†ç»“æœæ¸²æŸ“ä¸ºå‰ç«¯è¡¨å•å±•ç¤º
	return resp.Form(&TextConvertResp{
		Result:  result,
		Message: "è½¬æ¢å®Œæˆ",
	}).Build()
}

// ã€æ¡†æ¶åŠŸèƒ½ã€‘Formå‡½æ•°é…ç½®ï¼šå®šä¹‰APIå…ƒæ•°æ®ï¼Œæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£å’Œè·¯ç”±
var TextConvertOption = &runner.FormFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName: "æ–‡æœ¬å¤§å°å†™è½¬æ¢",  // æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆä¸­æ–‡æ¥å£åç§°
		ApiDesc:     "æ”¯æŒæ–‡æœ¬å¤§å°å†™è½¬æ¢çš„å·¥å…·ï¼ŒåŒ…æ‹¬è½¬å¤§å†™ã€è½¬å°å†™ã€é¦–å­—æ¯å¤§å†™ç­‰åŠŸèƒ½",  // æ¡†æ¶è‡ªåŠ¨ç”ŸæˆAPIæè¿°
		Tags:        []string{"æ–‡æœ¬å¤„ç†", "æ ¼å¼è½¬æ¢", "å·¥å…·å‡½æ•°"},  // æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾åˆ†ç±»
		Request:     &TextConvertReq{},   // æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆè¯·æ±‚å‚æ•°è¯´æ˜
		Response:    &TextConvertResp{},  // æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆå“åº”ç»“æœè¯´æ˜
	},
}

// ã€æ¡†æ¶åŠŸèƒ½ã€‘è·¯ç”±æ³¨å†Œï¼šæ¡†æ¶è‡ªåŠ¨åˆ›å»ºRouterGroup å˜é‡ï¼Œæ— éœ€è‡ªå·±åˆ›å»ºRouterGroupå˜é‡ï¼Œå¯ä»¥ç›´æ¥ç”¨
func init() {
	// ã€æ¡†æ¶åŠŸèƒ½ã€‘runner.Post() - è‡ªåŠ¨åˆ›å»ºPOSTè·¯ç”±ï¼Œæ”¯æŒè¡¨å•æäº¤
	runner.Post(RouterGroup+"/text_convert", TextConvert, TextConvertOption)
}
```

### ç¤ºä¾‹3ï¼šFormå‡½æ•°-pdfåŠ å¯†è§£å¯†ï¼ˆæ–‡ä»¶çš„ä¸Šä¼ ä¸æ–‡ä»¶è¾“å‡ºï¼‰

å¯ä»¥ç›´æ¥ç”¨å¼€æºçš„ï¼Œä¸»æµçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œå°½é‡é¿å…ä½¿ç”¨éä¸»æµçš„ç¬¬ä¸‰æ–¹åŒ…
github.com/pdfcpu/pdfcpuæ˜¯ä¸ªgoçš„å¾ˆä¸»æµä¸“ä¸šçš„å¼€æº pdfå¼€æºåº“ï¼Œå¯ä»¥ç›´æ¥ç”¨

```go
// æ–‡ä»¶åï¼špdf.go
package pdf

/*
<metadata>
<éœ€æ±‚>
PDF åŠ å¯†/è§£å¯†ï¼ˆå•æ–‡ä»¶è‡ªåŒ…å«ï¼‰ï¼š
- è®¾ç½®/ç§»é™¤PDFå£ä»¤ï¼Œæ”¯æŒç”¨æˆ·å£ä»¤ä¸æ‰€æœ‰è€…å£ä»¤ï¼ˆç®€åŒ–ï¼šåŒä¸€å£ä»¤ï¼‰
</éœ€æ±‚>

</metadata>
*/

import (
	"fmt"
	"os"
	"path/filepath"

	pdfapi "github.com/pdfcpu/pdfcpu/pkg/api"
	pdfmodel "github.com/pdfcpu/pdfcpu/pkg/pdfcpu/model"
	"github.com/yunhanshu-net/function-go/pkg/dto/response"
	"github.com/yunhanshu-net/function-go/runner"
	"github.com/yunhanshu-net/pkg/typex/files"
)

// ============== PDFåŠ å¯†åŠŸèƒ½ ==============

// PdfEncryptReq PDFåŠ å¯†è¯·æ±‚ç»“æ„ä½“
// ã€æ¡†æ¶è¯´æ˜ã€‘ä½¿ç”¨files.Filesç±»å‹æ¥æ”¶ç”¨æˆ·ä¸Šä¼ çš„PDFæ–‡ä»¶ï¼Œæ”¯æŒå¤šæ–‡ä»¶æ‰¹é‡å¤„ç†
type PdfEncryptReq struct {
	// ã€æ¡†æ¶è¯´æ˜ã€‘files.Filesæ˜¯function-goæ¡†æ¶çš„æ ‡å‡†æ–‡ä»¶ç±»å‹ï¼Œæ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ 
	// ã€ç»„ä»¶è¯´æ˜ã€‘file_uploadç»„ä»¶ï¼šaccepté™åˆ¶æ–‡ä»¶ç±»å‹ä¸ºPDFï¼Œmultiple:trueæ”¯æŒå¤šæ–‡ä»¶
	// ã€éªŒè¯è¯´æ˜ã€‘requiredç¡®ä¿ç”¨æˆ·å¿…é¡»ä¸Šä¼ æ–‡ä»¶ï¼Œvalidateæ ‡ç­¾è‡ªåŠ¨ç”Ÿæˆå‰ç«¯éªŒè¯
	Files *files.Files `json:"files" runner:"name:PDFæ–‡ä»¶" widget:"type:file_upload;accept:.pdf;multiple:true" data:"type:files" validate:"required"`

	// ã€æ¡†æ¶è¯´æ˜ã€‘å¯†ç è¾“å…¥å­—æ®µï¼Œä½¿ç”¨passwordæ¨¡å¼éšè—ç”¨æˆ·è¾“å…¥
	// ã€éªŒè¯è¯´æ˜ã€‘requiredå¿…å¡«ï¼Œmin=1ç¡®ä¿å¯†ç ä¸ä¸ºç©ºå­—ç¬¦ä¸²
	Password string `json:"password" runner:"name:å£ä»¤" widget:"type:input;mode:password" validate:"required,min=1"`
}

// PdfEncryptResp PDFåŠ å¯†å“åº”ç»“æ„ä½“
// ã€æ¡†æ¶è¯´æ˜ã€‘è¿”å›å¤„ç†åçš„åŠ å¯†PDFæ–‡ä»¶ï¼Œä½¿ç”¨file_displayç»„ä»¶å±•ç¤ºä¸‹è½½é“¾æ¥
type PdfEncryptResp struct {
	// ã€æ¡†æ¶è¯´æ˜ã€‘Resultå­—æ®µåŒ…å«åŠ å¯†åçš„PDFæ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥ä¸‹è½½
	Result *files.Files `json:"result" runner:"name:åŠ å¯†ç»“æœ" widget:"type:file_display" data:"type:files"`
}

// PdfEncryptHandle PDFåŠ å¯†å¤„ç†å‡½æ•°
// ã€æ¡†æ¶è¯´æ˜ã€‘Formå‡½æ•°çš„æ ‡å‡†ç­¾åï¼šctxæä¾›ä¸Šä¸‹æ–‡ï¼Œreqæ¥æ”¶è¯·æ±‚ï¼Œrespæ„å»ºå“åº”
func PdfEncryptHandle(ctx *runner.Context, req *PdfEncryptReq, resp response.Response) error {
	// ã€æ¡†æ¶è¯´æ˜ã€‘å‚æ•°éªŒè¯ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸Šä¼ ï¼Œå¯†ç æ˜¯å¦è¾“å…¥
	if req.Files == nil || req.Files.GetFileCount() == 0 {
		return fmt.Errorf("è¯·ä¸Šä¼ PDFæ–‡ä»¶")
	}
	if req.Password == "" {
		return fmt.Errorf("è¯·è¾“å…¥åŠ å¯†å£ä»¤")
	}

	// ã€æ¡†æ¶è¯´æ˜ã€‘èµ„æºæ¸…ç†ï¼šä½¿ç”¨deferç¡®ä¿ä¸´æ—¶æ–‡ä»¶è¢«æ­£ç¡®æ¸…ç†ï¼Œé˜²æ­¢ç£ç›˜ç©ºé—´æ³„æ¼
	// ã€é‡è¦ã€‘files.Files.CleanupLocalFiles()æ¸…ç†ä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬
	defer req.Files.CleanupLocalFiles()

	// ã€æ¡†æ¶è¯´æ˜ã€‘åˆ›å»ºä¸´æ—¶å·¥ä½œç›®å½•ï¼šctx.FS().TempUniqueDir()æ˜¯æ¡†æ¶æä¾›çš„å®‰å…¨ä¸´æ—¶ç›®å½•API
	// ã€å‚æ•°è¯´æ˜ã€‘"pdf_task"æ˜¯ç›®å½•å‰ç¼€ï¼Œ"encrypt"æ˜¯ä»»åŠ¡æ ‡è¯†ï¼Œæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€åç¼€
	// ã€å®‰å…¨è¯´æ˜ã€‘æ¯æ¬¡è°ƒç”¨ç”Ÿæˆä¸åŒçš„ç›®å½•ï¼Œé¿å…æ–‡ä»¶å†²çªå’Œå¹¶å‘é—®é¢˜
	// ã€è·¯å¾„ç¤ºä¾‹ã€‘ç”Ÿæˆçš„ç›®å½•ç±»ä¼¼ï¼š/tmp/pdf_task_encrypt_abc123def456/
	baseDir, err := ctx.FS().TempUniqueDir("pdf_task", "encrypt")
	if err != nil {
		return err
	}
	// ã€æ¡†æ¶è¯´æ˜ã€‘ä½¿ç”¨deferç¡®ä¿ä¸´æ—¶ç›®å½•è¢«å®Œå…¨åˆ é™¤ï¼ŒåŒ…æ‹¬æ‰€æœ‰å­æ–‡ä»¶å’Œå­ç›®å½•
	defer os.RemoveAll(baseDir)

	// ã€æ¡†æ¶è¯´æ˜ã€‘åˆ›å»ºè¾“å‡ºæ–‡ä»¶é›†åˆï¼šctx.FS().NewTemporaryFiles()åˆ›å»ºä¸´æ—¶æ–‡ä»¶ç®¡ç†å™¨
	// ã€ä½œç”¨è¯´æ˜ã€‘ç”¨äºæ”¶é›†å¤„ç†åçš„æ–‡ä»¶ï¼Œæœ€ç»ˆè¿”å›ç»™ç”¨æˆ·
	out := ctx.FS().NewTemporaryFiles()
	// ã€æ¡†æ¶è¯´æ˜ã€‘æ¸…ç†è¾“å‡ºæ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
	defer out.CleanupLocalFiles()

	// ã€ç¬¬ä¸‰æ–¹åº“ã€‘ä½¿ç”¨pdfcpuåº“åˆ›å»ºAES-256åŠ å¯†é…ç½®
	// ã€å‚æ•°è¯´æ˜ã€‘ç”¨æˆ·å£ä»¤å’Œæ‰€æœ‰è€…å£ä»¤è®¾ä¸ºç›¸åŒå€¼ï¼Œç®€åŒ–ç”¨æˆ·æ“ä½œ
	conf := pdfmodel.NewAESConfiguration(req.Password, req.Password, 256)

	// ã€æ¡†æ¶è¯´æ˜ã€‘éå†ç”¨æˆ·ä¸Šä¼ çš„æ‰€æœ‰PDFæ–‡ä»¶ï¼Œé€ä¸ªå¤„ç†
	for _, f := range req.Files.GetFiles() {
		// ã€æ¡†æ¶è¯´æ˜ã€‘è·å–æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„ï¼šf.GetLocalPath(ctx)å°†å†…å­˜ä¸­çš„æ–‡ä»¶å†™å…¥ä¸´æ—¶ç›®å½•
		// ã€è¿”å›å€¼ã€‘inPathæ˜¯æ–‡ä»¶åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„å®Œæ•´è·¯å¾„
		inPath, e := f.GetLocalPath(ctx)
		if e != nil {
			return fmt.Errorf("è¯»å–PDFå¤±è´¥: %s", f.Name)
		}

		// ã€æ–‡ä»¶å¤„ç†ã€‘æ„å»ºè¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œä½¿ç”¨åŸæ–‡ä»¶åä½†æ”¾åœ¨ä¸´æ—¶ç›®å½•ä¸­
		outPath := filepath.Join(baseDir, filepath.Base(inPath))

		// ã€ç¬¬ä¸‰æ–¹åº“ã€‘è°ƒç”¨pdfcpuåº“è¿›è¡ŒPDFåŠ å¯†
		if e := pdfapi.EncryptFile(inPath, outPath, conf); e != nil {
			return fmt.Errorf("åŠ å¯†å¤±è´¥(%s)ï¼š%v", f.Name, e)
		}

		// ã€æ¡†æ¶è¯´æ˜ã€‘å°†å¤„ç†åçš„æ–‡ä»¶æ·»åŠ åˆ°è¾“å‡ºé›†åˆï¼šout.AddFileFromPath()å°†æœ¬åœ°æ–‡ä»¶åŠ å…¥ç»“æœé›†
		// ã€ä½œç”¨è¯´æ˜ã€‘è¿™æ ·ç”¨æˆ·å°±èƒ½ä¸‹è½½åˆ°åŠ å¯†åçš„PDFæ–‡ä»¶
		if e := out.AddFileFromPath(outPath); e != nil {
			return e
		}
	}

	// ã€æ¡†æ¶è¯´æ˜ã€‘æ„å»ºå“åº”ï¼šresp.Form()åˆ›å»ºè¡¨å•å“åº”ï¼ŒåŒ…å«å¤„ç†ç»“æœ
	// ã€è¿”å›è¯´æ˜ã€‘ç”¨æˆ·å¯ä»¥åœ¨å‰ç«¯çœ‹åˆ°åŠ å¯†ç»“æœå¹¶æä¾›ä¸‹è½½é“¾æ¥
	return resp.Form(&PdfEncryptResp{Result: out}).Build()
}

// ============== PDFè§£å¯†åŠŸèƒ½ ==============

// PdfDecryptReq PDFè§£å¯†è¯·æ±‚ç»“æ„ä½“
// ã€æ¡†æ¶è¯´æ˜ã€‘ç»“æ„ä¸åŠ å¯†è¯·æ±‚ç›¸åŒï¼Œä½†ä¸šåŠ¡å«ä¹‰ä¸åŒ
type PdfDecryptReq struct {
	// ã€æ¡†æ¶è¯´æ˜ã€‘files.Filesæ”¯æŒå¤šæ–‡ä»¶æ‰¹é‡è§£å¯†ï¼Œæé«˜å¤„ç†æ•ˆç‡
	Files *files.Files `json:"files" runner:"name:PDFæ–‡ä»¶" widget:"type:file_upload;accept:.pdf;multiple:true" data:"type:files" validate:"required"`

	// ã€æ¡†æ¶è¯´æ˜ã€‘è§£å¯†éœ€è¦æä¾›æ­£ç¡®çš„åŠ å¯†å£ä»¤
	Password string `json:"password" runner:"name:å£ä»¤" widget:"type:input;mode:password" validate:"required,min=1"`
}

// PdfDecryptResp PDFè§£å¯†å“åº”ç»“æ„ä½“
// ã€æ¡†æ¶è¯´æ˜ã€‘è¿”å›è§£å¯†åçš„PDFæ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥æ­£å¸¸æ‰“å¼€å’Œç¼–è¾‘
type PdfDecryptResp struct {
	// ã€æ¡†æ¶è¯´æ˜ã€‘Resultå­—æ®µåŒ…å«è§£å¯†åçš„PDFæ–‡ä»¶
	Result *files.Files `json:"result" runner:"name:è§£å¯†ç»“æœ" widget:"type:file_display" data:"type:files"`
}

// PdfDecryptHandle PDFè§£å¯†å¤„ç†å‡½æ•°
// ã€æ¡†æ¶è¯´æ˜ã€‘è§£å¯†é€»è¾‘ä¸åŠ å¯†ç±»ä¼¼ï¼Œä½†è°ƒç”¨pdfapi.DecryptFile()å‡½æ•°
func PdfDecryptHandle(ctx *runner.Context, req *PdfDecryptReq, resp response.Response) error {
	// ã€æ¡†æ¶è¯´æ˜ã€‘å‚æ•°éªŒè¯é€»è¾‘ä¸åŠ å¯†å‡½æ•°ç›¸åŒ
	if req.Files == nil || req.Files.GetFileCount() == 0 {
		return fmt.Errorf("è¯·ä¸Šä¼ PDFæ–‡ä»¶")
	}
	if req.Password == "" {
		return fmt.Errorf("è¯·è¾“å…¥è§£å¯†å£ä»¤")
	}

	// ã€æ¡†æ¶è¯´æ˜ã€‘èµ„æºæ¸…ç†ï¼šç¡®ä¿ä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶è¢«æ¸…ç†
	defer req.Files.CleanupLocalFiles()

	// ã€æ¡†æ¶è¯´æ˜ã€‘åˆ›å»ºè§£å¯†ä¸“ç”¨çš„ä¸´æ—¶å·¥ä½œç›®å½•ï¼Œé¿å…ä¸åŠ å¯†ä»»åŠ¡å†²çª
	// ã€å‘½åè¯´æ˜ã€‘ä½¿ç”¨"decrypt"æ ‡è¯†ï¼Œä¾¿äºè°ƒè¯•å’Œæ—¥å¿—è¿½è¸ª
	baseDir, err := ctx.FS().TempUniqueDir("pdf_task", "decrypt")
	if err != nil {
		return err
	}
	// ã€æ¡†æ¶è¯´æ˜ã€‘ç¡®ä¿ä¸´æ—¶ç›®å½•è¢«å®Œå…¨æ¸…ç†
	defer os.RemoveAll(baseDir)

	// ã€æ¡†æ¶è¯´æ˜ã€‘åˆ›å»ºè¾“å‡ºæ–‡ä»¶é›†åˆï¼Œç”¨äºæ”¶é›†è§£å¯†åçš„æ–‡ä»¶
	out := ctx.FS().NewTemporaryFiles()
	// ã€æ¡†æ¶è¯´æ˜ã€‘æ¸…ç†è¾“å‡ºæ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬
	defer out.CleanupLocalFiles()

	// ã€ç¬¬ä¸‰æ–¹åº“ã€‘ä½¿ç”¨ç›¸åŒçš„AESé…ç½®è¿›è¡Œè§£å¯†
	conf := pdfmodel.NewAESConfiguration(req.Password, req.Password, 256)

	// ã€æ¡†æ¶è¯´æ˜ã€‘éå†æ‰€æœ‰PDFæ–‡ä»¶è¿›è¡Œè§£å¯†å¤„ç†
	for _, f := range req.Files.GetFiles() {
		// ã€æ¡†æ¶è¯´æ˜ã€‘è·å–æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„ï¼Œå‡†å¤‡è§£å¯†å¤„ç†
		inPath, e := f.GetLocalPath(ctx)
		if e != nil {
			return fmt.Errorf("è¯»å–PDFå¤±è´¥: %s", f.Name)
		}

		// ã€æ–‡ä»¶å¤„ç†ã€‘æ„å»ºè§£å¯†åçš„è¾“å‡ºæ–‡ä»¶è·¯å¾„
		outPath := filepath.Join(baseDir, filepath.Base(inPath))

		// ã€ç¬¬ä¸‰æ–¹åº“ã€‘è°ƒç”¨pdfcpuåº“è¿›è¡ŒPDFè§£å¯†
		if e := pdfapi.DecryptFile(inPath, outPath, conf); e != nil {
			return fmt.Errorf("è§£å¯†å¤±è´¥(%s)ï¼š%v", f.Name, e)
		}

		// ã€æ¡†æ¶è¯´æ˜ã€‘å°†è§£å¯†åçš„æ–‡ä»¶æ·»åŠ åˆ°è¾“å‡ºé›†åˆ
		if e := out.AddFileFromPath(outPath); e != nil {
			return e
		}
	}

	// ã€æ¡†æ¶è¯´æ˜ã€‘è¿”å›è§£å¯†ç»“æœï¼Œç”¨æˆ·å¯ä»¥ä¸‹è½½è§£å¯†åçš„PDFæ–‡ä»¶
	return resp.Form(&PdfDecryptResp{Result: out}).Build()
}

// ============== å‡½æ•°ç»„é…ç½® ==============

// ã€æ¡†æ¶è¯´æ˜ã€‘å‡½æ•°ç»„ç”¨äºç®¡ç†åŒæ–‡ä»¶ä¸­çš„å¤šä¸ªç›¸å…³å‡½æ•°
// ã€å‘½åè§„èŒƒã€‘ç»„EnNameä½¿ç”¨æ–‡ä»¶åpdf_encryptï¼ŒCnNameæä¾›ä¸­æ–‡æè¿°
var PdfEncryptGroup = &runner.FunctionGroup{
	CnName: "PDFå·¥å…·-åŠ å¯†è§£å¯†",
	EnName: "pdf",
}

// ã€æ¡†æ¶è¯´æ˜ã€‘PDFåŠ å¯†å‡½æ•°é…ç½®ï¼šä½¿ç”¨FormFunctionOptionså› ä¸ºè¿™æ˜¯è¡¨å•å¤„ç†å‡½æ•°
var PdfEncryptOption = &runner.FormFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "PDFåŠ å¯†",                                   // ã€æ¡†æ¶è¯´æ˜ã€‘APIçš„ä¸­æ–‡åç§°ï¼Œç”¨æˆ·å‹å¥½çš„æ˜¾ç¤º
		ApiDesc:      "ä¸ºPDFè®¾ç½®å£ä»¤ï¼ˆç”¨æˆ·ä¸æ‰€æœ‰è€…åŒå£ä»¤ï¼ŒAES-256ï¼‰", // ã€æ¡†æ¶è¯´æ˜ã€‘APIåŠŸèƒ½æè¿°
		Tags:         []string{"PDF", "å®‰å…¨"},                     // ã€æ¡†æ¶è¯´æ˜ã€‘æ ‡ç­¾ç”¨äºåˆ†ç±»å’Œæœç´¢
		Request:      &PdfEncryptReq{},                            // ã€æ¡†æ¶è¯´æ˜ã€‘è¯·æ±‚ç»“æ„ä½“ï¼Œæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆå‰ç«¯è¡¨å•
		Response:     &PdfEncryptResp{},                           // ã€æ¡†æ¶è¯´æ˜ã€‘å“åº”ç»“æ„ä½“ï¼Œæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆç»“æœå±•ç¤º
		Group:        PdfEncryptGroup,                             // ã€æ¡†æ¶è¯´æ˜ã€‘æŒ‡å®šå‡½æ•°ç»„ï¼Œä¾¿äºå‰ç«¯åˆ†ç»„ç®¡ç†
	},
}

// ã€æ¡†æ¶è¯´æ˜ã€‘PDFè§£å¯†å‡½æ•°é…ç½®ï¼šç»“æ„ä¸åŠ å¯†å‡½æ•°ç±»ä¼¼
var PdfDecryptOption = &runner.FormFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "PDFè§£å¯†",                     // ã€æ¡†æ¶è¯´æ˜ã€‘è§£å¯†å‡½æ•°çš„ä¸­æ–‡åç§°
		ApiDesc:      "ç§»é™¤PDFå£ä»¤ï¼ˆéœ€æä¾›æ­£ç¡®å£ä»¤ï¼‰", // ã€æ¡†æ¶è¯´æ˜ã€‘è§£å¯†åŠŸèƒ½æè¿°
		Tags:         []string{"PDF", "å®‰å…¨"},       // ã€æ¡†æ¶è¯´æ˜ã€‘ç›¸åŒçš„æ ‡ç­¾åˆ†ç±»
		Request:      &PdfDecryptReq{},              // ã€æ¡†æ¶è¯´æ˜ã€‘è§£å¯†è¯·æ±‚ç»“æ„ä½“
		Response:     &PdfDecryptResp{},             // ã€æ¡†æ¶è¯´æ˜ã€‘è§£å¯†å“åº”ç»“æ„ä½“
		Group:        PdfEncryptGroup,               // ã€æ¡†æ¶è¯´æ˜ã€‘ä½¿ç”¨ç›¸åŒçš„å‡½æ•°ç»„
	},
}

// ============== è·¯ç”±æ³¨å†Œ ==============

// ã€æ¡†æ¶è¯´æ˜ã€‘init()å‡½æ•°åœ¨åŒ…åˆå§‹åŒ–æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œæ³¨å†ŒAPIè·¯ç”±
// ã€è·¯ç”±è§„èŒƒã€‘ä½¿ç”¨POSTæ–¹æ³•å› ä¸ºè¿™æ˜¯æ–‡ä»¶ä¸Šä¼ å’Œå¤„ç†çš„è¡¨å•å‡½æ•°
// ã€è·¯å¾„è¯´æ˜ã€‘RouterGroup+"/pdf_encrypt"ç¡®ä¿è·¯ç”±å”¯ä¸€æ€§ï¼Œé¿å…å†²çª
func init() {
	// ã€æ¡†æ¶è¯´æ˜ã€‘æ³¨å†ŒPDFåŠ å¯†APIï¼šè·¯å¾„ä¸EnglishNameä¿æŒä¸€è‡´
	runner.Post(RouterGroup+"/pdf_encrypt", PdfEncryptHandle, PdfEncryptOption)

	// ã€æ¡†æ¶è¯´æ˜ã€‘æ³¨å†ŒPDFè§£å¯†APIï¼šè·¯å¾„ä¸EnglishNameä¿æŒä¸€è‡´
	runner.Post(RouterGroup+"/pdf_decrypt", PdfDecryptHandle, PdfDecryptOption)
}


```

### ç¤ºä¾‹4: Formå‡½æ•°-å·¥ä½œç©ºé—´ç®¡ç†ç³»ç»Ÿï¼ˆè°ƒç”¨å¤–éƒ¨APIï¼Œåå°ç®¡ç†ç±»ï¼Œæ›¿ä»£postmanç±»åªèƒ½ç¨‹åºå‘˜ç”¨çš„æƒ…å†µï¼Œç”Ÿæˆçš„æ˜¯éæŠ€æœ¯äººå¯ä»¥ç”¨çš„é¡µé¢åŠŸèƒ½ï¼‰

ç”¨æˆ·éœ€æ±‚ï¼š

æˆ‘æœ‰ä¸¤ä¸ªapiï¼Œä¸€ä¸ªåˆ›å»ºå·¥ä½œç©ºé—´ï¼Œä¸€ä¸ªè·å–å·¥ä½œç©ºé—´åˆ—è¡¨ï¼Œéœ€è¦ä½ å¸®æˆ‘ææˆå¯¹åº”çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œä¸‹é¢æ˜¯æ¥å£è¯·æ±‚ç¤ºä¾‹

1. åˆ›å»ºå·¥ä½œç©ºé—´

curl 'http://func-ai.geeleo.com/api/v1/runner'
-H 'Content-Type: application/json'
-H 'Token: è¿™é‡Œå¯ä»¥ä»é…ç½®é‡Œç®¡ç†tokenå‚æ•°'
--data-raw '{"title":"æ¸…åå¤§å­¦ç§‘ç ”å·¥ä½œç©ºé—´","name":"qinghuadaxue_keyan","description":"ä¸»è¦æ˜¯ä¸ºäº†ç§‘ç ”"}'
--insecure

è¿”å›å€¼ï¼š

{
"code": 0,
"msg": "æˆåŠŸ",
"data": {
"id": 5
}
}

2. è·å–å·¥ä½œç©ºé—´åˆ—è¡¨

curl 'http://func-ai.geeleo.com/api/v1/runner?page_size=100'
-H 'Token: è¿™é‡Œå¯ä»¥ä»é…ç½®é‡Œç®¡ç†tokenå‚æ•°'
--insecure

è¿”å›å€¼ï¼š
{
"code": 0,
"msg": "æˆåŠŸ",
"data": {
"items": [
{
"id": 1,
"created_at": "2025-09-03 01:06:25",
"updated_at": "2025-09-03 21:18:41",
"created_by": "beiluo",
"title": "æµ‹è¯•ç©ºé—´",
"name": "demo6",
"description": "æµ‹è¯•",
"version": "v10",
"status": 1,   /1æ˜¯å·²ç»å¯ç”¨ï¼Œ2åœç”¨
"runcher_id": null,
"is_public": false

},
{
"id": 2,
"created_at": "2025-09-03 02:03:21",
"updated_at": "2025-09-03 22:53:49",
"created_by": "beiluo",
"title": "test1",
"name": "test1",
"description": "æµ‹è¯•",
"version": "v9",
"status": 1,
"runcher_id": null,
"is_public": false

}
],
"current_page": 0,
"total_count": 2,
"total_pages": 1,
"page_size": 100
}
}

```go
// æ–‡ä»¶åï¼šworkspace_admin_manage.go


package workspace_admin

import (
	"fmt"
	"time"

	"github.com/yunhanshu-net/function-go/pkg/dto/response"
	"github.com/yunhanshu-net/function-go/pkg/dto/usercall"
	"github.com/yunhanshu-net/function-go/runner"
	"github.com/yunhanshu-net/pkg/x/httpx" //è°ƒç”¨httpçš„éœ€è¦ç”¨å°è£…çš„åº“
)

// ==================== å‡½æ•°ç»„ï¼šå·¥ä½œç©ºé—´ç®¡ç† ====================
var WorkspaceAdminManageGroup = &runner.FunctionGroup{CnName: "å·¥ä½œç©ºé—´ç®¡ç†", EnName: "workspace_admin_manage"}

// ==================== é…ç½®ç®¡ç†ï¼šAPIè¿æ¥é…ç½® ====================

// <rag-api>
// å·¥ä½œç©ºé—´APIé…ç½®ï¼šç®¡ç†è¿œç¨‹APIçš„è¿æ¥å‚æ•°ï¼ŒåŒ…æ‹¬åŸŸåå’ŒTokenè®¤è¯
// ã€æ¡†æ¶è§„èŒƒã€‘AutoUpdateConfigé…ç½®ç®¡ç†ï¼šæ¡†æ¶æä¾›çš„é…ç½®çƒ­æ›´æ–°æœºåˆ¶
// ã€Whyã€‘ä¸ºä»€ä¹ˆéœ€è¦é…ç½®ç®¡ç†ï¼šå¤–éƒ¨APIçš„åŸŸåã€Tokenç­‰å‚æ•°ç»å¸¸å˜åŒ–ï¼Œéœ€è¦æ”¯æŒåŠ¨æ€é…ç½®
// ã€Whatã€‘é…ç½®ç®¡ç†åšä»€ä¹ˆï¼šæä¾›é…ç½®ç•Œé¢ï¼Œæ”¯æŒé…ç½®çƒ­æ›´æ–°ï¼Œè‡ªåŠ¨æŒä¹…åŒ–åˆ°æœ¬åœ°æ–‡ä»¶
// ã€Howã€‘å¦‚ä½•ä½¿ç”¨é…ç½®ï¼šé€šè¿‡ctx.GetConfig()è·å–é…ç½®ï¼Œæ¡†æ¶è‡ªåŠ¨ç®¡ç†é…ç½®ç”Ÿå‘½å‘¨æœŸ
// ã€ä¸šåŠ¡é€»è¾‘ã€‘å®šä¹‰APIè¿æ¥å‚æ•°ï¼šåŸºç¡€URLã€è®¤è¯Tokenã€è¶…æ—¶è®¾ç½®ç­‰
// ã€æ•°æ®æ¥æºã€‘ç®¡ç†å‘˜é€šè¿‡é…ç½®ç•Œé¢è®¾ç½®ï¼Œæ¡†æ¶è‡ªåŠ¨æŒä¹…åŒ–åˆ°æœ¬åœ°æ–‡ä»¶
// ã€ä½¿ç”¨åœºæ™¯ã€‘å¤–éƒ¨APIè°ƒç”¨ã€Tokenè®¤è¯ã€è¿æ¥æµ‹è¯•ç­‰è¿œç¨‹æœåŠ¡ç®¡ç†åœºæ™¯
type WorkspaceAdminManageAPIConfig struct {
	// APIè¿æ¥é…ç½®
	BaseURL string `json:"base_url" runner:"name:APIåŸŸå" widget:"type:input" data:"default_value:http://func-ai.geeleo.com/api/v1/runner"`
	Token   string `json:"token" runner:"name:è®¤è¯Token" widget:"type:input;mode:password" data:"default_value:è¯·æ›¿æ¢æˆçœŸå®token"`

	// è¿æ¥é…ç½®
	TimeoutSeconds int `json:"timeout_seconds" runner:"name:è¶…æ—¶æ—¶é—´(ç§’)" widget:"type:number;min:5;max:300" data:"default_value:30"`
}

// </rag-api>

// ==================== å¤–éƒ¨APIæ•°æ®ç»“æ„ ====================

// å¤–éƒ¨APIè¿”å›çš„å·¥ä½œç©ºé—´ä¿¡æ¯ç»“æ„ä½“ï¼ˆç”¨äºè§£æå¤–éƒ¨APIå“åº”ï¼‰
type ExternalWorkspaceInfo struct {
	ID          int    `json:"id"`
	CreatedAt   string `json:"created_at"`
	UpdatedAt   string `json:"updated_at"`
	CreatedBy   string `json:"created_by"`
	Title       string `json:"title"`
	Name        string `json:"name"`
	Description string `json:"description"`
	Version     string `json:"version"`
	Status      int    `json:"status"`
	RuncherID   *int   `json:"runcher_id"`
	IsPublic    bool   `json:"is_public"`
}

// å¤–éƒ¨APIå“åº”ç»“æ„ä½“
type ExternalAPIResponse struct {
	Code int    `json:"code"`
	Msg  string `json:"msg"`
	Data struct {
		Items       []ExternalWorkspaceInfo `json:"items"`
		CurrentPage int                     `json:"current_page"`
		TotalCount  int                     `json:"total_count"`
		TotalPages  int                     `json:"total_pages"`
		PageSize    int                     `json:"page_size"`
	} `json:"data"`
}

// åˆ›å»ºå·¥ä½œç©ºé—´APIå“åº”
type ExternalCreateResponse struct {
	Code int    `json:"code"`
	Msg  string `json:"msg"`
	Data struct {
		ID int `json:"id"`
	} `json:"data"`
}

// ==================== ç”¨æˆ·å“åº”æ•°æ®ç»“æ„ ====================

// è¿”å›ç»™ç”¨æˆ·çš„å·¥ä½œç©ºé—´ä¿¡æ¯ç»“æ„ä½“ï¼ˆç”¨äºformå“åº”ï¼‰
type WorkspaceInfo struct {
	ID          int    `json:"id" runner:"name:å·¥ä½œç©ºé—´ID"`
	CreatedAt   string `json:"created_at" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime"`
	UpdatedAt   string `json:"updated_at" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime"`
	CreatedBy   string `json:"created_by" runner:"name:åˆ›å»ºè€…" widget:"type:input"`
	Title       string `json:"title" runner:"name:æ ‡é¢˜" widget:"type:input"`
	Name        string `json:"name" runner:"name:åç§°" widget:"type:input"`
	Description string `json:"description" runner:"name:æè¿°" widget:"type:input;mode:text_area"`
	Version     string `json:"version" runner:"name:ç‰ˆæœ¬" widget:"type:input"`
	Status      string `json:"status" runner:"name:çŠ¶æ€" widget:"type:input"` // è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ˜¾ç¤º
	RuncherID   *int   `json:"runcher_id" runner:"name:è¿è¡Œå™¨ID" widget:"type:number"`
	IsPublic    bool   `json:"is_public" runner:"name:æ˜¯å¦å…¬å¼€" widget:"type:switch;true_label:å…¬å¼€;false_label:ç§æœ‰"`
}

// ==================== è¯·æ±‚å“åº”ç»“æ„ä½“ ====================

// <rag-api>
// åˆ›å»ºå·¥ä½œç©ºé—´è¯·æ±‚å‚æ•°ï¼šåŒ…å«å·¥ä½œç©ºé—´çš„åŸºæœ¬ä¿¡æ¯
// ã€ä¸šåŠ¡é€»è¾‘ã€‘ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨å¤–éƒ¨APIåˆ›å»ºå·¥ä½œç©ºé—´ï¼Œæ”¯æŒTokenè®¤è¯
// ã€ä½¿ç”¨å»ºè®®ã€‘æ ‡é¢˜å’Œåç§°å»ºè®®ä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‡è¯†ï¼Œæè¿°å¯ç”¨äºè¯¦ç»†è¯´æ˜å·¥ä½œç©ºé—´ç”¨é€”
type WorkspaceAdminManageCreateReq struct {
	Title       string `json:"title" runner:"name:å·¥ä½œç©ºé—´æ ‡é¢˜" widget:"type:input" data:"example:æ¸…åå¤§å­¦ç§‘ç ”å·¥ä½œç©ºé—´" validate:"required,min=2,max=100"`
	Name        string `json:"name" runner:"name:å·¥ä½œç©ºé—´åç§°" widget:"type:input" data:"example:qinghuadaxue_keyan" validate:"required,min=2,max=50"`
	Description string `json:"description" runner:"name:å·¥ä½œç©ºé—´æè¿°" widget:"type:input;mode:text_area" data:"example:ä¸»è¦æ˜¯ä¸ºäº†ç§‘ç ”"`
}

// </rag-api>

// <rag-api>
// è·å–å·¥ä½œç©ºé—´åˆ—è¡¨è¯·æ±‚å‚æ•°ï¼šæ”¯æŒåˆ†é¡µæŸ¥è¯¢
// ã€ä¸šåŠ¡é€»è¾‘ã€‘ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨å¤–éƒ¨APIè·å–å·¥ä½œç©ºé—´åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œç­›é€‰
// ã€ä½¿ç”¨å»ºè®®ã€‘page_sizeå»ºè®®æ ¹æ®å®é™…éœ€è¦è®¾ç½®ï¼Œé¿å…ä¸€æ¬¡æ€§è·å–è¿‡å¤šæ•°æ®
type WorkspaceAdminManageListReq struct {
	PageSize int `json:"page_size" runner:"name:æ¯é¡µæ•°é‡" widget:"type:number;min:1;max:1000;unit:ä¸ª" data:"default_value:20;example:100" validate:"required,min=1,max=1000"`
}

// </rag-api>

// <rag-api>
// åˆ›å»ºå·¥ä½œç©ºé—´å“åº”ç»“æœï¼šåŒ…å«æ“ä½œç»“æœã€å·¥ä½œç©ºé—´IDã€APIçŠ¶æ€ç­‰
// ã€ä¸šåŠ¡é€»è¾‘ã€‘æ ¹æ®APIè°ƒç”¨ç»“æœè¿”å›åˆ›å»ºæˆåŠŸçš„å·¥ä½œç©ºé—´IDå’ŒçŠ¶æ€ä¿¡æ¯
// ã€ä½¿ç”¨å»ºè®®ã€‘é€šè¿‡å“åº”ä¿¡æ¯äº†è§£åˆ›å»ºç»“æœï¼Œå·¥ä½œç©ºé—´IDç”¨äºåç»­æ“ä½œ
type WorkspaceAdminManageCreateResp struct {
	Message     string `json:"message" runner:"name:æ“ä½œç»“æœ" widget:"type:input;mode:text_area"`
	APIStatus   string `json:"api_status" runner:"name:APIçŠ¶æ€" widget:"type:input"`
	ConfigInfo  string `json:"config_info" runner:"name:é…ç½®ä¿¡æ¯" widget:"type:input"`
	WorkspaceID int    `json:"workspace_id" runner:"name:å·¥ä½œç©ºé—´ID" widget:"type:number"`
}

// è·å–å·¥ä½œç©ºé—´åˆ—è¡¨å“åº”ç»“æœï¼šåŒ…å«æ“ä½œç»“æœã€å·¥ä½œç©ºé—´åˆ—è¡¨ã€åˆ†é¡µä¿¡æ¯ã€APIçŠ¶æ€ç­‰
// ã€ä¸šåŠ¡é€»è¾‘ã€‘æ ¹æ®APIè°ƒç”¨ç»“æœè¿”å›å·¥ä½œç©ºé—´åˆ—è¡¨å’Œåˆ†é¡µä¿¡æ¯
// ã€ä½¿ç”¨å»ºè®®ã€‘é€šè¿‡å“åº”ä¿¡æ¯äº†è§£æŸ¥è¯¢ç»“æœï¼Œåˆ†é¡µä¿¡æ¯ç”¨äºå‰ç«¯å±•ç¤º
type WorkspaceAdminManageListResp struct {
	Message     string          `json:"message" runner:"name:æ“ä½œç»“æœ" widget:"type:input;mode:text_area"`
	APIStatus   string          `json:"api_status" runner:"name:APIçŠ¶æ€" widget:"type:input"`
	ConfigInfo  string          `json:"config_info" runner:"name:é…ç½®ä¿¡æ¯" widget:"type:input"`
	Workspaces  []WorkspaceInfo `json:"workspaces" runner:"name:å·¥ä½œç©ºé—´åˆ—è¡¨" widget:"type:list"`
	TotalCount  int             `json:"total_count" runner:"name:æ€»æ•°é‡" widget:"type:number"`
	CurrentPage int             `json:"current_page" runner:"name:å½“å‰é¡µ" widget:"type:number"`
	TotalPages  int             `json:"total_pages" runner:"name:æ€»é¡µæ•°" widget:"type:number"`
	PageSize    int             `json:"page_size" runner:"name:æ¯é¡µæ•°é‡" widget:"type:number"`
}

// </rag-api>

// ==================== å·¥å…·å‡½æ•°ï¼šæ•°æ®è½¬æ¢å’ŒAPIè°ƒç”¨ ====================

// TokenéªŒè¯å‡½æ•°ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦è®¾ç½®äº†çœŸå®çš„Token
func validateToken(config WorkspaceAdminManageAPIConfig) error {
	// æ£€æŸ¥Tokenæ˜¯å¦ä¸ºç©ºæˆ–é»˜è®¤å€¼
	if config.Token == "" {
		return fmt.Errorf("Tokenä¸èƒ½ä¸ºç©ºï¼Œè¯·åœ¨é…ç½®ä¸­è®¾ç½®çœŸå®çš„API Token")
	}

	// æ£€æŸ¥æ˜¯å¦ä¸ºé»˜è®¤æç¤ºæ–‡æœ¬
	if config.Token == "è¯·æ›¿æ¢æˆçœŸå®token" {
		return fmt.Errorf("è¯·å°†Tokenæ›¿æ¢ä¸ºçœŸå®çš„API Tokenï¼Œå½“å‰ä½¿ç”¨çš„æ˜¯é»˜è®¤æç¤ºæ–‡æœ¬")
	}

	// æ£€æŸ¥Tokené•¿åº¦æ˜¯å¦åˆç†ï¼ˆè‡³å°‘8ä½ï¼‰
	if len(config.Token) < 8 {
		return fmt.Errorf("Tokené•¿åº¦è¿‡çŸ­ï¼Œè¯·æ£€æŸ¥æ˜¯å¦è®¾ç½®äº†æ­£ç¡®çš„API Token")
	}

	return nil
}

// æ•°æ®è½¬æ¢å‡½æ•°ï¼šå°†å¤–éƒ¨APIæ•°æ®è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„æ ¼å¼
func convertExternalToWorkspaceInfo(external ExternalWorkspaceInfo) WorkspaceInfo {
	// çŠ¶æ€è½¬æ¢ï¼š1=å¯ç”¨ï¼Œ2=åœç”¨
	statusText := "åœç”¨"
	if external.Status == 1 {
		statusText = "å¯ç”¨"
	}

	return WorkspaceInfo{
		ID:          external.ID,
		CreatedAt:   external.CreatedAt,
		UpdatedAt:   external.UpdatedAt,
		CreatedBy:   external.CreatedBy,
		Title:       external.Title,
		Name:        external.Name,
		Description: external.Description,
		Version:     external.Version,
		Status:      statusText,
		RuncherID:   external.RuncherID,
		IsPublic:    external.IsPublic,
	}
}

// ==================== æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼šå·¥ä½œç©ºé—´ç®¡ç† ====================

// ==================== æ¡†æ¶é€‚é…å±‚ï¼šFormå‡½æ•° ====================

// åˆ›å»ºå·¥ä½œç©ºé—´
// ã€æ¡†æ¶è¯´æ˜ã€‘Formå‡½æ•°ï¼šå¤„ç†å·¥ä½œç©ºé—´åˆ›å»ºè¯·æ±‚ï¼Œè°ƒç”¨å¤–éƒ¨APIåˆ›å»ºå·¥ä½œç©ºé—´
// ã€ä¸šåŠ¡é€»è¾‘ã€‘å†…è”ä¸šåŠ¡é€»è¾‘ï¼Œæ–¹ä¾¿å¤§æ¨¡å‹å­¦ä¹ å’Œç†è§£å®Œæ•´çš„å·¥ä½œç©ºé—´åˆ›å»ºæµç¨‹
func WorkspaceAdminManageCreate(ctx *runner.Context, req *WorkspaceAdminManageCreateReq, resp response.Response) error {
	// ã€æ¡†æ¶è§„èŒƒã€‘é…ç½®è·å–ï¼šä»ä¸Šä¸‹æ–‡è·å–é…ç½®ä¿¡æ¯
	// ã€Whyã€‘ä¸ºä»€ä¹ˆéœ€è¦é…ç½®ï¼šå¤–éƒ¨APIçš„åŸŸåã€Tokenç­‰å‚æ•°éœ€è¦åŠ¨æ€é…ç½®ï¼Œä¸èƒ½ç¡¬ç¼–ç 
	// ã€Whatã€‘é…ç½®è·å–åšä»€ä¹ˆï¼šä»æ¡†æ¶é…ç½®ç®¡ç†ä¸­è·å–APIè¿æ¥å‚æ•°
	// ã€Howã€‘å¦‚ä½•ä½¿ç”¨ï¼šctx.GetConfig().(é…ç½®ç»“æ„ä½“ç±»å‹)ï¼Œæ¡†æ¶è‡ªåŠ¨ç®¡ç†é…ç½®ç”Ÿå‘½å‘¨æœŸ
	config := ctx.GetConfig().(WorkspaceAdminManageAPIConfig)

	// ã€ä¸šåŠ¡é€»è¾‘ã€‘TokenéªŒè¯ï¼šæ£€æŸ¥é…ç½®æ˜¯å¦æœ‰æ•ˆ
	if err := validateToken(config); err != nil {
		return resp.Form(&WorkspaceAdminManageCreateResp{
			Message:    err.Error(),
			APIStatus:  "é…ç½®é”™è¯¯",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// æ„å»ºAPI URL
	apiURL := config.BaseURL

	// æ„å»ºè¯·æ±‚ä½“ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨req
	requestBody := map[string]interface{}{
		"title":       req.Title,
		"name":        req.Name,
		"description": req.Description,
	}

	// ã€æ¡†æ¶è§„èŒƒã€‘httpxåº“ä½¿ç”¨ï¼šæ¡†æ¶æä¾›çš„HTTPå®¢æˆ·ç«¯åº“
	// ã€Whyã€‘ä¸ºä»€ä¹ˆç”¨httpxï¼šæ”¯æŒé“¾å¼è°ƒç”¨ã€ç›´æ¥ç»‘å®šå“åº”ç»“æ„ä½“ã€ç»Ÿä¸€é”™è¯¯å¤„ç†
	// ã€Whatã€‘httpxåšä»€ä¹ˆï¼šæä¾›ä¼˜é›…çš„HTTPè¯·æ±‚APIï¼Œæ”¯æŒGET/POST/PUT/DELETEç­‰æ–¹æ³•
	// ã€Howã€‘å¦‚ä½•ä½¿ç”¨ï¼šé“¾å¼è°ƒç”¨Post().Header().Timeout().Body().Do(å“åº”ç»“æ„ä½“)
	// ã€ä¸šåŠ¡é€»è¾‘ã€‘POSTè¯·æ±‚åˆ›å»ºå·¥ä½œç©ºé—´ï¼ŒåŒ…å«å®Œæ•´çš„è¯·æ±‚å¤´è®¾ç½®å’Œé”™è¯¯å¤„ç†
	var apiResp ExternalCreateResponse
	httpResult, err := httpx.Post(apiURL).
		Header("Content-Type", "application/json").
		Header("Token", config.Token).
		Timeout(time.Duration(config.TimeoutSeconds) * time.Second).
		Body(requestBody).
		Do(&apiResp)

	if err != nil {
		return resp.Form(&WorkspaceAdminManageCreateResp{
			Message:    fmt.Sprintf("åˆ›å»ºå·¥ä½œç©ºé—´å¤±è´¥: %v", err),
			APIStatus:  "è¿æ¥å¤±è´¥",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// æ£€æŸ¥HTTPçŠ¶æ€ç 
	if !httpResult.OK() {
		return resp.Form(&WorkspaceAdminManageCreateResp{
			Message:    fmt.Sprintf("APIè¿”å›é”™è¯¯çŠ¶æ€ç : %d, å“åº”: %s", httpResult.Code, httpResult.ResBodyString),
			APIStatus:  "HTTPé”™è¯¯",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// æ£€æŸ¥APIè¿”å›çŠ¶æ€
	if apiResp.Code != 0 {
		return resp.Form(&WorkspaceAdminManageCreateResp{
			Message:    fmt.Sprintf("APIè¿”å›é”™è¯¯: %s", apiResp.Msg),
			APIStatus:  "APIä¸šåŠ¡é”™è¯¯",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// æ„å»ºæˆåŠŸå“åº”
	result := &WorkspaceAdminManageCreateResp{
		Message:    fmt.Sprintf("å·¥ä½œç©ºé—´åˆ›å»ºæˆåŠŸï¼ID: %d", apiResp.Data.ID),
		APIStatus:  "è°ƒç”¨æˆåŠŸ",
		ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
	}

	return resp.Form(result).Build()
}

// è·å–å·¥ä½œç©ºé—´åˆ—è¡¨
// ã€æ¡†æ¶è¯´æ˜ã€‘Formå‡½æ•°ï¼šå¤„ç†å·¥ä½œç©ºé—´åˆ—è¡¨æŸ¥è¯¢è¯·æ±‚ï¼Œè°ƒç”¨å¤–éƒ¨APIè·å–åˆ—è¡¨æ•°æ®
// ã€ä¸šåŠ¡é€»è¾‘ã€‘å†…è”ä¸šåŠ¡é€»è¾‘ï¼Œæ–¹ä¾¿å¤§æ¨¡å‹å­¦ä¹ å’Œç†è§£å®Œæ•´çš„å·¥ä½œç©ºé—´æŸ¥è¯¢æµç¨‹
func WorkspaceAdminManageList(ctx *runner.Context, req *WorkspaceAdminManageListReq, resp response.Response) error {
	// ã€æ¡†æ¶è§„èŒƒã€‘é…ç½®è·å–ï¼šä»ä¸Šä¸‹æ–‡è·å–é…ç½®ä¿¡æ¯
	// ã€Whyã€‘ä¸ºä»€ä¹ˆéœ€è¦é…ç½®ï¼šå¤–éƒ¨APIçš„åŸŸåã€Tokenç­‰å‚æ•°éœ€è¦åŠ¨æ€é…ç½®ï¼Œä¸èƒ½ç¡¬ç¼–ç 
	// ã€Whatã€‘é…ç½®è·å–åšä»€ä¹ˆï¼šä»æ¡†æ¶é…ç½®ç®¡ç†ä¸­è·å–APIè¿æ¥å‚æ•°
	// ã€Howã€‘å¦‚ä½•ä½¿ç”¨ï¼šctx.GetConfig().(é…ç½®ç»“æ„ä½“ç±»å‹)ï¼Œæ¡†æ¶è‡ªåŠ¨ç®¡ç†é…ç½®ç”Ÿå‘½å‘¨æœŸ
	config := ctx.GetConfig().(WorkspaceAdminManageAPIConfig)

	// ã€ä¸šåŠ¡é€»è¾‘ã€‘TokenéªŒè¯ï¼šæ£€æŸ¥é…ç½®æ˜¯å¦æœ‰æ•ˆ
	if err := validateToken(config); err != nil {
		return resp.Form(&WorkspaceAdminManageListResp{
			Message:    err.Error(),
			APIStatus:  "é…ç½®é”™è¯¯",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// æ„å»ºAPI URL
	apiURL := fmt.Sprintf("%s?page_size=%d", config.BaseURL, req.PageSize)

	// ã€æ¡†æ¶è§„èŒƒã€‘httpxåº“ä½¿ç”¨ï¼šæ¡†æ¶æä¾›çš„HTTPå®¢æˆ·ç«¯åº“
	// ã€Whyã€‘ä¸ºä»€ä¹ˆç”¨httpxï¼šæ”¯æŒé“¾å¼è°ƒç”¨ã€ç›´æ¥ç»‘å®šå“åº”ç»“æ„ä½“ã€ç»Ÿä¸€é”™è¯¯å¤„ç†
	// ã€Whatã€‘httpxåšä»€ä¹ˆï¼šæä¾›ä¼˜é›…çš„HTTPè¯·æ±‚APIï¼Œæ”¯æŒGET/POST/PUT/DELETEç­‰æ–¹æ³•
	// ã€Howã€‘å¦‚ä½•ä½¿ç”¨ï¼šé“¾å¼è°ƒç”¨Get().Header().Timeout().Do(å“åº”ç»“æ„ä½“)
	// ã€ä¸šåŠ¡é€»è¾‘ã€‘GETè¯·æ±‚è·å–å·¥ä½œç©ºé—´åˆ—è¡¨ï¼ŒåŒ…å«å®Œæ•´çš„è¯·æ±‚å¤´è®¾ç½®å’Œé”™è¯¯å¤„ç†
	var apiResp ExternalAPIResponse
	httpResult, err := httpx.Get(apiURL).
		Header("Content-Type", "application/json").
		Header("Token", config.Token).
		Timeout(time.Duration(config.TimeoutSeconds) * time.Second).
		Do(&apiResp)

	if err != nil {
		return resp.Form(&WorkspaceAdminManageListResp{
			Message:    fmt.Sprintf("è·å–å·¥ä½œç©ºé—´åˆ—è¡¨å¤±è´¥: %v", err),
			APIStatus:  "è¿æ¥å¤±è´¥",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// æ£€æŸ¥HTTPçŠ¶æ€ç 
	if !httpResult.OK() {
		return resp.Form(&WorkspaceAdminManageListResp{
			Message:    fmt.Sprintf("APIè¿”å›é”™è¯¯çŠ¶æ€ç : %d, å“åº”: %s", httpResult.Code, httpResult.ResBodyString),
			APIStatus:  "HTTPé”™è¯¯",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// æ£€æŸ¥APIè¿”å›çŠ¶æ€
	if apiResp.Code != 0 {
		return resp.Form(&WorkspaceAdminManageListResp{
			Message:    fmt.Sprintf("APIè¿”å›é”™è¯¯: %s", apiResp.Msg),
			APIStatus:  "APIä¸šåŠ¡é”™è¯¯",
			ConfigInfo: fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
		}).Build()
	}

	// è½¬æ¢æ•°æ®æ ¼å¼
	workspaces := make([]WorkspaceInfo, 0, len(apiResp.Data.Items))
	for _, external := range apiResp.Data.Items {
		workspaces = append(workspaces, convertExternalToWorkspaceInfo(external))
	}

	// æ„å»ºæˆåŠŸå“åº”
	result := &WorkspaceAdminManageListResp{
		Message:     fmt.Sprintf("æˆåŠŸè·å– %d ä¸ªå·¥ä½œç©ºé—´", len(workspaces)),
		Workspaces:  workspaces,
		TotalCount:  apiResp.Data.TotalCount,
		CurrentPage: apiResp.Data.CurrentPage,
		TotalPages:  apiResp.Data.TotalPages,
		PageSize:    apiResp.Data.PageSize,
		APIStatus:   "è°ƒç”¨æˆåŠŸ",
		ConfigInfo:  fmt.Sprintf("API: %s, è¶…æ—¶: %ds", config.BaseURL, config.TimeoutSeconds),
	}

	return resp.Form(result).Build()
}

// ==================== é…ç½®å’Œæ³¨å†Œ ====================

// åˆ›å»ºå·¥ä½œç©ºé—´é…ç½®
var WorkspaceAdminManageCreateOption = &runner.FormFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName: "å·¥ä½œç©ºé—´ç®¡ç†-åˆ›å»º",
		ApiDesc:     "åˆ›å»ºå·¥ä½œç©ºé—´ï¼Œæ”¯æŒè®¾ç½®æ ‡é¢˜ã€åç§°ã€æè¿°ç­‰åŸºæœ¬ä¿¡æ¯ã€‚",
		Tags:        []string{"å·¥ä½œç©ºé—´ç®¡ç†", "åˆ›å»º", "APIè°ƒç”¨"},
		Request:     &WorkspaceAdminManageCreateReq{},
		Response:    &WorkspaceAdminManageCreateResp{},
		Group:       WorkspaceAdminManageGroup,
		AutoUpdateConfig: &runner.AutoUpdateConfig{ //ã€æ¡†æ¶è§„èŒƒã€‘å¦‚æœéœ€è¦é…ç½®ç®¡ç†åŠŸèƒ½éœ€è¦ç”¨è¿™ä¸ªï¼ŒConfigStructæ˜¯å¯¹åº”çš„é…ç½®ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨çƒ­æ›´æ–°é…ç½®
			ConfigStruct: WorkspaceAdminManageAPIConfig{
				BaseURL:        "http://func-ai.geeleo.com/api/v1/runner",
				Token:          "è¯·æ›¿æ¢æˆçœŸå®token",
				TimeoutSeconds: 30,
			},
		},
	},
	// ã€æ¡†æ¶è§„èŒƒã€‘DryRunå›è°ƒï¼šæ¡†æ¶æä¾›çš„APIæµ‹è¯•æœºåˆ¶
	// ã€Whyã€‘ä¸ºä»€ä¹ˆéœ€è¦DryRunï¼šPOSTç­‰å†™æ“ä½œæœ‰é£é™©ï¼Œéœ€è¦å…ˆæµ‹è¯•è¿æ¥å’Œå‚æ•°ï¼Œé¿å…è¯¯æ“ä½œ
	// ã€Whatã€‘DryRunåšä»€ä¹ˆï¼šæ¨¡æ‹ŸAPIè°ƒç”¨ï¼Œæµ‹è¯•è¿æ¥çŠ¶æ€ï¼ŒéªŒè¯å‚æ•°æ ¼å¼ï¼Œä¸æ‰§è¡Œå®é™…ä¸šåŠ¡
	// ã€Howã€‘å¦‚ä½•ä½¿ç”¨DryRunï¼šå‰ç«¯è‡ªåŠ¨æä¾›DryRunæŒ‰é’®ï¼Œç‚¹å‡»åè§¦å‘OnDryRunå›è°ƒ
	// ã€è§¦å‘æ—¶æœºã€‘ç”¨æˆ·ç‚¹å‡»DryRunæŒ‰é’®æ—¶è‡ªåŠ¨è§¦å‘ï¼Œæ— éœ€ç”¨æˆ·è¾“å…¥DryRunå‚æ•°
	// ã€è¿”å›è¦æ±‚ã€‘å¿…é¡»è¿”å›ValidçŠ¶æ€å’Œæµ‹è¯•æ¡ˆä¾‹ï¼Œæ¡†æ¶è‡ªåŠ¨å±•ç¤ºæµ‹è¯•ç»“æœ
	OnDryRun: func(ctx *runner.Context, req *usercall.OnDryRunReq) (*usercall.OnDryRunResp, error) {
		// ã€æ¡†æ¶è§„èŒƒã€‘é…ç½®è·å–ï¼šä»ä¸Šä¸‹æ–‡è·å–é…ç½®ä¿¡æ¯
		config := ctx.GetConfig().(WorkspaceAdminManageAPIConfig)

		// ã€ä¸šåŠ¡é€»è¾‘ã€‘TokenéªŒè¯ï¼šæ£€æŸ¥é…ç½®æ˜¯å¦æœ‰æ•ˆ
		if err := validateToken(config); err != nil {
			return &usercall.OnDryRunResp{
				Valid:   false,
				Message: err.Error(),
			}, nil
		}

		// ã€æ¡†æ¶è§„èŒƒã€‘å‚æ•°è§£ç ï¼šä»è¯·æ±‚ä¸­è§£ç ç”¨æˆ·è¾“å…¥å‚æ•°
		var createReq WorkspaceAdminManageCreateReq
		if err := req.DecodeBody(&createReq); err != nil {
			return &usercall.OnDryRunResp{
				Valid:   false,
				Message: fmt.Sprintf("å‚æ•°è§£ç å¤±è´¥: %v", err),
			}, nil
		}

		// ã€æ¡†æ¶è§„èŒƒã€‘httpx DryRunï¼šä½¿ç”¨httpxåº“æ„å»ºæµ‹è¯•æ¡ˆä¾‹
		// ã€Whyã€‘ä¸ºä»€ä¹ˆç”¨httpxï¼šhttpxæä¾›ConnectivityCheck()å’ŒDryRun()æ–¹æ³•ï¼Œè‡ªåŠ¨æµ‹è¯•è¿æ¥
		// ã€Whatã€‘httpx DryRunåšä»€ä¹ˆï¼šæ¨¡æ‹ŸHTTPè¯·æ±‚ï¼Œæµ‹è¯•ç½‘ç»œè¿æ¥ï¼ŒéªŒè¯è¯·æ±‚æ ¼å¼
		// ã€Howã€‘å¦‚ä½•ä½¿ç”¨ï¼šé“¾å¼è°ƒç”¨Post().Header().Body().ConnectivityCheck().DryRun()
		// ã€ConnectivityCheckåº•å±‚å®ç°ã€‘é€šè¿‡HEADæ–¹æ³•æµ‹è¯•æ¥å£å¯ç”¨æ€§å’Œç½‘ç»œè¿é€šæ€§
		// ã€ç¯å¢ƒç—›ç‚¹è§£å†³ã€‘å³ä½¿ä»£ç æ­£ç¡®ï¼Œç¯å¢ƒé—®é¢˜ï¼ˆç½‘ç»œã€é˜²ç«å¢™ã€DNSç­‰ï¼‰ä¹Ÿä¼šå¯¼è‡´APIè°ƒç”¨å¤±è´¥
		// ã€ç”¨æˆ·ä»·å€¼ã€‘è®©ç”¨æˆ·æå‰å‘ç°ç¯å¢ƒé—®é¢˜ï¼Œé¿å…å®é™…æ‰§è¡Œæ—¶çš„å¤±è´¥ï¼Œæä¾›ä¿é™©æœºåˆ¶
		dryRunCase := httpx.Post(config.BaseURL).
			Header("Content-Type", "application/json").
			Header("Token", config.Token).
			Timeout(time.Duration(config.TimeoutSeconds) * time.Second).
			Body(createReq).
			ConnectivityCheck().
			DryRun()

		// ã€æ¡†æ¶è§„èŒƒã€‘DryRunå“åº”ï¼šè¿”å›æµ‹è¯•ç»“æœå’Œæ¡ˆä¾‹
		return &usercall.OnDryRunResp{
			Valid:   true,
			Message: fmt.Sprintf("é¢„è§ˆåˆ›å»ºå·¥ä½œç©ºé—´ï¼š%s (%s)", createReq.Title, createReq.Name),
			Cases:   []usercall.DryRunCase{dryRunCase},
		}, nil
	},
}

// è·å–å·¥ä½œç©ºé—´åˆ—è¡¨é…ç½®
var WorkspaceAdminManageListOption = &runner.FormFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName: "å·¥ä½œç©ºé—´ç®¡ç†-åˆ—è¡¨",
		ApiDesc:     "è·å–å·¥ä½œç©ºé—´åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µæŸ¥è¯¢å’Œè¯¦ç»†ä¿¡æ¯å±•ç¤ºã€‚",
		Tags:        []string{"å·¥ä½œç©ºé—´ç®¡ç†", "åˆ—è¡¨", "APIè°ƒç”¨"},
		Request:     &WorkspaceAdminManageListReq{},
		Response:    &WorkspaceAdminManageListResp{},
		Group:       WorkspaceAdminManageGroup,
		AutoUpdateConfig: &runner.AutoUpdateConfig{
			ConfigStruct: WorkspaceAdminManageAPIConfig{ //ã€æ¡†æ¶è§„èŒƒã€‘å¦‚æœéœ€è¦é…ç½®ç®¡ç†åŠŸèƒ½éœ€è¦ç”¨è¿™ä¸ªï¼ŒConfigStructæ˜¯å¯¹åº”çš„é…ç½®ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨çƒ­æ›´æ–°é…ç½®
				BaseURL:        "http://func-ai.geeleo.com/api/v1/runner",
				Token:          "è¯·æ›¿æ¢æˆçœŸå®token",
				TimeoutSeconds: 30,
			},
		},
	},
	// ã€æ¡†æ¶è§„èŒƒã€‘DryRunå›è°ƒï¼šæ¡†æ¶æä¾›çš„APIæµ‹è¯•æœºåˆ¶
	// ã€Whyã€‘ä¸ºä»€ä¹ˆéœ€è¦DryRunï¼šGETè¯·æ±‚ä¹Ÿéœ€è¦æµ‹è¯•è¿æ¥ï¼ŒéªŒè¯å‚æ•°æœ‰æ•ˆæ€§ï¼Œç¡®ä¿APIå¯ç”¨
	// ã€Whatã€‘DryRunåšä»€ä¹ˆï¼šæ¨¡æ‹ŸAPIè°ƒç”¨ï¼Œæµ‹è¯•è¿æ¥çŠ¶æ€ï¼ŒéªŒè¯å‚æ•°æ ¼å¼ï¼Œä¸æ‰§è¡Œå®é™…ä¸šåŠ¡
	// ã€Howã€‘å¦‚ä½•ä½¿ç”¨DryRunï¼šå‰ç«¯è‡ªåŠ¨æä¾›DryRunæŒ‰é’®ï¼Œç‚¹å‡»åè§¦å‘OnDryRunå›è°ƒ
	// ã€è§¦å‘æ—¶æœºã€‘ç”¨æˆ·ç‚¹å‡»DryRunæŒ‰é’®æ—¶è‡ªåŠ¨è§¦å‘ï¼Œæ— éœ€ç”¨æˆ·è¾“å…¥DryRunå‚æ•°
	// ã€è¿”å›è¦æ±‚ã€‘å¿…é¡»è¿”å›ValidçŠ¶æ€å’Œæµ‹è¯•æ¡ˆä¾‹ï¼Œæ¡†æ¶è‡ªåŠ¨å±•ç¤ºæµ‹è¯•ç»“æœ
	OnDryRun: func(ctx *runner.Context, req *usercall.OnDryRunReq) (*usercall.OnDryRunResp, error) {
		// ã€æ¡†æ¶è§„èŒƒã€‘é…ç½®è·å–ï¼šä»ä¸Šä¸‹æ–‡è·å–é…ç½®ä¿¡æ¯
		config := ctx.GetConfig().(WorkspaceAdminManageAPIConfig)

		// ã€ä¸šåŠ¡é€»è¾‘ã€‘TokenéªŒè¯ï¼šæ£€æŸ¥é…ç½®æ˜¯å¦æœ‰æ•ˆ
		if err := validateToken(config); err != nil {
			return &usercall.OnDryRunResp{
				Valid:   false,
				Message: err.Error(),
			}, nil
		}

		// ã€æ¡†æ¶è§„èŒƒã€‘å‚æ•°è§£ç ï¼šä»è¯·æ±‚ä¸­è§£ç ç”¨æˆ·è¾“å…¥å‚æ•°
		var listReq WorkspaceAdminManageListReq
		if err := req.DecodeBody(&listReq); err != nil {
			return &usercall.OnDryRunResp{
				Valid:   false,
				Message: fmt.Sprintf("å‚æ•°è§£ç å¤±è´¥: %v", err),
			}, nil
		}

		// ã€ä¸šåŠ¡é€»è¾‘ã€‘å‚æ•°éªŒè¯ï¼šæ£€æŸ¥ä¸šåŠ¡å‚æ•°æ˜¯å¦æœ‰æ•ˆ
		if listReq.PageSize < 1 || listReq.PageSize > 1000 {
			return &usercall.OnDryRunResp{
				Valid:   false,
				Message: "æ¯é¡µæ•°é‡å¿…é¡»åœ¨1-1000ä¹‹é—´",
			}, nil
		}

		// ã€ä¸šåŠ¡é€»è¾‘ã€‘æ„å»ºAPI URLï¼šæ ¹æ®å‚æ•°æ„å»ºå®Œæ•´çš„è¯·æ±‚URL
		apiURL := fmt.Sprintf("%s?page_size=%d", config.BaseURL, listReq.PageSize)

		// ã€æ¡†æ¶è§„èŒƒã€‘httpx DryRunï¼šä½¿ç”¨httpxåº“æ„å»ºæµ‹è¯•æ¡ˆä¾‹
		// ã€Whyã€‘ä¸ºä»€ä¹ˆç”¨httpxï¼šhttpxæä¾›ConnectivityCheck()å’ŒDryRun()æ–¹æ³•ï¼Œè‡ªåŠ¨æµ‹è¯•è¿æ¥
		// ã€Whatã€‘httpx DryRunåšä»€ä¹ˆï¼šæ¨¡æ‹ŸHTTPè¯·æ±‚ï¼Œæµ‹è¯•ç½‘ç»œè¿æ¥ï¼ŒéªŒè¯è¯·æ±‚æ ¼å¼
		// ã€Howã€‘å¦‚ä½•ä½¿ç”¨ï¼šé“¾å¼è°ƒç”¨Get().Header().ConnectivityCheck().DryRun()
		// ã€ConnectivityCheckåº•å±‚å®ç°ã€‘é€šè¿‡HEADæ–¹æ³•æµ‹è¯•æ¥å£å¯ç”¨æ€§å’Œç½‘ç»œè¿é€šæ€§
		// ã€ç¯å¢ƒç—›ç‚¹è§£å†³ã€‘å³ä½¿ä»£ç æ­£ç¡®ï¼Œç¯å¢ƒé—®é¢˜ï¼ˆç½‘ç»œã€é˜²ç«å¢™ã€DNSç­‰ï¼‰ä¹Ÿä¼šå¯¼è‡´APIè°ƒç”¨å¤±è´¥
		// ã€ç”¨æˆ·ä»·å€¼ã€‘è®©ç”¨æˆ·æå‰å‘ç°ç¯å¢ƒé—®é¢˜ï¼Œé¿å…å®é™…æ‰§è¡Œæ—¶çš„å¤±è´¥ï¼Œæä¾›ä¿é™©æœºåˆ¶
		dryRunCase := httpx.Get(apiURL).
			Header("Content-Type", "application/json").
			Header("Token", config.Token).
			Timeout(time.Duration(config.TimeoutSeconds) * time.Second).
			ConnectivityCheck().
			DryRun()

		// ã€æ¡†æ¶è§„èŒƒã€‘DryRunå“åº”ï¼šè¿”å›æµ‹è¯•ç»“æœå’Œæ¡ˆä¾‹
		return &usercall.OnDryRunResp{
			Valid:   true,
			Message: fmt.Sprintf("é¢„è§ˆè·å–å·¥ä½œç©ºé—´åˆ—è¡¨ï¼šæ¯é¡µ %d ä¸ª", listReq.PageSize),
			Cases:   []usercall.DryRunCase{dryRunCase},
		}, nil
	},
}

// ==================== è·¯ç”±æ³¨å†Œ ====================

func init() {
	// å·¥ä½œç©ºé—´ç®¡ç†æ“ä½œ
	runner.Post(RouterGroup+"/workspace_admin_manage_create", WorkspaceAdminManageCreate, WorkspaceAdminManageCreateOption)
	runner.Post(RouterGroup+"/workspace_admin_manage_list", WorkspaceAdminManageList, WorkspaceAdminManageListOption)
}

//<æ€»ç»“>
//è¿™é‡Œæ˜¯ä¸ªS2çº§åˆ«çš„å·¥ä½œç©ºé—´ç®¡ç†ç³»ç»Ÿï¼ŒåŒ…å«å·¥ä½œç©ºé—´åˆ›å»ºã€åˆ—è¡¨æŸ¥è¯¢ã€é…ç½®ç®¡ç†ç­‰åŠŸèƒ½
//æŠ€æœ¯æ ˆï¼šAutoUpdateConfigé…ç½®ç®¡ç†ã€DryRunå›è°ƒæµ‹è¯•ã€httpxå¤–éƒ¨APIè°ƒç”¨ã€æ•°æ®è½¬æ¢
//å¤æ‚åº¦ï¼šS2çº§åˆ«ï¼ŒåŒ…å«åŸºç¡€å›è°ƒæœºåˆ¶ï¼Œç®€å•çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œå®Œå…¨ç‹¬ç«‹æ— ä¾èµ–
//è®¾è®¡æ¨¡å¼ï¼šä½¿ç”¨AutoUpdateConfigç®¡ç†APIé…ç½®ï¼Œæ”¯æŒå®æ—¶é…ç½®æ›´æ–°ï¼Œç¬¦åˆæ¡†æ¶æœ€ä½³å®è·µ
//é‡è¦æé†’ï¼šDryRunå›è°ƒç‹¬ç«‹äºæ­£å¸¸å¤„ç†é€»è¾‘ï¼Œç”¨äºæµ‹è¯•éªŒè¯ï¼Œå‰ç«¯è‡ªåŠ¨æä¾›DryRunæŒ‰é’®
//å¤–éƒ¨APIï¼šä½¿ç”¨httpxåº“è°ƒç”¨è¿œç¨‹APIï¼Œæ”¯æŒTokenè®¤è¯ã€è¶…æ—¶è®¾ç½®å’Œè¿é€šæ€§æ£€æŸ¥
//åŠŸèƒ½è¯´æ˜ï¼šæ”¯æŒå·¥ä½œç©ºé—´åˆ›å»ºã€åˆ—è¡¨æŸ¥è¯¢ã€APIé…ç½®ç®¡ç†ã€è¿æ¥æµ‹è¯•ç­‰å®Œæ•´å·¥ä½œç©ºé—´ç®¡ç†åŠŸèƒ½
//</æ€»ç»“>


```

### ç¤ºä¾‹5ï¼šå¤æ‚Table+Formç³»ç»Ÿ - é‡‡è´­ç®¡ç†ç³»ç»Ÿ

**åŠŸèƒ½**ï¼šå®Œæ•´çš„é‡‡è´­ä¸šåŠ¡æµç¨‹ï¼ŒåŒ…å«ä¾›åº”å•†ç®¡ç†ã€å•†å“ç®¡ç†ã€é‡‡è´­è®°å½•

```go
//retail_purchase.go

/*
<metadata>
<ç”¨æˆ·éœ€æ±‚>
æˆ‘éœ€è¦ä¸€ä¸ªé‡‡è´­ç®¡ç†ç³»ç»Ÿï¼Œå¸®åŠ©é‡‡è´­å‘˜ç®¡ç†ä¾›åº”å•†ã€å•†å“å’Œé‡‡è´­è®°å½•ã€‚

åŠŸèƒ½éœ€æ±‚ï¼š

ä¾›åº”å•†ç®¡ç†ï¼š
- ä¾›åº”å•†ä¿¡æ¯ï¼šåç§°ã€è”ç³»æ–¹å¼ã€åœ°å€ã€çŠ¶æ€
- ä¾›åº”å•†çŠ¶æ€ï¼šæ­£å¸¸åˆä½œã€æš‚åœåˆä½œã€ç»ˆæ­¢åˆä½œ

å•†å“ç®¡ç†ï¼š
- å•†å“ä¿¡æ¯ï¼šåç§°ã€åˆ†ç±»ã€è§„æ ¼ã€å•ä½ã€æ ‡å‡†å•ä»·
- å•†å“åˆ†ç±»ï¼šåŸææ–™ã€åŠæˆå“ã€æˆå“ã€åŒ…è£…ç‰©
- å•†å“çŠ¶æ€ï¼šæ­£å¸¸é‡‡è´­ã€æš‚åœé‡‡è´­ã€æ·˜æ±°
- å•†å“å½’å±ï¼šæ¯ä¸ªå•†å“å±äºç‰¹å®šä¾›åº”å•†

é‡‡è´­ç®¡ç†ï¼š
- é‡‡è´­ç”³è¯·ï¼šé€‰æ‹©ä¾›åº”å•†ã€å¤šé€‰è¯¥ä¾›åº”å•†çš„å•†å“ã€å¡«å†™æ•°é‡
- é‡‡è´­è®°å½•ï¼šè®°å½•é‡‡è´­å†å²ã€çŠ¶æ€è·Ÿè¸ª
- ç»Ÿè®¡åˆ†æï¼šé‡‡è´­é‡‘é¢ã€å•†å“ç§ç±»ã€ä¾›åº”å•†åˆ†æ

ä¸šåŠ¡è§„åˆ™ï¼š
- é‡‡è´­æ•°é‡å¿…é¡»å¤§äº0
- ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—æ€»ä»·ï¼ˆæ•°é‡ Ã— æ ‡å‡†å•ä»·ï¼‰
- é‡‡è´­çŠ¶æ€ï¼šå¾…å®¡æ ¸ã€å·²å®¡æ ¸ã€å·²å®Œæˆã€å·²å–æ¶ˆ
</ç”¨æˆ·éœ€æ±‚>


<æ–‡ä»¶>retail_purchase.go</æ–‡ä»¶>

</metadata>
*/


package retail

import (
	"errors"
	"fmt"

	"github.com/yunhanshu-net/function-go/pkg/dto/response"
	"github.com/yunhanshu-net/function-go/pkg/dto/usercall"
	"github.com/yunhanshu-net/function-go/runner"
	"github.com/yunhanshu-net/pkg/query"
	"gorm.io/gorm"
)

// ================ å‡½æ•°ç»„é…ç½® ================

var RetailPurchaseGroup = &runner.FunctionGroup{
	CnName: "é‡‡è´­ç®¡ç†",
	EnName: "retail_purchase",
}

// ================ æ•°æ®æ¨¡å‹ï¼ˆæŒ‰ä¾èµ–å…³ç³»æ’åºï¼‰ ================
// ã€æ¡†æ¶è§„èŒƒã€‘å…³è”å…³ç³»æŒ‚è½½Modelè§„åˆ™ï¼š
// 1. æ¯ä¸ªæœ‰å¤–é”®çš„è¡¨éƒ½å¿…é¡»æŒ‚è½½å¯¹åº”çš„Modelç»“æ„ä½“
// 2. å‘½åè§„èŒƒï¼šå…³è”å­—æ®µå = å…³è”è¡¨ç»“æ„ä½“åï¼ˆå¦‚ï¼šSupplier RetailPurchaseSupplierï¼‰
// 3. æ ‡ç­¾è§„èŒƒï¼šjson:"-" runner:"-" gorm:"foreignKey:å­—æ®µå"
// 4. ä½¿ç”¨åœºæ™¯ï¼šPreload("å…³è”å­—æ®µå")ã€JOINæŸ¥è¯¢ã€å…³è”å­—æ®µå¡«å……
// 5. å¥½å¤„ï¼šé¿å…N+1æŸ¥è¯¢ã€æ”¯æŒå…³è”æœç´¢ã€æå‡æŸ¥è¯¢æ€§èƒ½

// 1. ä¾›åº”å•†ä¿¡æ¯ï¼ˆåŸºç¡€æ•°æ®ï¼Œè¢«å…¶ä»–è¡¨ä¾èµ–ï¼‰
type RetailPurchaseSupplier struct {
	ID        int            `json:"id" gorm:"primaryKey;autoIncrement" runner:"name:ä¾›åº”å•†ID" permission:"read"`
	CreatedAt int64          `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
	UpdatedAt int64          `json:"updated_at" gorm:"autoUpdateTime:milli" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
	DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index" runner:"-"`

	Name    string `json:"name" gorm:"column:name;comment:ä¾›åº”å•†åç§°" runner:"name:ä¾›åº”å•†åç§°" widget:"type:input" search:"like" validate:"required,min=2,max=100" msg:"ä¾›åº”å•†åç§°å¿…å¡«ï¼Œé•¿åº¦2-100å­—ç¬¦"`
	Contact string `json:"contact" gorm:"column:contact;comment:è”ç³»äºº" runner:"name:è”ç³»äºº" widget:"type:input" search:"like" validate:"required,min=2,max=50" msg:"è”ç³»äººå¿…å¡«ï¼Œé•¿åº¦2-50å­—ç¬¦"`
	Phone   string `json:"phone" gorm:"column:phone;comment:è”ç³»ç”µè¯" runner:"name:è”ç³»ç”µè¯" widget:"type:input" search:"like" validate:"required,min=11,max=20" msg:"è”ç³»ç”µè¯å¿…å¡«ï¼Œé•¿åº¦11-20å­—ç¬¦"`
	Address string `json:"address" gorm:"column:address;comment:åœ°å€" runner:"name:åœ°å€" widget:"type:input;mode:text_area" search:"like" validate:"required,min=5,max=200" msg:"åœ°å€å¿…å¡«ï¼Œé•¿åº¦5-200å­—ç¬¦"`
}

func (RetailPurchaseSupplier) TableName() string { return "retail_purchase_supplier" }

// 2. å•†å“ä¿¡æ¯ï¼ˆä¾èµ–ä¾›åº”å•†ï¼Œè¢«é‡‡è´­è®°å½•ä¾èµ–ï¼‰
type RetailPurchaseProduct struct {
	ID        int            `json:"id" gorm:"primaryKey;autoIncrement" runner:"name:å•†å“ID" permission:"read"`
	CreatedAt int64          `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
	UpdatedAt int64          `json:"updated_at" gorm:"autoUpdateTime:milli" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
	DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index" runner:"-"`

	// ã€æ¡†æ¶è¯´æ˜ã€‘SupplierIDå¿…é¡»ä½¿ç”¨selectç»„ä»¶æ‰èƒ½æ”¯æŒOnInputFuzzyæ¨¡ç³Šæœç´¢åŠŸèƒ½
	// åªæœ‰selectï¼ˆå•é€‰ï¼‰å’Œmultiselectï¼ˆå¤šé€‰ï¼‰ç»„ä»¶æ‰æ”¯æŒåŠ¨æ€æ•°æ®æºæ¨¡ç³Šæœç´¢
	// numberç»„ä»¶ä¸æ”¯æŒæ¨¡ç³Šæœç´¢ï¼Œç”¨æˆ·æ— æ³•é€šè¿‡åç§°æœç´¢ä¾›åº”å•†
	SupplierID int `json:"supplier_id" gorm:"column:supplier_id;comment:ä¾›åº”å•†ID" runner:"name:ä¾›åº”å•†" widget:"type:select" search:"in" validate:"required" msg:"è¯·é€‰æ‹©ä¾›åº”å•†"`

	// ã€æ¡†æ¶è¯´æ˜ã€‘SupplierNameåœ¨åˆ—è¡¨å±•ç¤ºæ—¶è‡ªåŠ¨å¡«å……ï¼Œå±äºjoinå…¶ä»–è¡¨çš„å­—æ®µäº†ï¼Œå› æ­¤è¿™ä¸ªå­—æ®µä¸èƒ½åŠ searchæ ‡ç­¾ï¼Œæ³¨æ„ï¼Œæ³¨æ„ï¼Œæ³¨æ„ï¼šgorm:"-"çš„å­—æ®µä¸èƒ½åŠ searchæ ‡ç­¾
	//  æ‰€ä»¥æ­¤æ—¶å¦‚æœéœ€è¦æ”¯æŒéè¡¨å†…å­—æ®µçš„æœç´¢ï¼Œéœ€è¦åœ¨è¯·æ±‚å‚æ•°å†…æ·»åŠ è¿™ä¸ªå­—æ®µï¼Œå‚è€ƒï¼šRetailPurchaseRecordListReqï¼Œåœ¨é‡Œé¢æ‰©å±•å­—æ®µ
	// permission:"read"è¡¨ç¤ºä»…åœ¨åˆ—è¡¨æ˜¾ç¤ºï¼Œæ–°å¢å’Œç¼–è¾‘æ—¶ä¸æ˜¾ç¤º
	SupplierName string  `json:"supplier_name" gorm:"-" runner:"name:ä¾›åº”å•†åç§°" widget:"type:input" permission:"read"` // ã€è™šæ‹Ÿå­—æ®µã€‘é€šè¿‡é¢„åŠ è½½å¡«å……ï¼Œä¸å­˜å‚¨åˆ°æ•°æ®åº“
	Name         string  `json:"name" gorm:"column:name;comment:å•†å“åç§°" runner:"name:å•†å“åç§°" widget:"type:input" search:"like" validate:"required,min=2,max=100" msg:"å•†å“åç§°å¿…å¡«ï¼Œé•¿åº¦2-100å­—ç¬¦"`
	Category     string  `json:"category" gorm:"column:category;comment:å•†å“åˆ†ç±»" runner:"name:å•†å“åˆ†ç±»" widget:"type:select;options:åŸææ–™,åŠæˆå“,æˆå“,åŒ…è£…ç‰©" data:"default_value:åŸææ–™" search:"in" validate:"required,oneof=åŸææ–™ åŠæˆå“ æˆå“ åŒ…è£…ç‰©" msg:"è¯·é€‰æ‹©å•†å“åˆ†ç±»"`
	Spec         string  `json:"spec" gorm:"column:spec;comment:è§„æ ¼" runner:"name:è§„æ ¼" widget:"type:input" search:"like" validate:"required,min=2,max=100" msg:"è§„æ ¼å¿…å¡«ï¼Œé•¿åº¦2-100å­—ç¬¦" data:"example:500g;100ml;A4å°ºå¯¸;Mç ;çº¢è‰²"`
	Unit         string  `json:"unit" gorm:"column:unit;comment:å•ä½" runner:"name:å•ä½" widget:"type:input" search:"like" validate:"required,min=1,max=20" msg:"å•ä½å¿…å¡«ï¼Œé•¿åº¦1-20å­—ç¬¦" data:"example:ä¸ª;ä»¶;åŒ…;ç›’;ç±³;åƒå…‹;å‡"`
	UnitPrice    float64 `json:"unit_price" gorm:"column:unit_price;comment:æ ‡å‡†å•ä»·" runner:"name:æ ‡å‡†å•ä»·" widget:"type:number;min:0;precision:2" search:"gte,lte" validate:"required,min=0" msg:"æ ‡å‡†å•ä»·å¿…é¡»å¤§äº0"`

	// ã€æ¡†æ¶è§„èŒƒã€‘å…³è”å…³ç³»æŒ‚è½½Modelï¼Œæ”¯æŒé¢„åŠ è½½å’Œå…³è”æŸ¥è¯¢
	// å‘½åè§„èŒƒï¼šå…³è”å­—æ®µå = å…³è”è¡¨ç»“æ„ä½“å
	// ä½¿ç”¨åœºæ™¯ï¼šPreload("Supplier")ã€JOINæŸ¥è¯¢ã€å…³è”å­—æ®µå¡«å……
	// æ³¨æ„äº‹é¡¹ï¼šjson:"-" éšè—å­—æ®µï¼Œrunner:"-" ä¸æ¸²æŸ“ï¼Œgorm:"foreignKey:SupplierID" æŒ‡å®šå¤–é”®
	Supplier RetailPurchaseSupplier `json:"-" runner:"-" gorm:"foreignKey:SupplierID"`
}

func (RetailPurchaseProduct) TableName() string { return "retail_purchase_product" }

// 3. é‡‡è´­å•†å“é¡¹ï¼ˆä¸šåŠ¡æ•°æ®ï¼Œä¾èµ–å•†å“ä¿¡æ¯ï¼‰
type RetailPurchaseItem struct {
	ProductID int `json:"product_id" runner:"name:å•†å“" widget:"type:select" validate:"required" msg:"è¯·é€‰æ‹©å•†å“"`
	Quantity  int `json:"quantity" runner:"name:æ•°é‡" widget:"type:number;min:1" data:"default_value:1" validate:"required,min=1" msg:"æ•°é‡å¿…é¡»å¤§äº0"`
}

// 5. é‡‡è´­è¯·æ±‚ï¼ˆä¸šåŠ¡æ“ä½œï¼Œä¾èµ–ä¸Šè¿°æ‰€æœ‰æ¨¡å‹ï¼‰
type RetailPurchaseReq struct {
	SupplierID int                  `json:"supplier_id" runner:"name:ä¾›åº”å•†" widget:"type:select" validate:"required" msg:"è¯·é€‰æ‹©ä¾›åº”å•†"`
	Items      []RetailPurchaseItem `json:"items" runner:"name:é‡‡è´­å•†å“" widget:"type:list" validate:"required,min=1" msg:"è¯·è‡³å°‘é€‰æ‹©ä¸€ä»¶å•†å“"`
	Remarks    string               `json:"remarks" runner:"name:å¤‡æ³¨" widget:"type:input;mode:text_area"`
}

// 4. é‡‡è´­è®°å½•ï¼ˆä¸šåŠ¡æ•°æ®ï¼Œä¾èµ–ä¾›åº”å•†å’Œå•†å“ï¼‰
type RetailPurchaseRecord struct {
	ID        int            `json:"id" gorm:"primaryKey;autoIncrement" runner:"name:é‡‡è´­ID" permission:"read"`
	CreatedAt int64          `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
	UpdatedAt int64          `json:"updated_at" gorm:"autoUpdateTime:milli" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
	DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index" runner:"-"`

	// ã€æ¡†æ¶è¯´æ˜ã€‘SupplierIDåœ¨è®°å½•è¡¨ä¸­ä½¿ç”¨numberç»„ä»¶ï¼Œå› ä¸ºè¿™æ˜¯å†å²æ•°æ®å±•ç¤ºï¼Œä¸éœ€è¦è”æƒ³åŠŸèƒ½
	// è”æƒ³åŠŸèƒ½åªåœ¨æ–°å¢/ç¼–è¾‘æ—¶ä½¿ç”¨ï¼Œè®°å½•è¡¨ä¸»è¦ç”¨äºæŸ¥è¯¢å’Œå±•ç¤º
	// ã€æ¡†æ¶è¯´æ˜ã€‘SupplierIDåœ¨è®°å½•è¡¨ä¸­ä½¿ç”¨selectç»„ä»¶ï¼Œæ”¯æŒè”æƒ³åŠŸèƒ½
	// æ–°å¢å’Œç¼–è¾‘æ—¶å¯ä»¥é€‰æ‹©ä¾›åº”å•†ï¼Œåˆ—è¡¨å±•ç¤ºæ—¶éšè—IDå­—æ®µ
	SupplierID int `json:"supplier_id" gorm:"column:supplier_id;comment:ä¾›åº”å•†ID" runner:"name:ä¾›åº”å•†" widget:"type:select" search:"in" validate:"required" msg:"è¯·é€‰æ‹©ä¾›åº”å•†" permission:"create,update"`
	// ã€æ¡†æ¶è¯´æ˜ã€‘SupplierNameåœ¨åˆ—è¡¨å±•ç¤ºæ—¶è‡ªåŠ¨å¡«å……ï¼Œå±äºjoinå…¶ä»–è¡¨çš„å­—æ®µäº†ï¼Œå› æ­¤è¿™ä¸ªå­—æ®µä¸èƒ½åŠ searchæ ‡ç­¾ï¼Œæ³¨æ„ï¼Œæ³¨æ„ï¼Œæ³¨æ„ï¼šgorm:"-"çš„å­—æ®µä¸èƒ½åŠ searchæ ‡ç­¾
	//  æ‰€ä»¥æ­¤æ—¶å¦‚æœéœ€è¦æ”¯æŒéè¡¨å†…å­—æ®µçš„æœç´¢ï¼Œéœ€è¦åœ¨è¯·æ±‚å‚æ•°å†…æ·»åŠ è¿™ä¸ªå­—æ®µï¼Œå‚è€ƒï¼šRetailPurchaseRecordListReqï¼Œåœ¨é‡Œé¢æ‰©å±•å­—æ®µ
	// permission:"read"è¡¨ç¤ºä»…åœ¨åˆ—è¡¨æ˜¾ç¤ºï¼Œæ–°å¢å’Œç¼–è¾‘æ—¶ä¸æ˜¾ç¤º
	SupplierName string  `json:"supplier_name" gorm:"-" runner:"name:ä¾›åº”å•†åç§°" widget:"type:input"  validate:"required" msg:"ä¾›åº”å•†åç§°å¿…å¡«" permission:"read"`
	TotalAmount  float64 `json:"total_amount" gorm:"column:total_amount;comment:æ€»é‡‘é¢" runner:"name:æ€»é‡‘é¢" widget:"type:number;precision:2" search:"gte,lte" validate:"required,min=0" msg:"æ€»é‡‘é¢å¿…é¡»å¤§äº0"`
	TotalItems   int     `json:"total_items" gorm:"column:total_items;comment:å•†å“ç§ç±»" runner:"name:å•†å“ç§ç±»" widget:"type:number" search:"gte,lte" validate:"required,min=1" msg:"å•†å“ç§ç±»å¿…é¡»å¤§äº0"`
	Status       string  `json:"status" gorm:"column:status;comment:çŠ¶æ€" runner:"name:çŠ¶æ€" widget:"type:select;options:å¾…å®¡æ ¸,å·²å®¡æ ¸,å·²å®Œæˆ,å·²å–æ¶ˆ" data:"default_value:å¾…å®¡æ ¸" search:"in" validate:"required,oneof=å¾…å®¡æ ¸ å·²å®¡æ ¸ å·²å®Œæˆ å·²å–æ¶ˆ" msg:"è¯·é€‰æ‹©é‡‡è´­çŠ¶æ€"`
	Remarks      string  `json:"remarks" gorm:"column:remarks;comment:å¤‡æ³¨" runner:"name:å¤‡æ³¨" widget:"type:input;mode:text_area" search:"like"`

	// ã€æ¡†æ¶è§„èŒƒã€‘å…³è”å…³ç³»æŒ‚è½½Modelï¼Œæ”¯æŒé¢„åŠ è½½å’Œå…³è”æŸ¥è¯¢
	// å‘½åè§„èŒƒï¼šå…³è”å­—æ®µå = å…³è”è¡¨ç»“æ„ä½“å
	// ä½¿ç”¨åœºæ™¯ï¼šPreload("Supplier")ã€JOINæŸ¥è¯¢ã€å…³è”å­—æ®µå¡«å……
	// æ³¨æ„äº‹é¡¹ï¼šjson:"-" éšè—å­—æ®µï¼Œrunner:"-" ä¸æ¸²æŸ“ï¼Œgorm:"foreignKey:SupplierID" æŒ‡å®šå¤–é”®
	Supplier RetailPurchaseSupplier `json:"-" runner:"-" gorm:"foreignKey:SupplierID"`
}

func (RetailPurchaseRecord) TableName() string { return "retail_purchase_record" }

// 6. é‡‡è´­å“åº”ï¼ˆä¸šåŠ¡ç»“æœï¼‰
type RetailPurchaseResp struct {
	PurchaseID  int     `json:"purchase_id" runner:"name:é‡‡è´­ID" widget:"type:number"`
	TotalAmount float64 `json:"total_amount" runner:"name:æ€»é‡‘é¢" widget:"type:number;precision:2"`
	TotalItems  int     `json:"total_items" runner:"name:å•†å“ç§ç±»" widget:"type:number"`
	Message     string  `json:"message" runner:"name:å¤„ç†ç»“æœ" widget:"type:input;mode:text_area"`
}

// ================ ä¸šåŠ¡é€»è¾‘å‡½æ•°ï¼ˆæŒ‰è°ƒç”¨é¡ºåºæ’åºï¼‰ ================

// 1. è¾…åŠ©å‡½æ•°ï¼šéªŒè¯å•†å“å¹¶è®¡ç®—æ€»é‡‘é¢
func retailPurchaseValidateAndCalculate(db *gorm.DB, supplierID int, items []RetailPurchaseItem) (float64, int, error) {
	if len(items) == 0 {
		return 0, 0, fmt.Errorf("é‡‡è´­å•†å“ä¸èƒ½ä¸ºç©º")
	}

	var totalAmount float64
	productIDs := make([]int, 0, len(items))

	for _, item := range items {
		if item.Quantity <= 0 {
			return 0, 0, fmt.Errorf("å•†å“æ•°é‡å¿…é¡»å¤§äº0")
		}
		productIDs = append(productIDs, item.ProductID)
	}

	// éªŒè¯å•†å“æ˜¯å¦å­˜åœ¨ä¸”å±äºæŒ‡å®šä¾›åº”å•†
	var products []*RetailPurchaseProduct
	if err := db.Where("id IN ? AND supplier_id = ?", productIDs, supplierID).Find(&products).Error; err != nil {
		return 0, 0, fmt.Errorf("éªŒè¯å•†å“å¤±è´¥: %v", err)
	}
	if len(products) != len(productIDs) {
		return 0, 0, fmt.Errorf("éƒ¨åˆ†å•†å“ä¸å­˜åœ¨æˆ–ä¸å±äºè¯¥ä¾›åº”å•†")
	}

	// è®¡ç®—æ€»é‡‘é¢ï¼ˆæ•°é‡ Ã— æ ‡å‡†å•ä»·ï¼‰
	for _, item := range items {
		for _, product := range products {
			if product.ID == item.ProductID {
				totalAmount += float64(item.Quantity) * product.UnitPrice
				break
			}
		}
	}

	return totalAmount, len(productIDs), nil
}

// 2. ä¸»è¦ä¸šåŠ¡å‡½æ•°ï¼šåˆ›å»ºé‡‡è´­ç”³è¯·
func RetailPurchaseCreate(ctx *runner.Context, req *RetailPurchaseReq, resp response.Response) error {
	db := ctx.MustGetOrInitDB()

	// 1. éªŒè¯ä¾›åº”å•†
	var supplier RetailPurchaseSupplier
	if err := db.Where("id = ?", req.SupplierID).First(&supplier).Error; err != nil {
		if errors.Is(err, gorm.ErrRecordNotFound) {
			return resp.Form(&RetailPurchaseResp{
				Message: "ä¾›åº”å•†ä¸å­˜åœ¨",
			}).Build()
		}
		return resp.Form(&RetailPurchaseResp{
			Message: fmt.Sprintf("æŸ¥è¯¢ä¾›åº”å•†å¤±è´¥: %v", err),
		}).Build()
	}

	// 2. éªŒè¯å•†å“å¹¶è®¡ç®—
	totalAmount, totalItems, err := retailPurchaseValidateAndCalculate(db, req.SupplierID, req.Items)
	if err != nil {
		return resp.Form(&RetailPurchaseResp{
			Message: fmt.Sprintf("å•†å“éªŒè¯å¤±è´¥: %v", err),
		}).Build()
	}

	// 3. åˆ›å»ºé‡‡è´­è®°å½•
	purchaseRecord := &RetailPurchaseRecord{
		SupplierID:   req.SupplierID,
		SupplierName: supplier.Name,
		TotalAmount:  totalAmount,
		TotalItems:   totalItems,
		Status:       "å¾…å®¡æ ¸",
		Remarks:      req.Remarks,
	}

	if err := db.Create(purchaseRecord).Error; err != nil {
		ctx.Logger.Errorf("åˆ›å»ºé‡‡è´­è®°å½•å¤±è´¥: %v", err)
		return resp.Form(&RetailPurchaseResp{
			Message: "åˆ›å»ºé‡‡è´­è®°å½•å¤±è´¥ï¼Œè¯·é‡è¯•",
		}).Build()
	}

	return resp.Form(&RetailPurchaseResp{
		PurchaseID:  purchaseRecord.ID,
		TotalAmount: totalAmount,
		TotalItems:  totalItems,
		Message:     "é‡‡è´­ç”³è¯·åˆ›å»ºæˆåŠŸ",
	}).Build()
}

// ================ Tableå‡½æ•°ï¼ˆæŒ‰æ•°æ®ä¾èµ–å…³ç³»æ’åºï¼‰ ================

// 1. ä¾›åº”å•†åˆ—è¡¨ç®¡ç†ï¼ˆåŸºç¡€æ•°æ®ç®¡ç†ï¼‰
func RetailPurchaseSupplierList(ctx *runner.Context, req *query.SearchFilterPageReq, resp response.Response) error {
	db := ctx.MustGetOrInitDB()
	var rows []*RetailPurchaseSupplier
	return resp.Table(&rows).AutoPaginated(db, &RetailPurchaseSupplier{}, req).Build()
}

// 2. å•†å“åˆ—è¡¨ç®¡ç†ï¼ˆä¾èµ–ä¾›åº”å•†æ•°æ®ï¼‰
func RetailPurchaseProductList(ctx *runner.Context, req *query.SearchFilterPageReq, resp response.Response) error {
	db := ctx.MustGetOrInitDB()
	var rows []*RetailPurchaseProduct

	// ã€ä¼˜åŒ–ã€‘é¢„åŠ è½½ä¾›åº”å•†ä¿¡æ¯ï¼Œé¿å…N+1æŸ¥è¯¢é—®é¢˜
	query := db.Model(&RetailPurchaseProduct{}).Preload("Supplier")

	// è·å–åˆ†é¡µæ•°æ®ï¼ˆåº”ç”¨æ‰‹åŠ¨æ„å»ºçš„æŸ¥è¯¢æ¡ä»¶ï¼‰
	td := resp.Table(&rows).AutoPaginated(query, &RetailPurchaseProduct{}, req)

	// ã€æ¡†æ¶è¯´æ˜ã€‘å¡«å……è™šæ‹Ÿå­—æ®µï¼Œæå‡ç”¨æˆ·ä½“éªŒ
	// åœ¨åˆ—è¡¨å±•ç¤ºæ—¶è‡ªåŠ¨å¡«å……ä¾›åº”å•†åç§°ï¼Œé¿å…æ˜¾ç¤ºæ— æ„ä¹‰çš„ID
	for _, row := range rows {
		if row.Supplier.ID > 0 {
			row.SupplierName = row.Supplier.Name
		}
	}

	return td.Build()
}

// 3. é‡‡è´­è®°å½•åˆ—è¡¨ç®¡ç†ï¼ˆä¾èµ–ä¾›åº”å•†å’Œå•†å“æ•°æ®ï¼‰
type RetailPurchaseRecordListReq struct {
	query.SearchFilterPageReq `runner:"-"`

	// ã€æ¡†æ¶è¯´æ˜ã€‘joinå­—æ®µæœç´¢å‚æ•°
	// query.SearchFilterPageReq é»˜è®¤åªæ”¯æŒå½“å‰è¡¨å­—æ®µçš„æœç´¢ï¼ˆå¦‚ TotalAmountã€TotalItemsã€Statusï¼‰
	// ä½†æ— æ³•å¤„ç†å…³è”è¡¨çš„å­—æ®µæœç´¢ï¼ˆå¦‚ä¾›åº”å•†åç§°ï¼‰ï¼Œéœ€è¦æ‰‹åŠ¨å®ç°å…³è”æŸ¥è¯¢
	SupplierName string `json:"supplier_name" runner:"name:ä¾›åº”å•†åç§°" widget:"type:input" search:"like"` // æŒ‰ä¾›åº”å•†åç§°æ¨¡ç³Šæœç´¢
}

func RetailPurchaseRecordList(ctx *runner.Context, req *RetailPurchaseRecordListReq, resp response.Response) error {
	db := ctx.MustGetOrInitDB()
	var rows []*RetailPurchaseRecord

	// ã€æ¡†æ¶è¯´æ˜ã€‘æ‰‹åŠ¨å®ç°joinå­—æ®µçš„æœç´¢é€»è¾‘
	// å› ä¸ºæ¡†æ¶çš„ AutoPaginated æ— æ³•è‡ªåŠ¨å¤„ç†å…³è”è¡¨å­—æ®µçš„æœç´¢
	// éœ€è¦æ‰‹åŠ¨æ„å»ºæŸ¥è¯¢æ¡ä»¶ï¼Œå®ç°ç±»ä¼¼ JOIN çš„æ•ˆæœ
	query := db.Model(&RetailPurchaseRecord{})

	// æŒ‰ä¾›åº”å•†åç§°æ¨¡ç³Šæœç´¢ï¼ˆéœ€è¦å…³è”æŸ¥è¯¢ï¼‰
	if req.SupplierName != "" {
		// å…ˆæŸ¥è¯¢åŒ¹é…çš„ä¾›åº”å•†ID
		var supplierIDs []int
		if err := db.Model(&RetailPurchaseSupplier{}).
			Where("name LIKE ?", "%"+req.SupplierName+"%").
			Pluck("id", &supplierIDs).Error; err == nil && len(supplierIDs) > 0 {
			query = query.Where("supplier_id IN ?", supplierIDs)
		} else {
			// å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ä¾›åº”å•†ï¼Œè¿”å›ç©ºç»“æœ
			return resp.Table(nil).Build()
		}
	}
	// ã€ä¼˜åŒ–ã€‘é¢„åŠ è½½ä¾›åº”å•†ä¿¡æ¯ï¼Œé¿å…N+1æŸ¥è¯¢é—®é¢˜
	query = query.Preload("Supplier")
	// è·å–åˆ†é¡µæ•°æ®ï¼ˆåº”ç”¨æ‰‹åŠ¨æ„å»ºçš„æŸ¥è¯¢æ¡ä»¶ï¼‰
	td := resp.Table(&rows).AutoPaginated(query, &RetailPurchaseRecord{}, &req.SearchFilterPageReq)

	// ã€æ¡†æ¶è¯´æ˜ã€‘å¡«å……joinå­—æ®µï¼Œæå‡ç”¨æˆ·ä½“éªŒ
	// åœ¨åˆ—è¡¨å±•ç¤ºæ—¶è‡ªåŠ¨å¡«å……ä¾›åº”å•†åç§°ï¼Œé¿å…æ˜¾ç¤ºæ— æ„ä¹‰çš„ID
	for _, row := range rows {
		row.SupplierName = row.Supplier.Name
	}

	return td.Build()
}

// ================ å‡½æ•°é…ç½®ï¼ˆæŒ‰åŠŸèƒ½å±‚æ¬¡æ’åºï¼‰ ================

// 1. ä¾›åº”å•†åˆ—è¡¨é…ç½®ï¼ˆåŸºç¡€æ•°æ®ç®¡ç†ï¼‰
var RetailPurchaseSupplierListOption = &runner.TableFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "é‡‡è´­ä¾›åº”å•†ç®¡ç†",
		ApiDesc:      "ä¾›åº”å•†åŸºç¡€ä¿¡æ¯ç®¡ç†ï¼Œæ”¯æŒå¢åˆ æ”¹æŸ¥å’Œæœç´¢",
		Tags:         []string{"é‡‡è´­ç®¡ç†", "ä¾›åº”å•†ç®¡ç†"},
		Request:      &query.SearchFilterPageReq{},
		Response:     query.PaginatedTable[[]*RetailPurchaseSupplier]{},
		CreateTables: []interface{}{&RetailPurchaseSupplier{}},
		Group:        RetailPurchaseGroup,
	},
	AutoCrudTable: &RetailPurchaseSupplier{},

	// ã€æ¡†æ¶è¯´æ˜ã€‘OnTableAddRows åœ¨æ–°å¢ä¾›åº”å•†åè§¦å‘ï¼Œç”¨äºé¢å¤–çš„ä¸šåŠ¡é€»è¾‘å¤„ç†
	// è§¦å‘æ—¶æœºï¼šç”¨æˆ·æ–°å¢ä¾›åº”å•†æˆåŠŸå    ä½¿ç”¨åœºæ™¯ï¼šè®°å½•æ—¥å¿—ã€å‘é€é€šçŸ¥ã€æ›´æ–°ç¼“å­˜ç­‰
	// âš ï¸ é‡è¦ï¼šæœ‰æ­¤å›è°ƒæ—¶æ¡†æ¶ä¸ä¼šè‡ªåŠ¨å†™å…¥æ•°æ®ï¼Œå¿…é¡»åœ¨å›è°ƒä¸­æ‰‹åŠ¨æ‰§è¡Œ db.Create()
	OnTableAddRows: func(ctx *runner.Context, req *usercall.OnTableAddRowsReq) (*usercall.OnTableAddRowsResp, error) {
		// ã€ä¸šåŠ¡åœºæ™¯ã€‘æ–°å¢ä¾›åº”å•†åï¼Œè®°å½•æ“ä½œæ—¥å¿—
		// è¿™é‡Œæ¼”ç¤ºäº†å¦‚ä½•åœ¨åŸºç¡€CRUDä¹‹å¤–æ·»åŠ é¢å¤–çš„ä¸šåŠ¡æ“ä½œ

		// è§£ææ–°å¢çš„ä¾›åº”å•†æ•°æ®
		var suppliers []*RetailPurchaseSupplier
		if err := req.DecodeBy(&suppliers); err != nil {
			return nil, fmt.Errorf("è§£æä¾›åº”å•†æ•°æ®å¤±è´¥: %v", err)
		}
		//ç„¶åå¯ä»¥åœ¨å†™å…¥å‰ååšä»»ä½•æ“ä½œï¼Œä½†æ˜¯ä¸è¦å¤ªå¤æ‚ï¼Œè¦ä¸ç„¶ä¼šå½±å“ç”¨æˆ·ä½“éªŒ

		// ã€å…³é”®æ­¥éª¤ã€‘æ‰‹åŠ¨æ‰§è¡Œæ•°æ®åº“å†™å…¥æ“ä½œï¼ˆç”¨äº†OnTableAddRowsæ¡†æ¶ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œå†™å…¥ï¼‰
		db := ctx.MustGetOrInitDB()
		err := db.Create(&suppliers).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableAddRowsResp{}, nil
	},

	// ã€æ¡†æ¶è¯´æ˜ã€‘OnTableUpdateRows åœ¨æ›´æ–°ä¾›åº”å•†åè§¦å‘ï¼Œç”¨äºé¢å¤–çš„ä¸šåŠ¡é€»è¾‘å¤„ç†
	// è§¦å‘æ—¶æœºï¼šç”¨æˆ·æ›´æ–°ä¾›åº”å•†æˆåŠŸå    ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®åŒæ­¥ã€çŠ¶æ€æ£€æŸ¥ã€å…³è”æ›´æ–°ç­‰
	// âš ï¸ é‡è¦ï¼šæœ‰æ­¤å›è°ƒæ—¶æ¡†æ¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°æ•°æ®ï¼Œå¿…é¡»åœ¨å›è°ƒä¸­æ‰‹åŠ¨æ‰§è¡Œ db.Model().Updates()
	OnTableUpdateRows: func(ctx *runner.Context, req *usercall.OnTableUpdateRowsReq) (*usercall.OnTableUpdateRowsResp, error) {
		// ã€ä¸šåŠ¡åœºæ™¯ã€‘æ›´æ–°ä¾›åº”å•†åï¼Œè®°å½•å˜æ›´å†å²
		// è¿™é‡Œæ¼”ç¤ºäº†å¦‚ä½•åœ¨æ•°æ®æ›´æ–°åå¤„ç†å…³è”ä¸šåŠ¡é€»è¾‘

		// ã€å…³é”®æ­¥éª¤ã€‘æ‰‹åŠ¨æ‰§è¡Œæ•°æ®åº“æ›´æ–°æ“ä½œï¼ˆæ¡†æ¶ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œï¼‰
		db := ctx.MustGetOrInitDB()

		var updateValue RetailPurchaseSupplier
		err := req.DecodeBy(&updateValue) //ã€æ¡†æ¶è§„èŒƒã€‘æ³¨æ„è¿™é‡Œåªä¼šè·å–åˆ°æ›´æ–°çš„å­—æ®µçš„å€¼ï¼Œä¾‹å¦‚æ›´æ–°phoneçš„è¯updateValueçš„Phoneå­—æ®µä¼šè¢«èµ‹å€¼
		if err != nil {
			return nil, err
		}

		//GetStringï¼ŒGetIntï¼ŒGetBoolï¼ŒGetFloat64ï¼ŒGetFiles è¿™å‡ ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å®‰å…¨çš„è·å–æ›´æ–°å­—æ®µçš„å€¼ï¼Œä¸‹é¢å‡ ä¸ªåªæ˜¯æ¼”ç¤ºä¸€ä¸‹ç”¨æ³•ï¼Œæ­£å¸¸æƒ…å†µä¸‹å­—æ®µæ ¡éªŒçš„é€»è¾‘ä¼šè¢«æ¡†æ¶å’Œå‰ç«¯å¤„ç†ï¼Œ
		//name, exist, err := req.GetString("name")
		//if err != nil {
		//	return nil, err
		//}
		//if exist {
		//	if name == "" {
		//		return nil, fmt.Errorf("åç§°ä¸èƒ½ä¸ºç©º")
		//	}
		//}

		//phone, exist, err := req.GetInt("phone")
		//if err != nil {
		//	return nil, err
		//}
		//fmt.Println(phone)

		//GetFieldsMap() è¿”å› map[string]interface æ˜¯éœ€è¦æ›´æ–°çš„å­—æ®µå’Œæ›´æ–°çš„å€¼
		//fieldsMap := req.GetFieldsMap()
		err = db.Where("id in ?", req.GetIds()).Updates(updateValue).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableUpdateRowsResp{}, nil
	},

	// ã€æ¡†æ¶è¯´æ˜ã€‘OnTableDeleteRows åœ¨åˆ é™¤ä¾›åº”å•†å‰è§¦å‘ï¼Œç”¨äºä¸šåŠ¡è§„åˆ™éªŒè¯
	// è§¦å‘æ—¶æœºï¼šç”¨æˆ·åˆ é™¤ä¾›åº”å•†å‰    ä½¿ç”¨åœºæ™¯ï¼šå…³è”æ£€æŸ¥ã€é˜²æ­¢è¯¯åˆ 
	// âš ï¸ é‡è¦ï¼šæœ‰æ­¤å›è°ƒæ—¶æ¡†æ¶ä¸ä¼šè‡ªåŠ¨åˆ é™¤æ•°æ®ï¼Œå¿…é¡»åœ¨å›è°ƒä¸­æ‰‹åŠ¨æ‰§è¡Œ db.Delete()
	OnTableDeleteRows: func(ctx *runner.Context, req *usercall.OnTableDeleteRowsReq) (*usercall.OnTableDeleteRowsResp, error) {
		// ã€ä¸šåŠ¡åœºæ™¯ã€‘åˆ é™¤ä¾›åº”å•†å‰ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å…³è”å•†å“ï¼Œé˜²æ­¢è¯¯åˆ 
		db := ctx.MustGetOrInitDB()

		// æ£€æŸ¥æ˜¯å¦æœ‰å…³è”å•†å“
		for _, id := range req.GetIds() {
			var count int64
			if err := db.Model(&RetailPurchaseProduct{}).Where("supplier_id = ?", id).Count(&count).Error; err != nil {
				return nil, fmt.Errorf("æ£€æŸ¥ä¾›åº”å•†å…³è”å•†å“å¤±è´¥: %v", err)
			}

			if count > 0 {
				var supplier RetailPurchaseSupplier
				if err := db.Where("id = ?", id).First(&supplier).Error; err != nil {
					return nil, fmt.Errorf("æŸ¥è¯¢ä¾›åº”å•†ä¿¡æ¯å¤±è´¥: %v", err)
				}
				return nil, fmt.Errorf("ä¾›åº”å•† %s ä¸‹è¿˜æœ‰ %d ä¸ªå•†å“ï¼Œæ— æ³•åˆ é™¤ï¼Œè¯·å…ˆæŠŠç›¸å…³å•†å“åˆ é™¤", supplier.Name, count)
			}
		}

		// æ‰‹åŠ¨æ‰§è¡Œåˆ é™¤æ“ä½œ
		if err := db.Where("id IN ?", req.GetIds()).Delete(&RetailPurchaseSupplier{}).Error; err != nil {
			return nil, fmt.Errorf("åˆ é™¤ä¾›åº”å•†è®°å½•å¤±è´¥: %v", err)
		}

		return &usercall.OnTableDeleteRowsResp{}, nil
	},
}

// 2. å•†å“åˆ—è¡¨é…ç½®ï¼ˆä¾èµ–ä¾›åº”å•†æ•°æ®ï¼‰
var RetailPurchaseProductListOption = &runner.TableFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "é‡‡è´­å•†å“ç®¡ç†",
		ApiDesc:      "å•†å“åŸºç¡€ä¿¡æ¯ç®¡ç†ï¼Œæ”¯æŒå¢åˆ æ”¹æŸ¥å’Œæœç´¢",
		Tags:         []string{"é‡‡è´­ç®¡ç†", "å•†å“ç®¡ç†"},
		Request:      &query.SearchFilterPageReq{},
		Response:     query.PaginatedTable[[]*RetailPurchaseProduct]{},
		CreateTables: []interface{}{&RetailPurchaseProduct{}},
		Group:        RetailPurchaseGroup,
	},
	AutoCrudTable: &RetailPurchaseProduct{},

	// ã€æ¡†æ¶è¯´æ˜ã€‘OnInputFuzzyMap ä¸ºè¡¨æ ¼å­—æ®µæä¾›æ¨¡ç³Šæœç´¢æ•°æ®
	// è§¦å‘æ—¶æœºï¼šç”¨æˆ·è¾“å…¥æ—¶    æ•°æ®å»å‘ï¼šæŒ‚è½½åˆ°å¯¹åº”çš„è¡¨æ ¼å­—æ®µ
	//OnInputFuzzyMapçš„æ¯ä¸€ä¸ªéƒ½å¯ä»¥è¢«å…¶ä»–çš„optionså¤ç”¨
	OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
		"supplier_id": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
			// ã€å½“å‰åœºæ™¯ã€‘supplier_idæ˜¯å•é€‰å­—æ®µï¼Œåªè¿”å›é™æ€ä¿¡æ¯ï¼Œä¸åšèšåˆè®¡ç®—
			// ã€ç›®æ ‡å­—æ®µã€‘ä¸º RetailPurchaseProduct.SupplierID æä¾›ä¾›åº”å•†é€‰æ‹©æ•°æ®
			var suppliers []*RetailPurchaseSupplier
			db := ctx.MustGetOrInitDB()

			if req.IsByFiledValues() {
				// å¤šå€¼æŸ¥è¯¢ï¼šä½¿ç”¨ IN æŸ¥è¯¢ï¼Œè¿™é‡Œå¿…é¡»ç”¨ db = db.Where
				db = db.Where("id in ?", req.GetFiledValues())
			} else if req.IsByFiledValue() {
				// å•å€¼æŸ¥è¯¢ï¼šä½¿ç”¨ç­‰å€¼æŸ¥è¯¢ï¼Œæ€§èƒ½æœ€ä¼˜
				db = db.Where("id = ?", req.GetFiledValue()).Limit(1)
			} else {
				// æ¨¡ç³ŠæŸ¥è¯¢ï¼šå…³é”®å­—æœç´¢
				db = db.Where("name LIKE ? OR contact LIKE ? OR phone LIKE ?", "%"+req.Keyword()+"%", "%"+req.Keyword()+"%", "%"+req.Keyword()+"%").
					Limit(20)
			}
			db.Find(&suppliers)

			items := make([]*usercall.InputFuzzyItem, 0)
			for _, s := range suppliers {
				items = append(items, &usercall.InputFuzzyItem{
					Value: s.ID,
					Label: s.Name,
					DisplayInfo: map[string]interface{}{
						"ä¾›åº”å•†åç§°": s.Name,
						"è”ç³»äºº":   s.Contact,
						"è”ç³»ç”µè¯":  s.Phone,
						"åœ°å€":    s.Address,
					},
				})
			}

			return &usercall.OnInputFuzzyResp{
				Statistics: map[string]interface{}{
					"ä¾›åº”å•†åç§°": "text(ä¾›åº”å•†åç§°)", //å‰ç«¯åŠ¨æ€å±•ç¤ºé€‰ä¸­çš„é‚£ä¸ªä¾›åº”å•†åç§°
					"è”ç³»äºº":   "text(è”ç³»äºº)",   //å‰ç«¯åŠ¨æ€å±•ç¤ºé€‰ä¸­çš„é‚£ä¸ªä¾›åº”å•†è”ç³»äºº
					"è”ç³»ç”µè¯":  "text(è”ç³»ç”µè¯)",  //å‰ç«¯åŠ¨æ€å±•ç¤ºé€‰ä¸­çš„é‚£ä¸ªä¾›åº”å•†è”ç³»ç”µè¯
					"åœ°å€":    "text(åœ°å€)",    //å‰ç«¯åŠ¨æ€å±•ç¤ºé€‰ä¸­çš„é‚£ä¸ªä¾›åº”å•†åœ°å€
				},
				Values: items,
			}, nil
		},
	},
}

// 3. é‡‡è´­è®°å½•åˆ—è¡¨é…ç½®ï¼ˆä¾èµ–ä¾›åº”å•†å’Œå•†å“æ•°æ®ï¼‰
var RetailPurchaseRecordListOption = &runner.TableFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "é‡‡è´­è®°å½•ç®¡ç†",
		ApiDesc:      "é‡‡è´­è®°å½•ç®¡ç†ï¼Œæ”¯æŒçŠ¶æ€è·Ÿè¸ªã€ä¾›åº”å•†ç­›é€‰å’Œç»Ÿè®¡åˆ†æ",
		Tags:         []string{"é‡‡è´­ç®¡ç†", "è®°å½•ç®¡ç†"},
		Request:      &RetailPurchaseRecordListReq{},
		Response:     query.PaginatedTable[[]*RetailPurchaseRecord]{},
		CreateTables: []interface{}{&RetailPurchaseRecord{}},
		Group:        RetailPurchaseGroup,
	},
	AutoCrudTable: &RetailPurchaseRecord{},

	// ã€æ¡†æ¶è¯´æ˜ã€‘å¤ç”¨é‡‡è´­åˆ›å»ºçš„OnInputFuzzyé…ç½®ï¼Œé¿å…é‡å¤é€ è½®å­
	// ä¾›åº”å•†è”æƒ³åŠŸèƒ½åœ¨æ–°å¢å’Œç¼–è¾‘æ—¶éƒ½éœ€è¦ï¼Œç›´æ¥å¤ç”¨å·²æœ‰é…ç½®
	OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
		"supplier_id": RetailPurchaseProductListOption.OnInputFuzzyMap["supplier_id"], //å¯ä»¥å¤ç”¨RetailPurchaseProductListOption çš„supplier_id çš„OnInputFuzzyMap
	},
}

// 4. é‡‡è´­åˆ›å»ºé…ç½®ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰
var RetailPurchaseCreateOption = &runner.FormFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "é‡‡è´­ç”³è¯·åˆ›å»º",
		ApiDesc:      "åˆ›å»ºé‡‡è´­ç”³è¯·ï¼Œæ”¯æŒå¤šå•†å“é€‰æ‹©å’Œå®æ—¶ç»Ÿè®¡",
		Tags:         []string{"é‡‡è´­ç®¡ç†", "ç”³è¯·åˆ›å»º"},
		Request:      &RetailPurchaseReq{},
		Response:     &RetailPurchaseResp{},
		CreateTables: []interface{}{&RetailPurchaseRecord{}},
		Group:        RetailPurchaseGroup,
	},

	// ã€æ¡†æ¶è¯´æ˜ã€‘OnInputFuzzyMap ä¸ºè¯·æ±‚ç»“æ„ä½“å­—æ®µæä¾›æ¨¡ç³Šæœç´¢æ•°æ®
	// è§¦å‘æ—¶æœºï¼šç”¨æˆ·è¾“å…¥æ—¶    æ•°æ®å»å‘ï¼šæŒ‚è½½åˆ°å¯¹åº”çš„è¯·æ±‚å­—æ®µ
	OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
		"supplier_id": RetailPurchaseProductListOption.OnInputFuzzyMap["supplier_id"], //è¿™é‡Œä¸ºäº†é˜²æ­¢é‡å¤é€ è½®å­ï¼Œå¯ä»¥ç›´æ¥å¤ç”¨RetailPurchaseProductListOptionå·²ç»å­˜åœ¨çš„æ–¹æ³•

		"product_id": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
			// ã€å½“å‰åœºæ™¯ã€‘product_idæ˜¯listå†…å•é€‰å­—æ®µï¼Œæ”¯æŒèšåˆç»Ÿè®¡è®¡ç®—
			// ã€ç›®æ ‡å­—æ®µã€‘ä¸º RetailPurchaseItem.ProductID æä¾›å•†å“é€‰æ‹©æ•°æ®
			// æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ ¹æ®å·²é€‰æ‹©çš„ä¾›åº”å•†æ¥è¿‡æ»¤å•†å“

			// ã€æ¡†æ¶è¯´æ˜ã€‘é€šè¿‡req.DecodeByè·å–è¡¨å•ä¸Šä¸‹æ–‡ä¸­çš„supplier_id
			// è¿™æ ·å¯ä»¥ç¡®ä¿å•†å“é€‰æ‹©ä¸ä¾›åº”å•†é€‰æ‹©ä¿æŒä¸€è‡´æ€§
			var currentInputData RetailPurchaseReq
			if err := req.DecodeBy(&currentInputData); err != nil {
				return nil, fmt.Errorf("è¡¨å•è§£æå¤±è´¥ï¼Œè¯·åˆ·æ–°é€‰æ‹©ä¾›åº”å•†åå†é‡è¯•")
			}

			if currentInputData.SupplierID == 0 {
				return nil, fmt.Errorf("è¯·å…ˆé€‰æ‹©ä¾›åº”å•†ï¼Œå†é€‰æ‹©å•†å“")
			}

			var products []*RetailPurchaseProduct
			db := ctx.MustGetOrInitDB()

			if req.IsByFiledValues() {
				// å¤šå€¼æŸ¥è¯¢ï¼šä½¿ç”¨ IN æŸ¥è¯¢ï¼Œè¿™é‡Œå¿…é¡»ç”¨ db = db.Where
				db = db.Where("id in ?", req.GetFiledValues())
			} else if req.IsByFiledValue() {
				// å•å€¼æŸ¥è¯¢ï¼šä½¿ç”¨ç­‰å€¼æŸ¥è¯¢ï¼Œæ€§èƒ½æœ€ä¼˜
				db = db.Where("id = ?", req.GetFiledValue()).Limit(1)
			} else {
				// æ¨¡ç³ŠæŸ¥è¯¢ï¼šå…³é”®å­—æœç´¢
				db = db.Where("name LIKE ? OR spec LIKE ? OR category LIKE ?", "%"+req.Keyword()+"%", "%"+req.Keyword()+"%", "%"+req.Keyword()+"%").
					Limit(20)
			}
			// æ ¹æ®ä¾›åº”å•†IDè¿‡æ»¤å•†å“ï¼Œç¡®ä¿åªèƒ½é€‰æ‹©è¯¥ä¾›åº”å•†çš„å•†å“
			db.Where("supplier_id = ?", currentInputData.SupplierID).Find(&products)

			items := make([]*usercall.InputFuzzyItem, 0)
			for _, p := range products {
				items = append(items, &usercall.InputFuzzyItem{
					Value: p.ID,
					Label: fmt.Sprintf("%s - %s (Â¥%.2f/%s)", p.Name, p.Spec, p.UnitPrice, p.Unit),
					DisplayInfo: map[string]interface{}{
						"å•†å“åç§°": p.Name,
						"è§„æ ¼":   p.Spec,
						"åˆ†ç±»":   p.Category,
						"å•ä½":   p.Unit,
						"æ ‡å‡†å•ä»·": p.UnitPrice,
					},
				})
			}

			return &usercall.OnInputFuzzyResp{
				Statistics: map[string]interface{}{
					// âœ… å‰ç«¯å®æ—¶èšåˆè®¡ç®— - ç”¨æˆ·æ¯æ·»åŠ ä¸€è¡Œå•†å“ï¼Œå‰ç«¯ç«‹å³è®¡ç®—
					"é‡‡è´­æ€»é‡‘é¢": "sum(æ ‡å‡†å•ä»·,*quantity)", // ç”¨æˆ·é€‰æ‹©çš„æ‰€æœ‰å•†å“æ€»ä»·
					"ä¹æŠ˜é‡‘é¢":  "sum(æ ‡å‡†å•ä»·,*0.9)",      // ç”¨æˆ·é€‰æ‹©çš„æ‰€æœ‰å•†å“æ€»ä»·*0.9
					"å•†å“ç§ç±»æ•°": "count(æ ‡å‡†å•ä»·)",         // é€‰äº†å‡ ç§å•†å“
					"é‡‡è´­æ€»æ•°é‡": "sum(quantity)",       // å•†å“æ€»æ•°é‡
					"å¹³å‡å•ä»·":  "avg(æ ‡å‡†å•ä»·)",           // é€‰ä¸­å•†å“å¹³å‡ä»·æ ¼

					// âœ… æœ‰ç”¨çš„é™æ€ä¿¡æ¯
					"é‡‡è´­è¯´æ˜": "æ‰¹é‡é‡‡è´­äº«ä¼˜æƒ ",
					"ä»˜æ¬¾æ–¹å¼": "æœˆç»“30å¤©",
				},
				Values: items,
			}, nil
		},
	},
}

// ================ APIæ³¨å†Œï¼ˆæŒ‰åŠŸèƒ½å±‚æ¬¡æ’åºï¼‰ ================

func init() {
	// 1. Tableå‡½æ•° - åŸºç¡€æ•°æ®ç®¡ç†ï¼ˆæŒ‰ä¾èµ–å…³ç³»æ’åºï¼‰
	//RouterGroup å˜é‡å¯ä»¥ç›´æ¥ç”¨ï¼Œå½“å‰packageä¸‹å·²ç»åˆ›å»ºå¥½è¯¥å˜é‡äº†
	runner.Get(RouterGroup+"/retail_purchase_supplier_list", RetailPurchaseSupplierList, RetailPurchaseSupplierListOption)
	runner.Get(RouterGroup+"/retail_purchase_product_list", RetailPurchaseProductList, RetailPurchaseProductListOption)
	runner.Get(RouterGroup+"/retail_purchase_record_list", RetailPurchaseRecordList, RetailPurchaseRecordListOption)

	// 2. Formå‡½æ•° - ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼ˆä¾èµ–åŸºç¡€æ•°æ®ï¼‰
	runner.Post(RouterGroup+"/retail_purchase_create", RetailPurchaseCreate, RetailPurchaseCreateOption)
}
//<æ€»ç»“>
//é‡‡è´­ç®¡ç†ç³»ç»Ÿï¼šä¾›åº”å•†ç®¡ç†ã€å•†å“ç®¡ç†ã€é‡‡è´­è®°å½•ç®¡ç†
//æŠ€æœ¯æ ˆï¼šAutoCrudTableè‡ªåŠ¨ç”ŸæˆCRUDç•Œé¢ã€OnInputFuzzyæ¨¡ç³Šæœç´¢ã€Statisticså‰ç«¯é€‰ä¸­å®æ—¶èšåˆè®¡ç®—ã€OnTableè¡¨æ ¼å›è°ƒæœºåˆ¶ã€GORMé¢„åŠ è½½ä¼˜åŒ–
//å¤æ‚åº¦ï¼šS2çº§åˆ«ï¼ŒåŒ…å«å›è°ƒæœºåˆ¶å’Œä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œæ— å¤æ‚ä¾èµ–å…³ç³»
//ä¸šåŠ¡é€»è¾‘ï¼šå•†å“å±äºä¾›åº”å•†ï¼Œé‡‡è´­æ—¶æ”¯æŒå¤šå•†å“é€‰æ‹©ï¼Œç³»ç»Ÿè‡ªåŠ¨è®¡ç®—æ€»ä»·å’Œç»Ÿè®¡ä¿¡æ¯
//æ€§èƒ½ä¼˜åŒ–ï¼šGORMé¢„åŠ è½½é¿å…N+1æŸ¥è¯¢ï¼ŒJOINæŸ¥è¯¢ä¼˜åŒ–å…³è”æœç´¢
//</æ€»ç»“>

```

tableå‡½æ•°æœ€ä½³å®è·µï¼šæ‹›è˜ç®¡ç†ç³»ç»Ÿ
ç”¨æˆ·éœ€æ±‚ï¼š
éœ€è¦ä¸€ä¸ªæ‹›è˜ç®¡ç†ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥å‘èµ·ç®€å†æŠ•é€’ï¼Œç®€å†ç”¨é™„ä»¶çš„å½¢å¼ä¸Šä¼ ï¼Œç„¶åå¡«å†™è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼Œç„¶åç®¡ç†å‘˜å¯ä»¥è¿›è¡Œç®€å†çš„å¢åˆ æ”¹æŸ¥ï¼Œæ¯ä¸ªç®€å†éƒ½åº”è¯¥æœ‰è‡ªå·±çš„çŠ¶æ€ï¼Œå¾…é¢è¯•ï¼Œå·²é¢è¯•ï¼Œå·²é€šè¿‡ï¼Œå·²è½é€‰ï¼Œç„¶åå¯ä»¥æŠ•é€’çš„èŒä½åˆ†ä¸ºï¼Œå‰ç«¯å¼€å‘å²—ä½ï¼Œåç«¯å¼€å‘å²—ï¼Œè¿è¥å²—ï¼Œè¿ç»´å²—ï¼Œç¾æœ¯å²—ï¼Œè®¾è®¡å²—ï¼Œäº§å“å²—
å¦å¤–å¯ä»¥é€‰æ‹©çš„å·¥ä½œåœ°æœ‰ï¼šåŒ—äº¬ï¼Œä¸Šæµ·ï¼Œæ·±åœ³ï¼Œå¹¿å·ï¼Œå—äº¬ï¼Œæ­¦æ±‰ï¼Œæˆéƒ½ï¼Œé‡åº†ï¼Œæ­å· è¿™äº›
åŒæ—¶ç”¨æˆ·å¯ä»¥é€‰æ‹©è‡ªå·±çš„æ ‡ç­¾ï¼šé»˜è®¤å¯é€‰é¡¹ï¼ˆå¼€æºé¡¹ç›®,AIç¼–ç¨‹,å…¨æ ˆå¼€å‘,ç»éªŒä¸°å¯Œ,åº”å±Šç”Ÿ,æ‡‚è¿ç»´,æ•°æ®åˆ†æï¼‰å…è®¸è‡ªå®šä¹‰å¤šé€‰å€¼

```go
// æ–‡ä»¶åï¼šhr_recruitment.go
package hr

import (
	"fmt"

	"github.com/yunhanshu-net/function-go/pkg/dto/response"
	"github.com/yunhanshu-net/function-go/pkg/dto/usercall"
	"github.com/yunhanshu-net/function-go/runner"
	"github.com/yunhanshu-net/pkg/query"
	"github.com/yunhanshu-net/pkg/typex/files"
	"gorm.io/gorm"
)

// æ‹›è˜ç®¡ç†ç³»ç»Ÿå‡½æ•°ç»„
var HrRecruitmentGroup = &runner.FunctionGroup{
	CnName: "æ‹›è˜ç®¡ç†ç³»ç»Ÿ",
	EnName: "hr_recruitment",
}

// ç®€å†æ•°æ®æ¨¡å‹
type HrRecruitment struct {
	// æ¡†æ¶æ ‡ç­¾ï¼šrunner:"name:ç®€å†ID" - è®¾ç½®å­—æ®µåœ¨å‰ç«¯çš„æ˜¾ç¤ºåç§°
	// æ¡†æ¶æ ‡ç­¾ï¼špermission:"read" - å­—æ®µåªè¯»æƒé™ï¼ˆä¸èƒ½ç¼–è¾‘ï¼‰
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"eq,gte,lte" - å¯ç”¨ç²¾ç¡®æœç´¢å’ŒèŒƒå›´æœç´¢åŠŸèƒ½
	// æ³¨æ„ï¼šgorm:"column:id" æ˜ç¡®æŒ‡å®šæ•°æ®åº“åˆ—åï¼Œç¡®ä¿æ˜ å°„æ­£ç¡®
	ID int `json:"id" gorm:"primaryKey;autoIncrement;column:id" runner:"name:ç®€å†ID" permission:"read" search:"eq,gte,lte"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:datetime;kind:datetime" - æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"gte,lte" - å¯ç”¨æ—¶é—´èŒƒå›´æœç´¢åŠŸèƒ½ï¼ˆå¤§äºç­‰äºã€å°äºç­‰äºï¼‰
	// æ³¨æ„ï¼šgorm:"autoCreateTime:milli" è‡ªåŠ¨å¡«å……åˆ›å»ºæ—¶é—´ï¼ˆæ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œå¿…é¡»æ˜¯æ¯«ç§’çº§åˆ«ï¼‰
	CreatedAt int64 `json:"created_at" gorm:"autoCreateTime:milli;column:created_at" runner:"name:æŠ•é€’æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read" search:"gte,lte"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:datetime;kind:datetime" - æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"gte,lte" - å¯ç”¨æ—¶é—´èŒƒå›´æœç´¢åŠŸèƒ½ï¼ˆå¤§äºç­‰äºã€å°äºç­‰äºï¼‰
	// æ³¨æ„ï¼šgorm:"autoUpdateTime:milli" è‡ªåŠ¨å¡«å……æ›´æ–°æ—¶é—´ï¼ˆæ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œå¿…é¡»æ˜¯æ¯«ç§’çº§åˆ«ï¼‰
	UpdatedAt int64 `json:"updated_at" gorm:"autoUpdateTime:milli;column:updated_at" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read" search:"gte,lte"`

	// æ¡†æ¶æ ‡ç­¾ï¼šrunner:"-" - éšè—å­—æ®µï¼ˆä¸åœ¨å‰ç«¯æ˜¾ç¤ºï¼‰
	DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index;column:deleted_at" runner:"-"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=2,max=20" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦2-20å­—ç¬¦
	Name string `json:"name" gorm:"column:name" runner:"name:å§“å" widget:"type:input" search:"like" validate:"required,min=2,max=20"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=11,max=11" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦å¿…é¡»ä¸º11ä½
	Phone string `json:"phone" gorm:"column:phone" runner:"name:æ‰‹æœºå·" widget:"type:input" search:"like" validate:"required,min=11,max=11"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,email" - å¿…å¡«å­—æ®µï¼Œå¿…é¡»æ˜¯æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼
	Email string `json:"email" gorm:"column:email" runner:"name:é‚®ç®±" widget:"type:input" search:"like" validate:"required,email"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:number;min:18;max:65;unit:å²" - æ•°å­—è¾“å…¥ç»„ä»¶ï¼Œæœ€å°å€¼18ï¼Œæœ€å¤§å€¼65ï¼Œå•ä½å²
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"gte,lte" - å¯ç”¨èŒƒå›´æœç´¢åŠŸèƒ½ï¼ˆå¤§äºç­‰äºã€å°äºç­‰äºï¼‰
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=18,max=65" - å¿…å¡«å­—æ®µï¼Œå¹´é¾„èŒƒå›´18-65å²
	Age int `json:"age" gorm:"column:age" runner:"name:å¹´é¾„" widget:"type:number;min:18;max:65;unit:å²" search:"gte,lte" validate:"required,min=18,max=65"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:ç”·,å¥³" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶ï¼ˆé€‰é¡¹ï¼šç”·/å¥³ï¼‰
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"in" - å¯ç”¨ç²¾ç¡®åŒ¹é…æœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,oneof=ç”· å¥³" - å¿…å¡«å­—æ®µï¼Œå€¼å¿…é¡»æ˜¯é€‰é¡¹ä¹‹ä¸€
	Gender string `json:"gender" gorm:"column:gender" runner:"name:æ€§åˆ«" widget:"type:select;options:ç”·,å¥³" search:"in" validate:"required,oneof=ç”· å¥³"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:é«˜ä¸­,å¤§ä¸“,æœ¬ç§‘,ç¡•å£«,åšå£«" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"in" - å¯ç”¨ç²¾ç¡®åŒ¹é…æœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Education string `json:"education" gorm:"column:education" runner:"name:å­¦å†" widget:"type:select;options:é«˜ä¸­,å¤§ä¸“,æœ¬ç§‘,ç¡•å£«,åšå£«" search:"in" validate:"required"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:å‰ç«¯å¼€å‘å²—,åç«¯å¼€å‘å²—,è¿è¥å²—,è¿ç»´å²—,ç¾æœ¯å²—,è®¾è®¡å²—,äº§å“å²—" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"in" - å¯ç”¨ç²¾ç¡®åŒ¹é…æœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Position string `json:"position" gorm:"column:position" runner:"name:åº”è˜èŒä½" widget:"type:select;options:å‰ç«¯å¼€å‘å²—,åç«¯å¼€å‘å²—,è¿è¥å²—,è¿ç»´å²—,ç¾æœ¯å²—,è®¾è®¡å²—,äº§å“å²—" search:"in" validate:"required"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:åŒ—äº¬,ä¸Šæµ·,æ·±åœ³,å¹¿å·,å—äº¬,æ­¦æ±‰,æˆéƒ½,é‡åº†,æ­å·" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"in" - å¯ç”¨ç²¾ç¡®åŒ¹é…æœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	WorkCity string `json:"work_city" gorm:"column:work_city" runner:"name:æœŸæœ›å·¥ä½œåœ°" widget:"type:select;options:åŒ—äº¬,ä¸Šæµ·,æ·±åœ³,å¹¿å·,å—äº¬,æ­¦æ±‰,æˆéƒ½,é‡åº†,æ­å·" search:"in" validate:"required"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:åº”å±Šç”Ÿ,1å¹´ä»¥ä¸‹,1-3å¹´,3-5å¹´,5-10å¹´,10å¹´ä»¥ä¸Š" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"in" - å¯ç”¨ç²¾ç¡®åŒ¹é…æœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Experience string `json:"experience" gorm:"column:experience" runner:"name:å·¥ä½œç»éªŒ" widget:"type:select;options:åº”å±Šç”Ÿ,1å¹´ä»¥ä¸‹,1-3å¹´,3-5å¹´,5-10å¹´,10å¹´ä»¥ä¸Š" search:"in" validate:"required"`

	// æ¡ä»¶å­—æ®µï¼šå½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶æ˜¾ç¤ºæ¯•ä¸šæ—¶é—´å­—æ®µ
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:number;min:2020;max:2030;unit:å¹´" - æ•°å­—è¾“å…¥ç»„ä»¶ï¼Œæœ€å°å€¼2020ï¼Œæœ€å¤§å€¼2030ï¼Œå•ä½å¹´
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"gte,lte" - å¯ç”¨èŒƒå›´æœç´¢åŠŸèƒ½ï¼ˆå¤§äºç­‰äºã€å°äºç­‰äºï¼‰
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=experience åº”å±Šç”Ÿ,min=2020,max=2030" - å½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶å¿…å¡«
	GraduationYear int `json:"graduation_year" gorm:"column:graduation_year;comment:æ¯•ä¸šå¹´ä»½" runner:"name:æ¯•ä¸šå¹´ä»½" widget:"type:number;min:2020;max:2030;unit:å¹´" search:"gte,lte" data:"default_value:2024;example:2024" validate:"required_if=experience åº”å±Šç”Ÿ,min=2020,max=2030"`

	// æ¡ä»¶å­—æ®µï¼šå½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶æ˜¾ç¤ºå®ä¹ ç»å†
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=experience åº”å±Šç”Ÿ" - å½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶å¿…å¡«
	InternshipExperience string `json:"internship_experience" gorm:"column:internship_experience;comment:å®ä¹ ç»å†" runner:"name:å®ä¹ ç»å†" widget:"type:input;mode:text_area" search:"like" data:"example:åœ¨XXå…¬å¸å®ä¹ 3ä¸ªæœˆï¼Œè´Ÿè´£å‰ç«¯å¼€å‘" validate:"required_if=experience åº”å±Šç”Ÿ"`

	// æ¡ä»¶å­—æ®µï¼šå½“å·¥ä½œç»éªŒâ‰ åº”å±Šç”Ÿæ—¶æ˜¾ç¤ºé¡¹ç›®ç»éªŒ
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_unless=experience åº”å±Šç”Ÿ" - å½“å·¥ä½œç»éªŒâ‰ åº”å±Šç”Ÿæ—¶å¿…å¡«
	ProjectExperience string `json:"project_experience" gorm:"column:project_experience;comment:é¡¹ç›®ç»éªŒ" runner:"name:é¡¹ç›®ç»éªŒ" widget:"type:input;mode:text_area" search:"like" data:"example:è´Ÿè´£XXé¡¹ç›®çš„æ¶æ„è®¾è®¡å’Œå¼€å‘" validate:"required_unless=experience åº”å±Šç”Ÿ"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:5Kä»¥ä¸‹,5K-10K,10K-15K,15K-20K,20K-30K,30Kä»¥ä¸Š" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"in" - å¯ç”¨ç²¾ç¡®åŒ¹é…æœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Salary string `json:"salary" gorm:"column:salary" runner:"name:æœŸæœ›è–ªèµ„" widget:"type:select;options:5Kä»¥ä¸‹,5K-10K,10K-15K,15K-20K,20K-30K,30Kä»¥ä¸Š" search:"in" validate:"required"`

	// æ¡ä»¶å­—æ®µï¼šå½“æœŸæœ›è–ªèµ„=30Kä»¥ä¸Šæ—¶æ˜¾ç¤ºå…·ä½“è–ªèµ„
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:number;min:30000;max:100000;unit:å…ƒ" - æ•°å­—è¾“å…¥ç»„ä»¶ï¼Œæœ€å°å€¼30000ï¼Œæœ€å¤§å€¼100000ï¼Œå•ä½å…ƒ
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"gte,lte" - å¯ç”¨èŒƒå›´æœç´¢åŠŸèƒ½ï¼ˆå¤§äºç­‰äºã€å°äºç­‰äºï¼‰
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=salary 30Kä»¥ä¸Š,min=30000,max=100000" - å½“æœŸæœ›è–ªèµ„=30Kä»¥ä¸Šæ—¶å¿…å¡«
	SpecificSalary int `json:"specific_salary" gorm:"column:specific_salary;comment:å…·ä½“æœŸæœ›è–ªèµ„" runner:"name:å…·ä½“æœŸæœ›è–ªèµ„" widget:"type:number;min:30000;max:100000;unit:å…ƒ" search:"gte,lte" data:"example:35000" validate:"required_if=salary 30Kä»¥ä¸Š,min=30000,max=100000"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:file_upload;accept:.pdf,.doc,.docx;max_size:10MB" - æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šaccept:.pdf,.doc,.docx - å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹
	// æ³¨æ„ï¼šgorm:"type:json" æŒ‡å®šæ•°æ®åº“å­˜å‚¨ä¸ºJSONç±»å‹
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	//search:"-" ä¸å…è®¸æœç´¢
	Resume *files.Files `json:"resume" gorm:"type:json;column:resume" runner:"name:ç®€å†é™„ä»¶" widget:"type:file_upload;accept:.pdf,.doc,.docx;max_size:10MB" validate:"required" search:"-"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=20,max=500" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦20-500å­—ç¬¦
	Introduce string `json:"introduce" gorm:"column:introduce" runner:"name:è‡ªæˆ‘ä»‹ç»" widget:"type:input;mode:text_area" search:"like" validate:"required,min=20,max=500"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:multiselect;options:å¼€æºé¡¹ç›®,AIç¼–ç¨‹,å…¨æ ˆå¼€å‘,ç»éªŒä¸°å¯Œ,åº”å±Šç”Ÿ,æ‡‚è¿ç»´,æ•°æ®åˆ†æ;allow_create:true" - å¤šé€‰ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šallow_create:true - å…è®¸åˆ›å»ºè‡ªå®šä¹‰æ ‡ç­¾
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ³¨æ„ï¼šmultiselectæœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§stringçš„ä¼šç”¨,å·åˆ†éš”å¤šä¸ªå€¼ï¼Œç¬¬äºŒç§[]stringï¼Œä¼šç›´æ¥ç”¨åˆ‡ç‰‡å­˜å‚¨å¤šä¸ªå€¼
	// ä¸ºäº†æ–¹ä¾¿å­˜å‚¨åˆ°æ•°æ®åº“æˆ‘ä»¬é€‰æ‹©ç”¨string
	Tags string `json:"tags" gorm:"column:tags;comment:ä¸ªäººæ ‡ç­¾" runner:"name:ä¸ªäººæ ‡ç­¾" widget:"type:multiselect;options:å¼€æºé¡¹ç›®,AIç¼–ç¨‹,å…¨æ ˆå¼€å‘,ç»éªŒä¸°å¯Œ,åº”å±Šç”Ÿ,æ‡‚è¿ç»´,æ•°æ®åˆ†æ;allow_create:true" search:"like"`

	// æ¡ä»¶å­—æ®µï¼šå½“å­¦å†=ç¡•å£«æˆ–åšå£«æ—¶æ˜¾ç¤ºæ¯•ä¸šé™¢æ ¡
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=education åšå£«" - å½“å­¦å†=åšå£«æ—¶å¿…å¡«
	GraduateSchool string `json:"graduate_school" gorm:"column:graduate_school;comment:æ¯•ä¸šé™¢æ ¡" runner:"name:æ¯•ä¸šé™¢æ ¡" widget:"type:input" search:"like" data:"example:æ¸…åå¤§å­¦" validate:"required_if=education åšå£«"`

	// æ¡ä»¶å­—æ®µï¼šå½“å­¦å†=åšå£«æ—¶æ˜¾ç¤ºç ”ç©¶æ–¹å‘
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=education åšå£«" - å½“å­¦å†=åšå£«æ—¶å¿…å¡«
	ResearchField string `json:"research_field" gorm:"column:research_field;comment:ç ”ç©¶æ–¹å‘" runner:"name:ç ”ç©¶æ–¹å‘" widget:"type:input" search:"like" data:"example:äººå·¥æ™ºèƒ½" validate:"required_if=education åšå£«"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:å¾…é¢è¯•,å·²é¢è¯•,å·²é€šè¿‡,å·²è½é€‰" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šdata:"default_value:å¾…é¢è¯•" - è®¾ç½®é»˜è®¤çŠ¶æ€ä¸º"å¾…é¢è¯•"
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"in" - å¯ç”¨ç²¾ç¡®åŒ¹é…æœç´¢åŠŸèƒ½
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,oneof=å¾…é¢è¯• å·²é¢è¯• å·²é€šè¿‡ å·²è½é€‰" - å€¼å¿…é¡»æ˜¯æœ‰æ•ˆçŠ¶æ€
	Status string `json:"status" gorm:"column:status" runner:"name:ç®€å†çŠ¶æ€" widget:"type:select;options:å¾…é¢è¯•,å·²é¢è¯•,å·²é€šè¿‡,å·²è½é€‰" data:"default_value:å¾…é¢è¯•" search:"in" validate:"required,oneof=å¾…é¢è¯• å·²é¢è¯• å·²é€šè¿‡ å·²è½é€‰"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	Remark string `json:"remark" gorm:"column:remark" runner:"name:å¤‡æ³¨" widget:"type:input;mode:text_area" search:"like"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:user" - ç”¨æˆ·ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šsearch:"like" - å¯ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½
	CreateBy string `json:"create_by" gorm:"column:create_by" runner:"name:æŠ•é€’äºº" widget:"type:user" search:"like"`
}

// æŒ‡å®šæ•°æ®åº“è¡¨å
func (HrRecruitment) TableName() string { return "hr_recruitment" }

// ç®€å†æŠ•é€’è¯·æ±‚ç»“æ„
type HrRecruitmentApplyReq struct {
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=2,max=20" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦2-20å­—ç¬¦
	Name string `json:"name" runner:"name:å§“å" widget:"type:input" validate:"required,min=2,max=20"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=11,max=11" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦å¿…é¡»ä¸º11ä½
	Phone string `json:"phone" runner:"name:æ‰‹æœºå·" widget:"type:input" validate:"required,min=11,max=11"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,email" - å¿…å¡«å­—æ®µï¼Œå¿…é¡»æ˜¯æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼
	Email string `json:"email" runner:"name:é‚®ç®±" widget:"type:input" validate:"required,email"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:number;min:18;max:65;unit:å²" - æ•°å­—è¾“å…¥ç»„ä»¶ï¼Œæœ€å°å€¼18ï¼Œæœ€å¤§å€¼65ï¼Œå•ä½å²
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=18,max=65" - å¿…å¡«å­—æ®µï¼Œå¹´é¾„èŒƒå›´18-65å²
	Age int `json:"age" runner:"name:å¹´é¾„" widget:"type:number;min:18;max:65;unit:å²" validate:"required,min=18,max=65"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:ç”·,å¥³" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶ï¼ˆé€‰é¡¹ï¼šç”·/å¥³ï¼‰
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,oneof=ç”· å¥³" - å¿…å¡«å­—æ®µï¼Œå€¼å¿…é¡»æ˜¯é€‰é¡¹ä¹‹ä¸€
	Gender string `json:"gender" runner:"name:æ€§åˆ«" widget:"type:select;options:ç”·,å¥³" validate:"required,oneof=ç”· å¥³"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:é«˜ä¸­,å¤§ä¸“,æœ¬ç§‘,ç¡•å£«,åšå£«" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Education string `json:"education" runner:"name:å­¦å†" widget:"type:select;options:é«˜ä¸­,å¤§ä¸“,æœ¬ç§‘,ç¡•å£«,åšå£«" validate:"required"`

	// æ¡ä»¶å­—æ®µï¼šå½“å­¦å†=ç¡•å£«æˆ–åšå£«æ—¶æ˜¾ç¤ºæ¯•ä¸šé™¢æ ¡
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=education åšå£«" - å½“å­¦å†=åšå£«æ—¶å¿…å¡«
	GraduateSchool string `json:"graduate_school" runner:"name:æ¯•ä¸šé™¢æ ¡" widget:"type:input" data:"example:æ¸…åå¤§å­¦" validate:"required_if=education åšå£«"`

	// æ¡ä»¶å­—æ®µï¼šå½“å­¦å†=åšå£«æ—¶æ˜¾ç¤ºç ”ç©¶æ–¹å‘
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=education åšå£«" - å½“å­¦å†=åšå£«æ—¶å¿…å¡«
	ResearchField string `json:"research_field" runner:"name:ç ”ç©¶æ–¹å‘" widget:"type:input" data:"example:äººå·¥æ™ºèƒ½" validate:"required_if=education åšå£«"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:å‰ç«¯å¼€å‘å²—,åç«¯å¼€å‘å²—,è¿è¥å²—,è¿ç»´å²—,ç¾æœ¯å²—,è®¾è®¡å²—,äº§å“å²—" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Position string `json:"position" runner:"name:åº”è˜èŒä½" widget:"type:select;options:å‰ç«¯å¼€å‘å²—,åç«¯å¼€å‘å²—,è¿è¥å²—,è¿ç»´å²—,ç¾æœ¯å²—,è®¾è®¡å²—,äº§å“å²—" validate:"required"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:åŒ—äº¬,ä¸Šæµ·,æ·±åœ³,å¹¿å·,å—äº¬,æ­¦æ±‰,æˆéƒ½,é‡åº†,æ­å·" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	WorkCity string `json:"work_city" runner:"name:æœŸæœ›å·¥ä½œåœ°" widget:"type:select;options:åŒ—äº¬,ä¸Šæµ·,æ·±åœ³,å¹¿å·,å—äº¬,æ­¦æ±‰,æˆéƒ½,é‡åº†,æ­å·" validate:"required"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:åº”å±Šç”Ÿ,1å¹´ä»¥ä¸‹,1-3å¹´,3-5å¹´,5-10å¹´,10å¹´ä»¥ä¸Š" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Experience string `json:"experience" runner:"name:å·¥ä½œç»éªŒ" widget:"type:select;options:åº”å±Šç”Ÿ,1å¹´ä»¥ä¸‹,1-3å¹´,3-5å¹´,5-10å¹´,10å¹´ä»¥ä¸Š" validate:"required"`

	// æ¡ä»¶å­—æ®µï¼šå½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶æ˜¾ç¤ºæ¯•ä¸šæ—¶é—´å­—æ®µ
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:number;min:2020;max:2030;unit:å¹´" - æ•°å­—è¾“å…¥ç»„ä»¶ï¼Œæœ€å°å€¼2020ï¼Œæœ€å¤§å€¼2030ï¼Œå•ä½å¹´
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=experience åº”å±Šç”Ÿ,min=2020,max=2030" - å½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶å¿…å¡«
	GraduationYear int `json:"graduation_year" runner:"name:æ¯•ä¸šå¹´ä»½" widget:"type:number;min:2020;max:2030;unit:å¹´" data:"default_value:2024;example:2024" validate:"required_if=experience åº”å±Šç”Ÿ,min=2020,max=2030"`

	// æ¡ä»¶å­—æ®µï¼šå½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶æ˜¾ç¤ºå®ä¹ ç»å†
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=experience åº”å±Šç”Ÿ" - å½“å·¥ä½œç»éªŒ=åº”å±Šç”Ÿæ—¶å¿…å¡«
	InternshipExperience string `json:"internship_experience" runner:"name:å®ä¹ ç»å†" widget:"type:input;mode:text_area" data:"example:åœ¨XXå…¬å¸å®ä¹ 3ä¸ªæœˆï¼Œè´Ÿè´£å‰ç«¯å¼€å‘" validate:"required_if=experience åº”å±Šç”Ÿ"`

	// æ¡ä»¶å­—æ®µï¼šå½“å·¥ä½œç»éªŒâ‰ åº”å±Šç”Ÿæ—¶æ˜¾ç¤ºé¡¹ç›®ç»éªŒ
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_unless=experience åº”å±Šç”Ÿ" - å½“å·¥ä½œç»éªŒâ‰ åº”å±Šç”Ÿæ—¶å¿…å¡«
	ProjectExperience string `json:"project_experience" runner:"name:é¡¹ç›®ç»éªŒ" widget:"type:input;mode:text_area" data:"example:è´Ÿè´£XXé¡¹ç›®çš„æ¶æ„è®¾è®¡å’Œå¼€å‘" validate:"required_unless=experience åº”å±Šç”Ÿ"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:select;options:5Kä»¥ä¸‹,5K-10K,10K-15K,15K-20K,20K-30K,30Kä»¥ä¸Š" - ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Salary string `json:"salary" runner:"name:æœŸæœ›è–ªèµ„" widget:"type:select;options:5Kä»¥ä¸‹,5K-10K,10K-15K,15K-20K,20K-30K,30Kä»¥ä¸Š" validate:"required"`

	// æ¡ä»¶å­—æ®µï¼šå½“æœŸæœ›è–ªèµ„=30Kä»¥ä¸Šæ—¶æ˜¾ç¤ºå…·ä½“è–ªèµ„
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:number;min:30000;max:100000;unit:å…ƒ" - æ•°å­—è¾“å…¥ç»„ä»¶ï¼Œæœ€å°å€¼30000ï¼Œæœ€å¤§å€¼100000ï¼Œå•ä½å…ƒ
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required_if=salary 30Kä»¥ä¸Š,min=30000,max=100000" - å½“æœŸæœ›è–ªèµ„=30Kä»¥ä¸Šæ—¶å¿…å¡«
	SpecificSalary int `json:"specific_salary" runner:"name:å…·ä½“æœŸæœ›è–ªèµ„" widget:"type:number;min:30000;max:100000;unit:å…ƒ" data:"example:35000" validate:"required_if=salary 30Kä»¥ä¸Š,min=30000,max=100000"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:file_upload;accept:.pdf,.doc,.docx;max_size:10MB" - æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šaccept:.pdf,.doc,.docx - å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required" - å¿…å¡«å­—æ®µ
	Resume *files.Files `json:"resume" runner:"name:ç®€å†é™„ä»¶" widget:"type:file_upload;accept:.pdf,.doc,.docx;max_size:10MB" validate:"required"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼švalidate:"required,min=20,max=500" - å¿…å¡«å­—æ®µï¼Œé•¿åº¦20-500å­—ç¬¦
	Introduce string `json:"introduce" runner:"name:è‡ªæˆ‘ä»‹ç»" widget:"type:input;mode:text_area" validate:"required,min=20,max=500"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:multiselect;options:å¼€æºé¡¹ç›®,AIç¼–ç¨‹,å…¨æ ˆå¼€å‘,ç»éªŒä¸°å¯Œ,åº”å±Šç”Ÿ,æ‡‚è¿ç»´,æ•°æ®åˆ†æ;allow_create:true" - å¤šé€‰ç»„ä»¶
	// æ¡†æ¶æ ‡ç­¾ï¼šallow_create:true - å…è®¸åˆ›å»ºè‡ªå®šä¹‰æ ‡ç­¾
	// æ³¨æ„ï¼šmultiselectæœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§stringçš„ä¼šç”¨,å·åˆ†éš”å¤šä¸ªå€¼ï¼Œç¬¬äºŒç§[]stringï¼Œä¼šç›´æ¥ç”¨åˆ‡ç‰‡å­˜å‚¨å¤šä¸ªå€¼
	// ä¸ºäº†æ–¹ä¾¿å­˜å‚¨åˆ°æ•°æ®åº“æˆ‘ä»¬é€‰æ‹©ç”¨string
	Tags string `json:"tags" runner:"name:ä¸ªäººæ ‡ç­¾" widget:"type:multiselect;options:å¼€æºé¡¹ç›®,AIç¼–ç¨‹,å…¨æ ˆå¼€å‘,ç»éªŒä¸°å¯Œ,åº”å±Šç”Ÿ,æ‡‚è¿ç»´,æ•°æ®åˆ†æ;allow_create:true"`
}

// ç®€å†æŠ•é€’å“åº”ç»“æ„
type HrRecruitmentApplyResp struct {
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:switch;true_label:æˆåŠŸ;false_label:å¤±è´¥" - å¼€å…³ç»„ä»¶ï¼Œæ˜¾ç¤ºæˆåŠŸ/å¤±è´¥çŠ¶æ€
	Success bool `json:"success" runner:"name:æ˜¯å¦æˆåŠŸ" widget:"type:switch;true_label:æˆåŠŸ;false_label:å¤±è´¥"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input;mode:text_area" - å¤šè¡Œæ–‡æœ¬åŒºåŸŸç»„ä»¶ï¼Œæ˜¾ç¤ºå¤„ç†ç»“æœä¿¡æ¯
	Message string `json:"message" runner:"name:å¤„ç†ç»“æœ" widget:"type:input;mode:text_area"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:number" - æ•°å­—æ˜¾ç¤ºç»„ä»¶ï¼Œæ˜¾ç¤ºç®€å†ID
	ResumeID int `json:"resume_id" runner:"name:ç®€å†ID" widget:"type:number"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶ï¼Œæ˜¾ç¤ºç®€å†çŠ¶æ€
	Status string `json:"status" runner:"name:ç®€å†çŠ¶æ€" widget:"type:input"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶ï¼Œæ˜¾ç¤ºä¸ªäººæ ‡ç­¾
	Tags string `json:"tags" runner:"name:ä¸ªäººæ ‡ç­¾" widget:"type:input"`

	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:input" - æ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶ï¼Œæ˜¾ç¤ºæäº¤æ—¶é—´
	SubmitTime string `json:"submit_time" runner:"name:æäº¤æ—¶é—´" widget:"type:input"`

	// å‡½æ•°è·³è½¬é“¾æ¥ - æ”¯æŒç‚¹å‡»åè·³è½¬åˆ°ç®€å†åˆ—è¡¨é¡µé¢
	// æ¡†æ¶æ ‡ç­¾ï¼šwidget:"type:function_link;auto_run:true;target:_blank" - å‡½æ•°è·³è½¬ç»„ä»¶ï¼Œè‡ªåŠ¨è¿è¡Œï¼Œæ–°çª—å£æ‰“å¼€
	ListLink string `json:"list_link" runner:"name:æŸ¥çœ‹æˆ‘çš„ç®€å†" widget:"type:function_link;auto_run:true;target:_blank"`
}

// ç®€å†åˆ—è¡¨è¯·æ±‚ç»“æ„
type HrRecruitmentListReq struct {
	// æ¡†æ¶æ ‡ç­¾ï¼šrunner:"-" - éšè—æœç´¢ï¼Œåˆ†é¡µï¼Œç­‰è¯·æ±‚å‚æ•°ï¼ˆæ— éœ€åœ¨å‰ç«¯æ˜¾ç¤ºï¼‰
	// è¿™ä¸ªä¼šè‡ªåŠ¨å¤„ç†è¿™ä¸ªæ•°æ®è¡¨å…¨éƒ¨å­—æ®µçš„è‡ªåŠ¨å®ç°åˆ†é¡µï¼ŒæŸ¥è¯¢ï¼Œæ’åºç­‰ç­‰
	query.SearchFilterPageReq `runner:"-"`
}

// ç®€å†æŠ•é€’å¤„ç†å‡½æ•°
func HrRecruitmentApply(ctx *runner.Context, req *HrRecruitmentApplyReq, resp response.Response) error {
	// è·å–æ•°æ®åº“è¿æ¥
	db := ctx.MustGetOrInitDB()

	// è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
	userInfo := ctx.GetUserInfo()

	// åˆ›å»ºç®€å†è®°å½•
	resume := &HrRecruitment{
		Name:       req.Name,
		Phone:      req.Phone,
		Email:      req.Email,
		Age:        req.Age,
		Gender:     req.Gender,
		Education:  req.Education,
		Position:   req.Position,
		WorkCity:   req.WorkCity,
		Experience: req.Experience,
		Salary:     req.Salary,
		Resume:     req.Resume,
		Introduce:  req.Introduce,
		Tags:       req.Tags,
		Status:     "å¾…é¢è¯•", // é»˜è®¤çŠ¶æ€ä¸ºå¾…é¢è¯•
		CreateBy:   userInfo.Username,
	}

	// ä¿å­˜ç®€å†åˆ°æ•°æ®åº“
	if err := db.Create(resume).Error; err != nil {
		return fmt.Errorf("ç®€å†æŠ•é€’å¤±è´¥: %v", err)
	}

	//'eq': 'ç­‰äº',
	//'not_eq': 'ä¸ç­‰äº',
	//'like': 'åŒ…å«',
	//'not_like': 'ä¸åŒ…å«',
	//'in': 'å±äº',
	//'not_in': 'ä¸å±äº',
	//'gt': 'å¤§äº',
	//'gte': 'å¤§äºç­‰äº',
	//'lt': 'å°äº',
	//'lte': 'å°äºç­‰äº',

	// ç”Ÿæˆè·³è½¬åˆ°åˆ—è¡¨é¡µé¢çš„é“¾æ¥ï¼Œæºå¸¦IDå‚æ•°å®šä½åˆ°åˆšåˆ›å»ºçš„è®°å½•ï¼Œè·³è½¬åˆ°tableå‡½æ•°éœ€è¦ç”¨searché‡Œçš„æ ‡ç­¾é…åˆä¸‹é¢çš„è¯­å¥ï¼Œformå‡½æ•°çš„è¯æ­£å¸¸ç”¨é‚£ç§queryå³å¯
	listLink := ctx.GetFunctionUrl(&runner.FunctionUrl{
		Title:        "æŸ¥çœ‹æˆ‘çš„ç®€å†",
		RouterGroup:  RouterGroup,
		FunctionName: "hr_recruitment_list",              // è·³è½¬åˆ°åˆ—è¡¨é¡µé¢,åˆ—è¡¨é¡µé¢çš„å‚æ•°ç›¸å¯¹æ¯”è¾ƒç‰¹æ®Šï¼Œéœ€è¦ç”¨æ ‡ç­¾æ¥
		Query:        fmt.Sprintf("eq=id:%v", resume.ID), // æºå¸¦IDå‚æ•°å®šä½åˆ°åˆšåˆ›å»ºçš„è®°å½•,&like=name:%s è¿™é‡Œå¯ä»¥ä¸åŠ ï¼Œåªæ˜¯ä¸ºäº†æ¼”ç¤ºä¸€ä¸‹
		//in=education:é«˜ä¸­,å¤§ä¸“  è¿™é‡Œæ˜¯æŸ¥è¯¢é«˜ä¸­å’Œå¤§ä¸“çš„è®°å½•
		//gte=graduation_year:2019 æ¯•ä¸šå¹´ä»½å¤§é›¨ç­‰äº2019çš„è®°å½•
		//like=name:beiluo åå­—åŒ…å«beiluoçš„è®°å½•
		//gte=graduation_year:2019&in=education:é«˜ä¸­,å¤§ä¸“  æŸ¥è¯¢2019å¹´åŠå…¶ä»¥åé«˜ä¸­æˆ–è€…å¤§ä¸“æ¯•ä¸šçš„è®°å½•
	})
	//

	// è¿”å›æˆåŠŸå“åº”
	return resp.Form(&HrRecruitmentApplyResp{
		Success:    true,
		Message:    "æ‚¨çš„ç®€å†å·²æˆåŠŸæŠ•é€’ï¼ç‚¹å‡»ä¸‹æ–¹é“¾æ¥æŸ¥çœ‹æ‚¨çš„ç®€å†çŠ¶æ€ã€‚",
		ResumeID:   resume.ID,
		Status:     "å¾…é¢è¯•",
		Tags:       resume.Tags,
		SubmitTime: "åˆšåˆš",
		ListLink:   listLink,
	}).Build()
}

// ç®€å†åˆ—è¡¨å¤„ç†å‡½æ•°
func HrRecruitmentList(ctx *runner.Context, req *HrRecruitmentListReq, resp response.Response) error {
	// è·å–æ•°æ®åº“è¿æ¥
	db := ctx.MustGetOrInitDB()
	var rows []*HrRecruitment

	// è‡ªåŠ¨å¤„ç†åˆ†é¡µã€æœç´¢ã€æ’åº
	queryBuilder := resp.Table(&rows).AutoPaginated(db, &HrRecruitment{}, &req.SearchFilterPageReq)

	// åˆ—è¡¨é¡µé¢ä¸éœ€è¦è·³è½¬é“¾æ¥ï¼Œå› ä¸ºåˆ—è¡¨æœ¬èº«å°±æ˜¾ç¤ºäº†æŠ•é€’çŠ¶æ€
	// ç”¨æˆ·å¯ä»¥ç›´æ¥åœ¨åˆ—è¡¨ä¸­æŸ¥çœ‹æ‰€æœ‰ç®€å†çš„çŠ¶æ€ä¿¡æ¯

	return queryBuilder.Build()
}

// ç®€å†æŠ•é€’é…ç½®
var HrRecruitmentApplyOption = &runner.FormFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "ç®€å†æŠ•é€’",                           // APIä¸­æ–‡åç§°
		ApiDesc:      "ç”¨æˆ·æŠ•é€’ç®€å†ç”³è¯·èŒä½",                     // APIæè¿°
		Tags:         []string{"æ‹›è˜ç³»ç»Ÿ", "ç®€å†æŠ•é€’", "æ±‚èŒç”³è¯·"}, // æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾åˆ†ç±»
		CreateTables: []interface{}{&HrRecruitment{}},  // åˆ›å»ºæ•°æ®è¡¨
		Request:      &HrRecruitmentApplyReq{},         // è¯·æ±‚å‚æ•°
		Response:     &HrRecruitmentApplyResp{},        // å“åº”å‚æ•°
		Group:        HrRecruitmentGroup,               // è®¾ç½®å‡½æ•°ç»„
	},
}

// ç®€å†ç®¡ç†é…ç½®
var HrRecruitmentListOption = &runner.TableFunctionOptions{
	BaseConfig: runner.BaseConfig{
		ChineseName:  "ç®€å†ç®¡ç†",                                  // APIä¸­æ–‡åç§°
		ApiDesc:      "HRç®€å†ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå®Œæ•´çš„CRUDæ“ä½œ",                  // APIæè¿°
		Tags:         []string{"æ‹›è˜ç³»ç»Ÿ", "ç®€å†ç®¡ç†", "HRç®¡ç†"},        // æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾åˆ†ç±»
		CreateTables: []interface{}{&HrRecruitment{}},         // åˆ›å»ºæ•°æ®è¡¨
		Request:      &HrRecruitmentListReq{},                 // è¯·æ±‚å‚æ•°
		Response:     query.PaginatedTable[[]HrRecruitment]{}, // å“åº”å‚æ•°
		Group:        HrRecruitmentGroup,                      // è®¾ç½®å‡½æ•°ç»„
	},

	// è‡ªåŠ¨CRUD
	AutoCrudTable: &HrRecruitment{},

	// æ–°å¢è®°å½•å›è°ƒ
	OnTableAddRows: func(ctx *runner.Context, req *usercall.OnTableAddRowsReq) (*usercall.OnTableAddRowsResp, error) {
		db := ctx.MustGetOrInitDB()
		var addRows []*HrRecruitment
		if err := req.DecodeBy(&addRows); err != nil {
			return nil, err
		}
		for _, row := range addRows {
			row.CreateBy = ctx.GetUserInfo().Username
		}
		err := db.Create(&addRows).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableAddRowsResp{}, nil
	},

	// æ›´æ–°è®°å½•å›è°ƒ
	OnTableUpdateRows: func(ctx *runner.Context, req *usercall.OnTableUpdateRowsReq) (*usercall.OnTableUpdateRowsResp, error) {
		db := ctx.MustGetOrInitDB()
		var updateRow HrRecruitment
		if err := req.DecodeBy(&updateRow); err != nil {
			return nil, err
		}
		err := db.Where("id in (?)", req.GetIds()).Updates(&updateRow).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableUpdateRowsResp{}, nil
	},

	// åˆ é™¤è®°å½•å›è°ƒ
	OnTableDeleteRows: func(ctx *runner.Context, req *usercall.OnTableDeleteRowsReq) (*usercall.OnTableDeleteRowsResp, error) {
		db := ctx.MustGetOrInitDB()
		err := db.Delete(&HrRecruitment{}, req.GetIds()).Error
		if err != nil {
			return nil, err
		}
		return &usercall.OnTableDeleteRowsResp{}, nil
	},
}

// è·¯ç”±æ³¨å†Œ
func init() {
	// æ³¨å†Œç®€å†æŠ•é€’è·¯ç”±
	runner.Post(RouterGroup+"/hr_recruitment_apply", HrRecruitmentApply, HrRecruitmentApplyOption)
	// æ³¨å†Œç®€å†ç®¡ç†è·¯ç”±
	runner.Get(RouterGroup+"/hr_recruitment_list", HrRecruitmentList, HrRecruitmentListOption)
}


```