# SFTæ•°æ®æ„é€ è§„èŒƒ - æœ€ä½³å®è·µæ¨¡æ¿

**æ ¸å¿ƒç†å¿µ**ï¼šé«˜è´¨é‡SFTæ•°æ® = é«˜è´¨é‡ä»£ç ç”Ÿæˆã€‚rag-apiæ ‡ç­¾ä½“ç°AIæ—¶ä»£çš„æ–‡æ¡£æ–°èŒƒå¼ã€‚

## ğŸ·ï¸ rag-apiæ ‡ç­¾ä½¿ç”¨è§„èŒƒ

### æ ¸å¿ƒåŸåˆ™
- **åªæš´éœ²å‡½æ•°ç­¾å**ï¼šrag-apiæ ‡ç­¾åªåŒ…å«å‡½æ•°å£°æ˜ï¼Œä¸åŒ…å«å‡½æ•°ä½“
- **ä¾¿äºAIæ£€ç´¢**ï¼šæ ‡ç­¾å†…å®¹åº”è¯¥è®©AIèƒ½å¤Ÿå¿«é€Ÿç†è§£å‡½æ•°ç”¨é€”å’Œå‚æ•°
- **é¿å…ä¿¡æ¯è¿‡è½½**ï¼šä¸è¦åœ¨æ ‡ç­¾ä¸­åŒ…å«å®ç°ç»†èŠ‚

### æ­£ç¡®ç”¨æ³•ç¤ºä¾‹
```go
// âœ… æ­£ç¡®ï¼šåªæš´éœ²å‡½æ•°ç­¾å
// <rag-api>
// å­¦ç”Ÿé€‰è¯¾ä¸šåŠ¡é€»è¾‘ï¼šå¤šé€‰è¯¾ç¨‹è®¡ç®—æ€»å­¦åˆ†ï¼Œæ”¯æŒé‡å¤é€‰è¯¾æ£€æµ‹å’Œå­¦åˆ†é™åˆ¶
func SchoolCourseSelectBusiness(ctx *runner.Context, req *SchoolCourseSelectReq, resp response.Response) error {
// </rag-api>

// âŒ é”™è¯¯ï¼šåŒ…å«å®Œæ•´å‡½æ•°ä½“
// <rag-api>
// å­¦ç”Ÿé€‰è¯¾ä¸šåŠ¡é€»è¾‘ï¼šå¤šé€‰è¯¾ç¨‹è®¡ç®—æ€»å­¦åˆ†ï¼Œæ”¯æŒé‡å¤é€‰è¯¾æ£€æµ‹å’Œå­¦åˆ†é™åˆ¶
func SchoolCourseSelectBusiness(ctx *runner.Context, req *SchoolCourseSelectReq, resp response.Response) error {
    // ... å®Œæ•´çš„å‡½æ•°å®ç°ä»£ç  ...
    return resp.Form(result).Build()
}
// </rag-api>
```

### æ ‡ç­¾ä½ç½®è§„èŒƒ
- **å¼€å§‹æ ‡ç­¾**ï¼šæ”¾åœ¨å‡½æ•°æ³¨é‡Šå’Œå‡½æ•°å£°æ˜ä¹‹é—´
- **ç»“æŸæ ‡ç­¾**ï¼šæ”¾åœ¨å‡½æ•°ç­¾åç»“æŸçš„ `{` ä¹‹åï¼Œå‡½æ•°ä½“å¼€å§‹ä¹‹å‰
- **å†…å®¹è¦æ±‚**ï¼šåªåŒ…å«å‡½æ•°æ³¨é‡Šå’Œå‡½æ•°ç­¾åï¼Œä¸åŒ…å«å‡½æ•°ä½“

### æš´éœ²å¿…è¦æ€§åˆ¤æ–­æ ‡å‡†

#### ğŸ¯ **å¿…é¡»æš´éœ²çš„æƒ…å†µ**
1. **è¡¨ç»“æ„ï¼ˆStructï¼‰**ï¼šå…¶ä»–æ¨¡å—éœ€è¦è¿è¡¨æŸ¥è¯¢æ—¶
2. **æ ¸å¿ƒå·¥å…·å‡½æ•°**ï¼šå…¶ä»–æ¨¡å—æ— æ³•æ›¿ä»£çš„åŠŸèƒ½ï¼ˆå¦‚è·å–å®‰è£…è·¯å¾„ï¼‰
3. **å…¬å…±æ¥å£**ï¼šå¤šä¸ªæ¨¡å—å…±åŒä½¿ç”¨çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

#### âŒ **ä¸éœ€è¦æš´éœ²çš„æƒ…å†µ**
1. **å†…éƒ¨è¯·æ±‚/å“åº”ç»“æ„ä½“**ï¼šåªåœ¨å½“å‰æ¨¡å—å†…éƒ¨ä½¿ç”¨
2. **ä¸šåŠ¡é€»è¾‘å‡½æ•°**ï¼šå…¶ä»–æ¨¡å—ä¸ä¼šè°ƒç”¨çš„å…·ä½“ä¸šåŠ¡å®ç°
3. **å·¥å…·å‡½æ•°**ï¼šå…¶ä»–æ¨¡å—å¯ä»¥è‡ªå·±å®ç°çš„ç®€å•åŠŸèƒ½
4. **é…ç½®é€‰é¡¹**ï¼šæ¡†æ¶é…ç½®ï¼Œä¸éœ€è¦AIç†è§£

#### ğŸ” **åˆ¤æ–­æ–¹æ³•**
åœ¨æ·»åŠ rag-apiæ ‡ç­¾å‰ï¼Œé—®è‡ªå·±ï¼š
- **å…¶ä»–æ¨¡å—çœŸçš„éœ€è¦çŸ¥é“è¿™ä¸ªåŠŸèƒ½å—ï¼Ÿ**
- **è¿™ä¸ªåŠŸèƒ½æ˜¯å¦å¯ä»¥è¢«å…¶ä»–æ¨¡å—è‡ªå·±å®ç°ï¼Ÿ**
- **æš´éœ²åæ˜¯å¦ä¼šç»™AIå¸¦æ¥å™ªéŸ³ï¼Ÿ**

#### ğŸ’¡ **æœ€ä½³å®è·µ**
- **å®å¯å°‘æš´éœ²ï¼Œä¹Ÿä¸è¦è¿‡åº¦æš´éœ²**
- **è¡¨ç»“æ„ä¼˜å…ˆæš´éœ²ï¼Œå‡½æ•°è°¨æ…æš´éœ²**
- **å…¶ä»–æ¨¡å—èƒ½è‡ªå·±é€ çš„ï¼Œç»ä¸æš´éœ²**
- **åªæœ‰çœŸæ­£å¿…è¦çš„æ ¸å¿ƒåŠŸèƒ½æ‰æš´éœ²**

## ğŸ¯ å®Œæ•´ç¤ºä¾‹ï¼šå­¦æ ¡ç®¡ç†ç³»ç»Ÿï¼ˆåˆ†æ–‡ä»¶è®¾è®¡ï¼‰

### Packageç»“æ„è¯´æ˜

æ¯ä¸ªpackageä¼šè‡ªåŠ¨ç”Ÿæˆ`init_.go`æ–‡ä»¶ï¼Œå®šä¹‰RouterGroupå˜é‡ï¼š
```go
// init_.go (è‡ªåŠ¨ç”Ÿæˆ)
package school
var RouterGroup = "/school"
```

### æ–‡ä»¶1ï¼šå­¦ç”Ÿç®¡ç† - school_student.goï¼ˆæ— ä¾èµ–åŸºç¡€æ¨¡å—ï¼‰

```go
package school

/*
<metadata>
<éœ€æ±‚>å­¦ç”Ÿç®¡ç†ï¼šå­¦ç”ŸåŸºç¡€ä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥ï¼Œæ”¯æŒå§“åæœç´¢ã€å¹´çº§ç­›é€‰ï¼Œä¸ºå…¶ä»–æ¨¡å—æä¾›å­¦ç”Ÿæ•°æ®åŸºç¡€</éœ€æ±‚>
<æ–‡ä»¶>school_student.go</æ–‡ä»¶>
<éš¾åº¦>åˆçº§ - æ ‡å‡†CRUDæ“ä½œ</éš¾åº¦>
<ä¾èµ–>æ— ä¾èµ–</ä¾èµ–>
<è®­ç»ƒç‚¹>æ ‡å‡†tableå‡½æ•°ã€æ•°æ®æ¨¡å‹è®¾è®¡ã€å‘½åè§„èŒƒ</è®­ç»ƒç‚¹>
</metadata>
*/

import (
    "fmt"
    "github.com/yunhanshu-net/function-go/pkg/dto/response"
    "github.com/yunhanshu-net/function-go/pkg/dto/usercall"
    "github.com/yunhanshu-net/function-go/runner"
    "github.com/yunhanshu-net/pkg/query"
    "gorm.io/gorm"
)

// ==================== 1. æ•°æ®æ¨¡å‹ ====================

// <rag-api>
// å­¦ç”Ÿè¡¨ï¼šæ”¯æŒå§“åæœç´¢ã€å¹´çº§ç­›é€‰ï¼Œè¡¨åschool_student
type SchoolStudent struct {
    ID        int            `json:"id" gorm:"primaryKey;autoIncrement" runner:"name:å­¦ç”ŸID" permission:"read"`
    CreatedAt int64          `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:åˆ›å»ºæ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
    UpdatedAt int64          `json:"updated_at" gorm:"autoUpdateTime:milli" runner:"name:æ›´æ–°æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
    DeletedAt gorm.DeletedAt `json:"deleted_at" gorm:"index" runner:"-"`
    
    Name      string         `json:"name" gorm:"column:name;comment:å§“å" runner:"name:å§“å" widget:"type:input" search:"like" validate:"required,min=2,max=50"`
    Grade     string         `json:"grade" gorm:"column:grade;comment:å¹´çº§" runner:"name:å¹´çº§" widget:"type:select;options:ä¸€å¹´çº§,äºŒå¹´çº§,ä¸‰å¹´çº§,å››å¹´çº§,äº”å¹´çº§,å…­å¹´çº§" search:"in" validate:"required"`
    ClassName string         `json:"class_name" gorm:"column:class_name;comment:ç­çº§" runner:"name:ç­çº§" widget:"type:input;placeholder:å¦‚: ä¸€(1)ç­" search:"like"`
    Phone     string         `json:"phone" gorm:"column:phone" runner:"name:æ‰‹æœºå·" widget:"type:input" search:"like" validate:"required,len=11,numeric" msg:"æ‰‹æœºå·å¿…é¡»ä¸º11ä½æ•°å­—"`
    Status    string         `json:"status" gorm:"column:status;comment:å­¦ç±çŠ¶æ€" runner:"name:å­¦ç±çŠ¶æ€" widget:"type:select;options:åœ¨æ ¡ç”Ÿ,å·²æ¯•ä¸š" data:"default_value:åœ¨æ ¡ç”Ÿ" search:"in" validate:"required"`
}
// </rag-api>

func (SchoolStudent) TableName() string { return "school_student" }

// ==================== 2. ä¸šåŠ¡é€»è¾‘ ====================

type SchoolStudentListReq struct {
    query.PageInfoReq `runner:"-"`
}

func SchoolStudentList(ctx *runner.Context, req *SchoolStudentListReq, resp response.Response) error {
    db := ctx.MustGetOrInitDB()
    var rows []SchoolStudent
    return resp.Table(&rows).AutoPaginated(db, &SchoolStudent{}, &req.PageInfoReq).Build()
}

type SchoolStudentCreateReq struct {
    Name      string `json:"name" runner:"name:å§“å" widget:"type:input" validate:"required,min=2,max=50"`
    Grade     string `json:"grade" runner:"name:å¹´çº§" widget:"type:select;options:ä¸€å¹´çº§,äºŒå¹´çº§,ä¸‰å¹´çº§,å››å¹´çº§,äº”å¹´çº§,å…­å¹´çº§" validate:"required"`
    ClassName string `json:"class_name" runner:"name:ç­çº§" widget:"type:input;placeholder:å¦‚: ä¸€(1)ç­"`
    Phone     string `json:"phone" runner:"name:æ‰‹æœºå·" widget:"type:input" validate:"required,len=11,numeric" msg:"æ‰‹æœºå·å¿…é¡»ä¸º11ä½æ•°å­—"`
}

type SchoolStudentCreateResp struct {
    Message   string `json:"message" runner:"name:ç»“æœ" widget:"type:input"`
    StudentID int    `json:"student_id" runner:"name:å­¦ç”ŸID" widget:"type:number"`
}

func SchoolStudentCreate(ctx *runner.Context, req *SchoolStudentCreateReq, resp response.Response) error {
    db := ctx.MustGetOrInitDB()
    
    student := &SchoolStudent{
        Name:      req.Name,
        Grade:     req.Grade,
        ClassName: req.ClassName,
        Phone:     req.Phone,
        Status:    "åœ¨æ ¡ç”Ÿ",
    }
    
    if err := db.Create(student).Error; err != nil {
        return err
    }
    
    return resp.Form(&SchoolStudentCreateResp{
        Message:   "å­¦ç”Ÿåˆ›å»ºæˆåŠŸï¼",
        StudentID: student.ID,
    }).Build()
}

// ==================== 3. æ¡†æ¶é…ç½® ====================

var SchoolStudentGroup = &runner.FunctionGroup{CnName: "å­¦ç”Ÿç®¡ç†", EnName: "school_student"}

var SchoolStudentListOption = &runner.TableFunctionOptions{
    BaseConfig: runner.BaseConfig{
        EnglishName:  "school_student_list",
        ChineseName:  "å­¦ç”Ÿç®¡ç†-åˆ—è¡¨",
        ApiDesc:      "å­¦ç”Ÿä¿¡æ¯åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µã€æœç´¢å’Œç­›é€‰ã€‚",
        Tags:         []string{"å­¦æ ¡", "å­¦ç”Ÿ"},
        Request:      &SchoolStudentListReq{},
        Response:     query.PaginatedTable[[]SchoolStudent]{},
        CreateTables: []interface{}{&SchoolStudent{}},
        Group:        SchoolStudentGroup,
    },
    AutoCrudTable: &SchoolStudent{},
    
    OnInputValidateMap: map[string]runner.OnInputValidate{
        "phone": func(ctx *runner.Context, req *usercall.OnInputValidateReq) (*usercall.OnInputValidateResp, error) {
            phone := fmt.Sprintf("%v", req.Value)
            
            if len(phone) != 11 || phone[0] != '1' {
                return &usercall.OnInputValidateResp{
                    IsValid: false,
                    Message: "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®",
                }, nil
            }
            
            db := ctx.MustGetOrInitDB()
            var count int64
            err := db.Model(&SchoolStudent{}).Where("phone = ?", phone).Count(&count).Error
            if err != nil || count > 0 {
                return &usercall.OnInputValidateResp{
                    IsValid: false,
                    Message: "è¯¥æ‰‹æœºå·å·²è¢«æ³¨å†Œ",
                }, nil
            }
            
            return &usercall.OnInputValidateResp{IsValid: true, Message: "æ‰‹æœºå·å¯ç”¨"}, nil
        },
    },
}

var SchoolStudentCreateOption = &runner.FormFunctionOptions{
    BaseConfig: runner.BaseConfig{
        EnglishName:  "school_student_create",
        ChineseName:  "å­¦ç”Ÿç®¡ç†-æ–°å»º",
        ApiDesc:      "åˆ›å»ºæ–°å­¦ç”Ÿï¼Œæ”¯æŒæ‰‹æœºå·é‡å¤æ€§æ ¡éªŒå’Œä¸šåŠ¡é€»è¾‘éªŒè¯ã€‚",
        Tags:         []string{"å­¦æ ¡", "å­¦ç”Ÿ", "åˆ›å»º"},
        Request:      &SchoolStudentCreateReq{},
        Response:     &SchoolStudentCreateResp{},
        CreateTables: []interface{}{&SchoolStudent{}},
        Group:        SchoolStudentGroup,
    },
    
    OnInputValidateMap: map[string]runner.OnInputValidate{
        "phone": func(ctx *runner.Context, req *usercall.OnInputValidateReq) (*usercall.OnInputValidateResp, error) {
            phone := fmt.Sprintf("%v", req.Value)
            
            if len(phone) != 11 {
                return &usercall.OnInputValidateResp{
                    IsValid: false,
                    Message: "æ‰‹æœºå·å¿…é¡»æ˜¯11ä½æ•°å­—",
                }, nil
            }
            
            for _, char := range phone {
                if char < '0' || char > '9' {
                    return &usercall.OnInputValidateResp{
                        IsValid: false,
                        Message: "æ‰‹æœºå·åªèƒ½åŒ…å«æ•°å­—",
                    }, nil
                }
            }
            
            if phone[0] != '1' {
                return &usercall.OnInputValidateResp{
                    IsValid: false,
                    Message: "æ‰‹æœºå·å¿…é¡»ä»¥1å¼€å¤´",
                }, nil
            }
            
            db := ctx.MustGetOrInitDB()
            var count int64
            err := db.Model(&SchoolStudent{}).Where("phone = ?", phone).Count(&count).Error
            if err != nil {
                return &usercall.OnInputValidateResp{
                    IsValid: false,
                    Message: "æ•°æ®åº“æŸ¥è¯¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•",
                }, nil
            }
            
            if count > 0 {
                return &usercall.OnInputValidateResp{
                    IsValid: false,
                    Message: "è¯¥æ‰‹æœºå·å·²è¢«æ³¨å†Œï¼Œè¯·ä½¿ç”¨å…¶ä»–æ‰‹æœºå·",
                }, nil
            }
            
            return &usercall.OnInputValidateResp{
                IsValid: true,
                Message: "æ‰‹æœºå·æ ¼å¼æ­£ç¡®ä¸”å¯ç”¨",
            }, nil
        },
    },
}

func init() {
    runner.Get(RouterGroup+"/school_student_list", SchoolStudentList, SchoolStudentListOption)
    runner.Post(RouterGroup+"/school_student_create", SchoolStudentCreate, SchoolStudentCreateOption)
}
```

### æ–‡ä»¶2ï¼šå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿ - school_course_select.goï¼ˆä¾èµ–å­¦ç”Ÿç®¡ç†ï¼‰

```go
package school

/*
<metadata>
<éœ€æ±‚>å­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿï¼šå­¦ç”Ÿæ•°æ®ä»å­¦ç”Ÿç®¡ç†æ¨¡å—è·å–ï¼Œæ”¯æŒå¤šé€‰è¯¾ç¨‹ã€å®æ—¶è®¡ç®—å­¦åˆ†ç»Ÿè®¡ï¼ŒåŒ…å«æ•°æ®æ ¡éªŒå’Œé€‰è¯¾é™åˆ¶ï¼Œé€‰è¯¾æˆåŠŸåæŒä¹…åŒ–é€‰è¯¾è®°å½•</éœ€æ±‚>
<æ–‡ä»¶>school_course_select.go</æ–‡ä»¶>
<éš¾åº¦>ä¸­ç­‰ - æ¶‰åŠè·¨æ¨¡å—ä¾èµ–ã€å¤šé€‰èšåˆã€æ•°æ®æ ¡éªŒã€äº‹åŠ¡å¤„ç†</éš¾åº¦>
<ä¾èµ–>SchoolStudentè¡¨ï¼ˆæ¥è‡ªschool_student.goå­¦ç”Ÿç®¡ç†æ¨¡å—ï¼‰</ä¾èµ–>
<è®­ç»ƒç‚¹>è·¨æ–‡ä»¶ä¾èµ–ã€OnInputFuzzyå­¦ç”ŸæŸ¥è¯¢ã€å¤šé€‰èšåˆè®¡ç®—ã€ä¸šåŠ¡æ ¡éªŒã€é”™è¯¯å¤„ç†</è®­ç»ƒç‚¹>
</metadata>
*/

import (
    "fmt"
    "github.com/yunhanshu-net/function-go/pkg/dto/response"
    "github.com/yunhanshu-net/function-go/pkg/dto/usercall"
    "github.com/yunhanshu-net/function-go/runner"
    "github.com/yunhanshu-net/pkg/query"
    "gorm.io/gorm"
)

// ==================== 1. æ•°æ®æ¨¡å‹ ====================

// <rag-api>
// é€‰è¯¾è®°å½•è¡¨ï¼šæŒä¹…åŒ–å­¦ç”Ÿé€‰è¯¾ç»“æœï¼Œæ”¯æŒæŒ‰å­¦ç”Ÿå’Œè¯¾ç¨‹ç­›é€‰ï¼Œè¡¨åschool_course_select
type SchoolCourseSelect struct {
    ID          int            `json:"id" gorm:"primaryKey;autoIncrement" runner:"name:ID" permission:"read"`
    CreatedAt   int64          `json:"created_at" gorm:"autoCreateTime:milli" runner:"name:é€‰è¯¾æ—¶é—´" widget:"type:datetime;kind:datetime" permission:"read"`
    DeletedAt   gorm.DeletedAt `json:"deleted_at" gorm:"index" runner:"-"`
    
    StudentID   int            `json:"student_id" runner:"name:å­¦ç”ŸID" widget:"type:number" search:"eq"`
    StudentName string         `json:"student_name" runner:"name:å­¦ç”Ÿå§“å" widget:"type:input" search:"like"`
    CourseID    int            `json:"course_id" runner:"name:è¯¾ç¨‹ID" widget:"type:number" search:"eq"`
    CourseName  string         `json:"course_name" runner:"name:è¯¾ç¨‹åç§°" widget:"type:input" search:"like"`
    Credit      float64        `json:"credit" runner:"name:å­¦åˆ†" widget:"type:number;precision:1"`
    Hours       int            `json:"hours" runner:"name:å­¦æ—¶" widget:"type:number"`
    Remarks     string         `json:"remarks" runner:"name:å¤‡æ³¨" widget:"type:input;mode:text_area"`
}
// </rag-api>

func (SchoolCourseSelect) TableName() string { return "school_course_select" }

// ==================== 2. ä¸šåŠ¡é€»è¾‘ ====================

// <rag-api>
// å­¦ç”Ÿé€‰è¯¾ä¸šåŠ¡é€»è¾‘ï¼šå¤šé€‰è¯¾ç¨‹è®¡ç®—æ€»å­¦åˆ†ï¼Œæ”¯æŒé‡å¤é€‰è¯¾æ£€æµ‹å’Œå­¦åˆ†é™åˆ¶
func SchoolCourseSelectBusiness(ctx *runner.Context, req *SchoolCourseSelectReq) (*SchoolCourseSelectResp, error) {
    if req.StudentID == 0 {
        return nil, fmt.Errorf("è¯·é€‰æ‹©å­¦ç”Ÿï¼›è‹¥æ— å¯é€‰é¡¹ï¼Œè¯·å…ˆåœ¨å­¦ç”Ÿç®¡ç†åˆ›å»ºå­¦ç”Ÿä¿¡æ¯ã€‚")
    }
    if len(req.CourseIDs) == 0 {
        return nil, fmt.Errorf("è¯·è‡³å°‘é€‰æ‹©ä¸€é—¨è¯¾ç¨‹ã€‚")
    }

    db := ctx.MustGetOrInitDB()
    
    var student SchoolStudent
    if err := db.Where("id = ?", req.StudentID).First(&student).Error; err != nil {
        return nil, fmt.Errorf("å­¦ç”Ÿä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥å­¦å·/å§“åï¼Œæˆ–å…ˆåœ¨å­¦ç”Ÿç®¡ç†åˆ›å»ºã€‚")
    }

    courses := []Course{
        {ID: 1, Name: "é«˜ç­‰æ•°å­¦", Credit: 4, Hours: 64},
        {ID: 2, Name: "å¤§å­¦è‹±è¯­", Credit: 3, Hours: 48},
        {ID: 3, Name: "è®¡ç®—æœºåŸºç¡€", Credit: 2.5, Hours: 40},
        {ID: 4, Name: "çº¿æ€§ä»£æ•°", Credit: 3, Hours: 48},
    }
    
    courseMap := make(map[int]Course)
    for _, c := range courses {
        courseMap[c.ID] = c
    }

    var totalCredit float64
    var totalHours int
    selections := make([]StudentCourseSelection, 0)
    
    for _, courseID := range req.CourseIDs {
        course, exists := courseMap[courseID]
        if !exists {
            return nil, fmt.Errorf("è¯¾ç¨‹ID %d ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°é€‰æ‹©ã€‚", courseID)
        }
        
        var existing StudentCourseSelection
        if err := db.Where("student_id = ? AND course_id = ?", req.StudentID, courseID).First(&existing).Error; err == nil {
            return nil, fmt.Errorf("è¯¾ç¨‹ %s å·²é€‰æ‹©è¿‡ï¼Œè¯·å‹¿é‡å¤é€‰è¯¾ã€‚", course.Name)
        }
        
        totalCredit += course.Credit
        totalHours += course.Hours
        
        selections = append(selections, StudentCourseSelection{
            StudentID:   student.ID,
            StudentName: student.Name,
            CourseID:    course.ID,
            CourseName:  course.Name,
            Credit:      course.Credit,
            Hours:       course.Hours,
        })
    }

    if totalCredit > 20 {
        return nil, fmt.Errorf("æ€»å­¦åˆ† %.1f è¶…è¿‡é™åˆ¶(20å­¦åˆ†)ï¼Œè¯·å‡å°‘è¯¾ç¨‹é€‰æ‹©ã€‚", totalCredit)
    }

    if err := db.Create(&selections).Error; err != nil {
        return nil, fmt.Errorf("é€‰è¯¾å¤±è´¥ï¼š%v", err)
    }

    return &SchoolCourseSelectResp{
        Message:     fmt.Sprintf("é€‰è¯¾æˆåŠŸï¼å…±é€‰æ‹© %d é—¨è¯¾ç¨‹ï¼Œæ€»è®¡ %.1f å­¦åˆ†", len(selections), totalCredit),
        TotalCredit: totalCredit,
        CourseCount: len(selections),
    }, nil
}
// </rag-api>

// ==================== 3. æ¡†æ¶é…ç½® ====================

var SchoolCourseSelectGroup = &runner.FunctionGroup{CnName: "å­¦ç”Ÿé€‰è¯¾", EnName: "school_course_select"}

var SchoolCourseSelectOption = &runner.FormFunctionOptions{
    BaseConfig: runner.BaseConfig{
        EnglishName:  "school_course_select",
        ChineseName:  "å­¦ç”Ÿé€‰è¯¾",
        ApiDesc:      "å­¦ç”Ÿå¤šé€‰è¯¾ç¨‹ï¼Œå®æ—¶å±•ç¤ºå­¦åˆ†ç»Ÿè®¡ï¼Œæ”¯æŒé‡å¤é€‰è¯¾æ£€æµ‹å’Œå­¦åˆ†ä¸Šé™æ§åˆ¶ã€‚",
        Tags:         []string{"å­¦æ ¡", "é€‰è¯¾", "å­¦åˆ†ç»Ÿè®¡"},
        Request:      &SchoolCourseSelectReq{},
        Response:     &SchoolCourseSelectResp{},
        CreateTables: []interface{}{&SchoolStudent{}, &SchoolCourseSelect{}},
        Group:        SchoolCourseSelectGroup,
        Dependencies: []string{"school_student.go"},
    },
    
    OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
        "student_id": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
            keyword := fmt.Sprintf("%v", req.Value)
            db := ctx.MustGetOrInitDB()
            
            var students []SchoolStudent
            query := db.Where("status = ?", "åœ¨æ ¡ç”Ÿ")
            if keyword != "" {
                query = query.Where("name LIKE ?", "%"+keyword+"%")
            }
            query.Limit(20).Find(&students)
            
            items := make([]*usercall.InputFuzzyItem, 0)
            for _, s := range students {
                items = append(items, &usercall.InputFuzzyItem{
                    Value: s.ID,
                    Label: fmt.Sprintf("%s (%s)", s.Name, s.Grade),
                    DisplayInfo: map[string]interface{}{
                        "å§“å": s.Name,
                        "å¹´çº§": s.Grade,
                        "çŠ¶æ€": s.Status,
                    },
                })
            }
            
            return &usercall.OnInputFuzzyResp{
                Statistics: map[string]interface{}{
                    "é€‰è¯¾è§„åˆ™": "æ¯å­¦æœŸæœ€å¤šé€‰6é—¨è¯¾ç¨‹",
                    "å­¦åˆ†è¦æ±‚": "æ¯•ä¸šéœ€æ»¡120å­¦åˆ†",
                    "é€‰è¯¾è¯´æ˜": "å¯é‡å¤é€‰è¯¾ï¼ŒæŒ‰æœ€æ–°è®°å½•ä¸ºå‡†",
                },
                Values: items,
            }, nil
        },
        
        "course_ids": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
            courses := []Course{
                {ID: 1, Name: "é«˜ç­‰æ•°å­¦", Credit: 4, Hours: 64},
                {ID: 2, Name: "å¤§å­¦è‹±è¯­", Credit: 3, Hours: 48},
                {ID: 3, Name: "è®¡ç®—æœºåŸºç¡€", Credit: 2.5, Hours: 40},
                {ID: 4, Name: "çº¿æ€§ä»£æ•°", Credit: 3, Hours: 48},
                {ID: 5, Name: "å¤§å­¦ç‰©ç†", Credit: 3.5, Hours: 56},
            }
            
            items := make([]*usercall.InputFuzzyItem, 0)
            for _, c := range courses {
                items = append(items, &usercall.InputFuzzyItem{
                    Value: c.ID,
                    Label: fmt.Sprintf("%s - %.1få­¦åˆ† %då­¦æ—¶", c.Name, c.Credit, c.Hours),
                    DisplayInfo: map[string]interface{}{
                        "è¯¾ç¨‹åç§°": c.Name,
                        "å­¦åˆ†":   c.Credit,
                        "å­¦æ—¶":   c.Hours,
                    },
                })
            }
            
            return &usercall.OnInputFuzzyResp{
                Statistics: map[string]interface{}{
                    "æ€»å­¦åˆ†":  "sum(å­¦åˆ†)",
                    "æ€»å­¦æ—¶":  "sum(å­¦æ—¶)", 
                    "è¯¾ç¨‹æ•°":  "count(å­¦åˆ†)",
                    "å¹³å‡å­¦åˆ†": "avg(å­¦åˆ†)",
                    "é€‰è¯¾æç¤º": "å»ºè®®æ€»å­¦åˆ†ä¸è¶…è¿‡ 20 å­¦åˆ†",
                    "é€‰è¯¾æ”¿ç­–": "æ¯å­¦æœŸæœ€å¤šé€‰æ‹© 8 é—¨è¯¾ç¨‹",
                },
                Values: items,
            }, nil
        },
    },
}

func init() {
    runner.Post(RouterGroup+"/school_course_select", SchoolCourseSelect, SchoolCourseSelectOption)
}
```

## âš ï¸ å…³é”®è§„èŒƒå¼ºè°ƒ

### **1. å‘½åè§„èŒƒï¼ˆä¸¥æ ¼æ‰§è¡Œï¼‰**

**æ ¸å¿ƒåŸåˆ™**ï¼šæ–‡ä»¶åä½œä¸ºå‘½åå‰ç¼€ï¼Œç¡®ä¿å‘½åä¸é‡å¤ã€æ˜“ç»´æŠ¤

| æ–‡ä»¶å | ç»“æ„ä½“ | å‡½æ•° | é…ç½® | è¡¨å | è·¯ç”± |
|---|---|---|---|---|---|
| `school_student.go` | `SchoolStudent` | `SchoolStudentList` | `SchoolStudentListOption` | `school_student` | `RouterGroup+"/school_student_list"` |
| `school_course_select.go` | `SchoolCourseSelect` | `SchoolCourseSelectBusiness` | `SchoolCourseSelectOption` | `school_course_select` | `RouterGroup+"/school_course_select"` |

**ä¸¥æ ¼è¦æ±‚**ï¼š
- âœ… **ç»“æ„ä½“åç§°**ï¼š`æ–‡ä»¶åCamelCase` ï¼ˆå¦‚ï¼šSchoolStudentï¼‰
- âœ… **å‡½æ•°åç§°**ï¼š`æ–‡ä»¶åCamelCase + åŠ¨ä½œ` ï¼ˆå¦‚ï¼šSchoolStudentListï¼‰
- âœ… **é…ç½®åç§°**ï¼š`æ–‡ä»¶åCamelCase + åŠ¨ä½œ + Option` ï¼ˆå¦‚ï¼šSchoolStudentListOptionï¼‰
- âœ… **è¡¨å**ï¼š`æ–‡ä»¶åsnake_case` ï¼ˆå¦‚ï¼šschool_studentï¼‰
- âœ… **è·¯ç”±**ï¼š`RouterGroup + "/" + å‡½æ•°EnglishName` ï¼ˆå¦‚ï¼šRouterGroup+"/school_student_list"ï¼‰

### **2. æ–‡ä»¶æ‹†åˆ†åŸåˆ™ï¼ˆä¾èµ–åˆ†ç¦»ï¼‰**

**åŸºç¡€æ— ä¾èµ–æ¨¡å—ä¼˜å…ˆ**ï¼š
- ğŸ“ `school_student.go` - **å­¦ç”Ÿç®¡ç†**ï¼ˆæ— ä¾èµ–ï¼Œæä¾›å­¦ç”Ÿæ•°æ®åŸºç¡€ï¼‰
- ğŸ“ `school_course_select.go` - **å­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿ**ï¼ˆä¾èµ–å­¦ç”Ÿç®¡ç†æ¨¡å—ï¼‰

**ä¾èµ–å…³ç³»ä½“ç°**ï¼š
- âœ… è¢«ä¾èµ–çš„åŸºç¡€æ¨¡å‹æ”¾åœ¨å•ç‹¬æ–‡ä»¶
- âœ… æœ‰ä¾èµ–çš„ä¸šåŠ¡é€»è¾‘æ”¾åœ¨å•ç‹¬æ–‡ä»¶  
- âœ… metadataä¸­æ˜ç¡®å£°æ˜ä¾èµ–å…³ç³»
- âœ… BaseConfigä¸­é€šè¿‡Dependencieså­—æ®µå£°æ˜ä¾èµ–çš„æ–‡ä»¶å
- âœ… ä¾¿äºå‰ç«¯å¯è§†åŒ–å±•ç¤ºå’Œåç«¯ä¾èµ–è§£æ

### **3. ä»£ç é¡ºåºæ ‡å‡†ï¼ˆå¤§æ¨¡å‹å­¦ä¹ ä¼˜åŒ–ï¼‰**

**æ ‡å‡†é¡ºåº**ï¼šæ¦‚å¿µé€’è¿›ï¼Œä¾èµ–æœ‰åº
```
1. æ•°æ®æ¨¡å‹ï¼ˆåŸºç¡€æ¦‚å¿µå±‚ï¼‰      â† å»ºç«‹åŸºç¡€æ¦‚å¿µ
2. ä¸šåŠ¡é€»è¾‘ï¼ˆä¸šåŠ¡åŠŸèƒ½å±‚ï¼‰      â† å®ç°ä¸šåŠ¡é€»è¾‘
3. æ¡†æ¶é…ç½®ï¼ˆåŸºç¡€è®¾æ–½å±‚ï¼‰      â† åŸºç¡€è®¾æ–½
```

**æ ¸å¿ƒåŸç†**ï¼š
- âœ… **å…ˆå®šä¹‰åä½¿ç”¨**ï¼šè¢«ä¾èµ–çš„ç±»å‹å…ˆå®šä¹‰
- âœ… **æŠ½è±¡åˆ°å…·ä½“**ï¼šä»ä¸šåŠ¡æ¦‚å¿µåˆ°æŠ€æœ¯å®ç°
- âœ… **é‡è¦åˆ°æ¬¡è¦**ï¼šæ ¸å¿ƒåŠŸèƒ½åœ¨å‰ï¼Œé…ç½®åœ¨å

## ğŸ† æœ€ä½³å®è·µè¦ç‚¹

### **1. ä¸šåŠ¡é€»è¾‘ä¸æ¡†æ¶è§£è€¦ï¼ˆæ ¸å¿ƒåŸåˆ™ï¼‰**
- âœ… **çº¯ä¸šåŠ¡å‡½æ•°**ï¼š`CourseSelectBusiness` ä¸ä¾èµ–æ¡†æ¶ï¼Œå¯åœ¨ä»»ä½•ä¸Šä¸‹æ–‡è°ƒç”¨
- âœ… **æ¡†æ¶é€‚é…å±‚**ï¼š`CourseSelect` ä»…è´Ÿè´£é€‚é…runneræ¡†æ¶ï¼Œè–„è–„ä¸€å±‚
- âœ… **å®Œæ•´ç±»å‹æš´éœ²**ï¼šrag-apiæ ‡ç­¾åŒ…å«å®Œæ•´çš„å‚æ•°å’Œè¿”å›ç±»å‹å®šä¹‰
- âœ… **å¤ç”¨æ€§å¼º**ï¼šä¸šåŠ¡é€»è¾‘å¯è¢«å…¶ä»–æ¨¡å—ã€æµ‹è¯•ã€CLIç­‰å¤šç§ä¸Šä¸‹æ–‡å¤ç”¨

### **2. rag-apiæ ‡ç­¾è§„èŒƒ**
- âœ… **åŒ…å«å‡½æ•°ç­¾å**ï¼šç­¾åå’Œæè¿°ä¸€ä½“åŒ–ï¼Œä¾¿äºå·¥å…·æå–
- âœ… **å®Œæ•´ç±»å‹ä¿¡æ¯**ï¼šæ˜ç¡®è¯´æ˜å‚æ•°ç»“æ„å’Œè¿”å›ç»“æœ
- âœ… **ä¸šåŠ¡å¯¼å‘æè¿°**ï¼šç›´æ¥è¯´æ˜è§£å†³ä»€ä¹ˆä¸šåŠ¡é—®é¢˜
- âœ… **ä½¿ç”¨å»ºè®®**ï¼šå‘Šè¯‰è°ƒç”¨è€…æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹
- âœ… **é”™è¯¯å¤„ç†æŒ‡å¯¼**ï¼šè¯´æ˜å¸¸è§é”™è¯¯åœºæ™¯å’Œå¤„ç†æ–¹å¼

### **3. æ³¨é‡Šå±‚æ¬¡åˆ†æ˜**
- **å¤´éƒ¨å…ƒæ•°æ®**ï¼šä¾›å†…éƒ¨å·¥å…·ä½¿ç”¨ï¼Œè®­ç»ƒæ—¶ä¼šå‰”é™¤
- **ä»£ç å†…æ³¨é‡Š**ï¼šç®€æ´æ˜äº†ï¼Œçªå‡ºæ ¸å¿ƒæ¦‚å¿µ
- **rag-apiæš´éœ²**ï¼šå®Œæ•´çš„èƒ½åŠ›å’Œä½¿ç”¨æŒ‡å—

### **4. ä¸šåŠ¡ä»·å€¼ä½“ç°**
- **ç”¨æˆ·å¯¼å‘**ï¼šé”™è¯¯ä¿¡æ¯æŒ‡å¯¼ç”¨æˆ·å…·ä½“æ“ä½œ
- **åœºæ™¯å®Œæ•´**ï¼šè¦†ç›–æ­£å¸¸æµç¨‹å’Œå¼‚å¸¸å¤„ç†
- **å®ç”¨å»ºè®®**ï¼šåŸºäºå®é™…ç»éªŒçš„æœ€ä½³å®è·µ

### **5. æš´éœ²è¾¹ç•Œæ§åˆ¶ï¼ˆå…³é”®åŸåˆ™ï¼‰**
- âœ… **ä»·å€¼é©±åŠ¨æš´éœ²**ï¼šåªæš´éœ²å¯¹å¤–æœ‰å¤ç”¨ä»·å€¼çš„æ¥å£ï¼Œé¿å…ä¿¡æ¯è¿‡è½½
- âœ… **åˆ†å±‚æš´éœ²ç­–ç•¥**ï¼šä¸šåŠ¡æ ¸å¿ƒå±‚å¿…é¡»æš´éœ²ï¼Œå·¥å…·æ”¯æ’‘å±‚é€‰æ‹©æ€§æš´éœ²ï¼Œå†…éƒ¨å®ç°å±‚ä¸æš´éœ²
- âœ… **ç¨³å®šæ€§ä¼˜å…ˆ**ï¼šä¼˜å…ˆæš´éœ²ç¨³å®šçš„ä¸šåŠ¡æŠ½è±¡ï¼Œé¿å…æš´éœ²æ˜“å˜çš„å®ç°ç»†èŠ‚
- âœ… **ç»´æŠ¤æˆæœ¬è€ƒé‡**ï¼šæ¯ä¸ªæš´éœ²çš„æ¥å£éƒ½éœ€è¦ç»´æŠ¤æ–‡æ¡£ï¼Œç¡®ä¿ROIä¸ºæ­£
- âœ… **æç®€åŸåˆ™**ï¼šä¸æåŒ…çº§æ¦‚è§ˆï¼Œä¸é‡å¤æè¿°ï¼Œæ¯ä¸ªrag-apiæ ‡ç­¾ç›´æ¥ã€ç²¾å‡†ã€æœ‰ç‹¬ç‰¹ä»·å€¼

### **6. ä¾èµ–å…³ç³»å¤„ç†åŸåˆ™ï¼ˆæ ¸å¿ƒè®¾è®¡ç†å¿µï¼‰**

**ç”¨æˆ·æ´å¯Ÿ**ï¼š*"ä¸è¦è®©è¢«å¼•ç”¨çš„å»å…³å¿ƒåˆ«äººï¼Œè€Œæ˜¯æˆ‘å¼•ç”¨åˆ«äººæˆ‘éœ€è¦å…³å¿ƒä»–"*

#### **ä¾èµ–åŸåˆ™æ ¸å¿ƒæ€æƒ³**
- **ğŸ¯ èŒè´£å•ä¸€**ï¼šåŸºç¡€è¡¨ä¸“æ³¨è‡ªèº«CRUDï¼Œä¸å…³å¿ƒè°ä¾èµ–äº†è‡ªå·±
- **ğŸ“‹ ä¾èµ–æ–¹è´Ÿè´£**ï¼šä¸šåŠ¡è¡¨æ‰¿æ‹…ä¾èµ–ç®¡ç†è´£ä»»ï¼Œè¯´æ˜å‰ç½®æ¡ä»¶
- **ğŸ”’ è¾¹ç•Œæ¸…æ™°**ï¼šæ¯ä¸ªæ¨¡å—æœ‰æ˜ç¡®çš„èŒè´£è¾¹ç•Œï¼Œé¿å…èŒè´£æ··ä¹±
- **âš¡ ç»´æŠ¤ç®€å•**ï¼šåŸºç¡€è¡¨æ³¨é‡Šç®€æ´ï¼Œä¾èµ–å¤æ‚åº¦é›†ä¸­åœ¨ä¸šåŠ¡å±‚

#### **ä¾èµ–å±‚æ¬¡åˆ’åˆ†**
```
åŸºç¡€å±‚ï¼ˆè¢«ä¾èµ–ï¼Œæ³¨é‡Šç®€æ´ï¼‰:
â”œâ”€â”€ å­¦ç”Ÿè¡¨ â† "çº¯CRUDï¼Œå¯ç›´æ¥æ“ä½œ"
â”œâ”€â”€ è¯¾ç¨‹è¡¨ â† "åŸºç¡€ä¿¡æ¯ç®¡ç†ï¼Œç›´æ¥æŸ¥è¯¢"  
â”œâ”€â”€ æ´»åŠ¨è¡¨ â† "æ´»åŠ¨åŸºç¡€ä¿¡æ¯ï¼Œç›´æ¥æ“ä½œ"
â””â”€â”€ æ•™å¸ˆè¡¨ â† "æ•™å¸ˆåŸºç¡€èµ„æ–™ï¼Œç›´æ¥å¼•ç”¨"

ä¸šåŠ¡å±‚ï¼ˆä¾èµ–åŸºç¡€å±‚ï¼Œæ‰¿æ‹…ä¾èµ–è´£ä»»ï¼‰:
â”œâ”€â”€ é€‰è¯¾è®°å½• â†’ ä¾èµ–å­¦ç”Ÿ+è¯¾ç¨‹ â† "å‰ç½®æ¡ä»¶ï¼šé¡»å…ˆæ³¨å†Œå­¦ç”Ÿå’Œè¯¾ç¨‹"
â”œâ”€â”€ æ´»åŠ¨æŠ¥å â†’ ä¾èµ–å­¦ç”Ÿ+æ´»åŠ¨ â† "å‰ç½®æ¡ä»¶ï¼šé¡»å…ˆæ³¨å†Œå­¦ç”Ÿå’Œæ´»åŠ¨"  
â”œâ”€â”€ å­¦ç”Ÿå¡ â†’ ä¾èµ–å­¦ç”Ÿ â† "å‰ç½®æ¡ä»¶ï¼šé¡»å…ˆåœ¨å­¦ç”Ÿç®¡ç†æ³¨å†Œç”¨æˆ·"
â””â”€â”€ æˆç»©è®°å½• â†’ ä¾èµ–å­¦ç”Ÿ+è¯¾ç¨‹ â† "å‰ç½®æ¡ä»¶ï¼šé¡»å®Œæˆé€‰è¯¾æµç¨‹"
```

#### **æ³¨é‡Šæ¨¡å¼å¯¹æ¯”**

**âŒ é”™è¯¯æ¨¡å¼ï¼šåŸºç¡€è¡¨æ‰¿æ‹…è¿‡å¤šè´£ä»»**
```go
// å­¦ç”Ÿè¡¨ï¼šåŸºç¡€ä¿¡æ¯ + åˆ é™¤æ—¶éœ€è¦é€šçŸ¥é€‰è¯¾ç³»ç»Ÿã€æ´»åŠ¨ç³»ç»Ÿã€åå‹¤ç³»ç»Ÿ...
// åè°ƒæŒ‡å—ï¼šåˆ é™¤å­¦ç”Ÿæ—¶éœ€è¦å…ˆåˆ é™¤å­¦ç”Ÿå¡ã€å–æ¶ˆé€‰è¯¾ã€å–æ¶ˆæ´»åŠ¨æŠ¥å...
```

**âœ… æ­£ç¡®æ¨¡å¼ï¼šä¾èµ–æ–¹æ‰¿æ‹…è´£ä»»**
```go
// åŸºç¡€è¡¨ï¼ˆè¢«ä¾èµ–æ–¹ï¼‰- ç®€æ´æ˜äº†
// <rag-api>
// å­¦ç”Ÿè¡¨ï¼šå­¦ç”ŸåŸºç¡€ä¿¡æ¯ç®¡ç†ï¼Œçº¯CRUDæ“ä½œï¼Œå…¶ä»–æ¨¡å—å¯ç›´æ¥æŸ¥è¯¢å’Œå¼•ç”¨
type SchoolStudent struct { ... }
// </rag-api>

// ä¸šåŠ¡è¡¨ï¼ˆä¾èµ–æ–¹ï¼‰- æ‰¿æ‹…ä¾èµ–è´£ä»»  
// <rag-api>
// å­¦ç”Ÿå¡è¡¨ï¼šå­¦ç”Ÿä¸€å¡é€šç®¡ç†ï¼Œä¾èµ–å­¦ç”ŸåŸºç¡€ä¿¡æ¯
// ã€å‰ç½®æ¡ä»¶ã€‘ï¼šæ–°å¢å­¦ç”Ÿå¡å‰é¡»å…ˆåœ¨å­¦ç”Ÿç®¡ç†æ¨¡å—æ³¨å†Œå­¦ç”Ÿä¿¡æ¯
// ã€ä¾èµ–å…³ç³»ã€‘ï¼šstudent_id å¤–é”®å¼•ç”¨ school_student.id
type SchoolStudentCard struct {
    StudentID int `json:"student_id"` // ä¾èµ–å­¦ç”Ÿè¡¨
}
// </rag-api>
```

### **7. æŠ€æœ¯è§„èŒƒéµå¾ª**
- **å‘½åä¸€è‡´æ€§**ï¼šæ–‡ä»¶åã€ç»“æ„ä½“ã€è¡¨åã€è·¯ç”±ä¿æŒä¸€è‡´
- **æ ‡ç­¾æ­£ç¡®æ€§**ï¼šrunneræ ‡ç­¾ã€widgeté…ç½®ã€searché…ç½®è§„èŒƒä½¿ç”¨
- **æ¡†æ¶ç‰¹æ€§**ï¼šOnInputFuzzyèšåˆã€æ•°æ®æ ¡éªŒã€äº‹åŠ¡å¤„ç†ç­‰
- **ä¾èµ–åŸåˆ™**ï¼šåŸºç¡€è¡¨ç®€æ´ï¼Œä¸šåŠ¡è¡¨æ‰¿æ‹…ä¾èµ–ç®¡ç†è´£ä»»

## ğŸ¯ æš´éœ²è¾¹ç•Œæ§åˆ¶è¯¦è§£

### **æ ¸å¿ƒé—®é¢˜ï¼šé¿å…ä¿¡æ¯å™ªéŸ³ï¼**

**ç”¨æˆ·åé¦ˆ**ï¼š*"æ³¨é‡Šéƒ½å¿«èµ¶ä¸Šä»£ç äº†ï¼Œæˆ‘ä¸ªäººæ„Ÿè§‰å¾ˆå¤šéƒ½æ²¡å¿…è¦æš´éœ²...æ€•åœ¨è®©å¤§æ¨¡å‹ç”Ÿæˆæ—¶å€™ç»™å¤ªå¤šä¿¡æ¯é€ æˆå™ªéŸ³"*

**åè°ƒå¼æš´éœ²åŸåˆ™**ï¼šé»˜è®¤åªè¯»æš´éœ²ï¼ŒåŒæ—¶æä¾›å†™å…¥åè°ƒæŒ‡å— - **"å°½å¯èƒ½åªè¯»ï¼Œå¿…è¦å¯åè°ƒ"**ã€‚

**æ ¸å¿ƒç†å¿µ**ï¼š
- **ğŸ”’ é»˜è®¤åªè¯»**ï¼šå®‰å…¨ç¬¬ä¸€ï¼Œé¿å…è·¨æ¨¡å—æ•°æ®æ±¡æŸ“
- **ğŸ“‹ åè°ƒæŒ‡å—**ï¼šæ˜ç¡®å‘ŠçŸ¥å†™å…¥æ“ä½œçš„æ­£ç¡®åè°ƒæµç¨‹  
- **ğŸ¤ è´£ä»»æ˜ç¡®**ï¼šå„æ¨¡å—ç®¡å¥½è‡ªå·±çš„æ•°æ®ï¼Œä½†æä¾›åä½œæ–¹æ¡ˆ
- **âš¡ ä¾èµ–åŸåˆ™**ï¼šä¾èµ–è€…å…³å¿ƒè¢«ä¾èµ–è€…ï¼Œè€Œä¸æ˜¯åè¿‡æ¥

### **æš´éœ²åˆ¤æ–­çŸ©é˜µ**

| ä¼˜å…ˆçº§ | ç±»å‹ | ç¤ºä¾‹ | æš´éœ²ç†ç”± | rag-apiæ ‡ç­¾ |
|---|---|---|---|---|
| **ğŸ”¥ P0** | æ•°æ®æ¨¡å‹ | `SchoolStudent` | å…¶ä»–æ¨¡å—åŸºç¡€ä¾èµ– | âœ… å¿…éœ€ |
| **ğŸ”¥ P0** | ç³»ç»Ÿå·¥å…· | `videoFfmpegResolveFFmpeg()` | ç³»ç»Ÿçº§æ£€æŸ¥ï¼Œæ™®ééœ€æ±‚ | âœ… å¿…éœ€ |
| **âš¡ P1** | å¤æ‚ä¸šåŠ¡ | `SchoolCourseSelectBusiness()` | åŒ…å«å¤æ‚æ ¡éªŒï¼Œéš¾ä»¥é‡å¤å®ç° | âœ… å»ºè®® |
| **âŒ P2** | ç®€å•å·¥å…· | `calculateCourseStats()` | é€»è¾‘ç®€å•ï¼Œæ³¨é‡Šæ¯”ä»£ç é•¿ | âŒ ç¦æ­¢ |
| **âŒ P3** | çº¯CRUD | `SchoolStudentCreate()` | ç›´æ¥æ“ä½œè¡¨å³å¯ | âŒ ç¦æ­¢ |
| **âŒ P3** | æ¡†æ¶é€‚é… | `SchoolActivityRegister()` | æ¡†æ¶å±‚ï¼Œä¸ä¼šè¢«è°ƒç”¨ | âŒ ç¦æ­¢ |

### **åˆ¤æ–­æ ‡å‡†ï¼ˆç²¾ç®€äº”é—®æ³•åˆ™ï¼‰**

æš´éœ²å‰å¿…é¡»é—®è‡ªå·±ï¼š

1. **ğŸ¤” è·¨æ¨¡å—éœ€æ±‚**ï¼šå…¶ä»–æ¨¡å—çœŸçš„éœ€è¦è°ƒç”¨å—ï¼Ÿ
2. **ğŸ”§ å®ç°å¤æ‚åº¦**ï¼šå…¶ä»–æ¨¡å—è‡ªå·±å®ç°å›°éš¾å—ï¼Ÿï¼ˆ3è¡Œä»£ç èƒ½æå®šçš„ä¸è¦æš´éœ²ï¼ï¼‰
3. **ğŸ“Š ä¸šåŠ¡æ ¸å¿ƒæ€§**ï¼šè¿™æ˜¯æ ¸å¿ƒä¸šåŠ¡é€»è¾‘è€Œä¸æ˜¯ç®€å•è®¡ç®—å—ï¼Ÿ
4. **âš¡ ç³»ç»Ÿçº§ä»·å€¼**ï¼šè¿™æ˜¯ç³»ç»Ÿçº§å·¥å…·è¿˜æ˜¯æ¨¡å—å†…éƒ¨å·¥å…·ï¼Ÿ
5. **ğŸ“ æ³¨é‡ŠROI**ï¼šrag-apiæ³¨é‡Šçš„è®­ç»ƒä»·å€¼æ˜¯å¦å¤§äºä¿¡æ¯å™ªéŸ³ï¼Ÿ

**âš ï¸ æ–°è§„åˆ™ï¼šè‡³å°‘4ä¸ª"æ˜¯"æ‰è€ƒè™‘æš´éœ²ï¼Œå¦åˆ™å®å¯ä¸æš´éœ²ï¼**

**é¿å…æš´éœ²çš„å…¸å‹åœºæ™¯ï¼š**
- æ³¨é‡Šæ¯”ä»£ç é•¿çš„ç®€å•å‡½æ•°
- å…¶ä»–æ¨¡å—å¯ä»¥3è¡Œä»£ç è‡ªå·±å®ç°çš„å·¥å…·å‡½æ•°  
- çº¯ç²¹çš„æ•°æ®åº“CRUDæ“ä½œ
- åªæœ‰1-2è¡Œæ ¸å¿ƒé€»è¾‘çš„å‡½æ•°

### **å…·ä½“æš´éœ²ç­–ç•¥**

#### âœ… **åº”è¯¥æš´éœ²çš„æ¥å£**

**1. åŸºç¡€æ•°æ®è¡¨ - è¢«ä¾èµ–æ–¹ï¼ˆP0çº§åˆ« - å¿…é¡»æš´éœ²ï¼‰**
```go
// âœ… å¿…é¡»æš´éœ² - åŸºç¡€æ•°æ®è¡¨ï¼Œå…¶ä»–æ¨¡å—æŸ¥è¯¢å’Œå¼•ç”¨åŸºç¡€
// <rag-api>
// å­¦ç”Ÿè¡¨ï¼šå­¦ç”ŸåŸºç¡€ä¿¡æ¯ç®¡ç†ï¼Œçº¯CRUDæ“ä½œï¼Œå…¶ä»–æ¨¡å—å¯ç›´æ¥æŸ¥è¯¢å’Œå¼•ç”¨
type SchoolStudent struct {
    ID     int    `json:"id" gorm:"primaryKey"`
    Name   string `json:"name" search:"like"`
    Status string `json:"status" search:"in"`  // åœ¨æ ¡ç”Ÿ/å·²æ¯•ä¸š/å·²é€€å­¦
}
// </rag-api>
```

**2. ç³»ç»Ÿçº§å·¥å…·ï¼ˆP0çº§åˆ« - å¿…é¡»æš´éœ²ï¼‰**
```go
// âœ… å¿…é¡»æš´éœ² - ç³»ç»Ÿçº§æ£€æŸ¥ï¼Œæ™®ééœ€è¦
// <rag-api>
// FFmpegç¯å¢ƒæ£€æµ‹ï¼šæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å®‰è£…FFmpegï¼Œè¿”å›å®‰è£…è·¯å¾„æˆ–é”™è¯¯
func videoFfmpegResolveFFmpeg(ctx *runner.Context) (installPath string, err error)
// </rag-api>
```

**3. å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼ˆP1çº§åˆ« - å»ºè®®æš´éœ²ï¼‰**
```go
// âœ… åº”è¯¥æš´éœ² - åŒ…å«å¤æ‚ä¸šåŠ¡æ ¡éªŒï¼Œéš¾ä»¥é‡å¤å®ç°
// <rag-api>
// å­¦ç”Ÿé€‰è¯¾ä¸šåŠ¡é€»è¾‘ï¼šå¤šé€‰è¯¾ç¨‹è®¡ç®—æ€»å­¦åˆ†ï¼Œæ”¯æŒé‡å¤é€‰è¯¾æ£€æµ‹å’Œå­¦åˆ†é™åˆ¶
func SchoolCourseSelectBusiness(ctx *runner.Context, req *SchoolCourseSelectReq) (*SchoolCourseSelectResp, error)
// </rag-api>
```

#### âŒ **ä¸åº”è¯¥æš´éœ²çš„æ¥å£**
```go
// æ¡†æ¶é€‚é…å±‚ - åªæ˜¯èƒ¶æ°´ä»£ç ï¼Œæ— ç‹¬ç‰¹ä»·å€¼
func CourseSelect(ctx *runner.Context, req *CourseSelectReq, resp response.Response) error {
    result, err := CourseSelectBusiness(ctx, req)
    if err != nil {
        return err
    }
    return resp.Form(result).Build()
}

// å†…éƒ¨å·¥å…·å‡½æ•° - å®ç°ç»†èŠ‚ï¼Œæ˜“å˜
func sanitizeCourseName(name string) string {
    return strings.TrimSpace(name)
}
```

### **ä¿¡æ¯è¿‡è½½çš„å±å®³**

**åæœ**ï¼š
- ğŸ“‰ **ä¿¡æ¯ç¨€é‡Š**ï¼šæœ‰ä»·å€¼çš„æ¥å£è¢«å¤§é‡å¹³åº¸æ¥å£ç¨€é‡Š
- ğŸ” **æ£€ç´¢å›°éš¾**ï¼šAIæ£€ç´¢æ—¶éš¾ä»¥æ‰¾åˆ°çœŸæ­£æœ‰ç”¨çš„æ¥å£
- ğŸ“š **ç»´æŠ¤è´Ÿæ‹…**ï¼šå¤§é‡æ— ä»·å€¼æ–‡æ¡£éœ€è¦ç»´æŠ¤
- ğŸ§  **è®¤çŸ¥è¿‡è½½**ï¼šå¼€å‘è€…éš¾ä»¥å¿«é€Ÿè¯†åˆ«æ ¸å¿ƒæ¥å£

### **æ¸è¿›å¼æš´éœ²ç­–ç•¥**

#### **é˜¶æ®µ1ï¼šä¿å®ˆæš´éœ²ï¼ˆæ¨èèµ·ç‚¹ï¼‰**
```
åŸåˆ™ï¼šå®å¯å°‘æš´éœ²ï¼Œä¸å¯å¤šæš´éœ²
ç­–ç•¥ï¼šåªæš´éœ²æœ€æ ¸å¿ƒçš„ä¸šåŠ¡å‡½æ•°å’Œæ•°æ®æ¨¡å‹
å¥½å¤„ï¼šç¡®ä¿æ¯ä¸ªæš´éœ²çš„æ¥å£éƒ½æœ‰é«˜ä»·å€¼
```

#### **é˜¶æ®µ2ï¼šæŒ‰éœ€æ‰©å±•**
```
æ ¹æ®ä½¿ç”¨åé¦ˆè°ƒæ•´ï¼š
- è§‚å¯Ÿå“ªäº›å†…éƒ¨å‡½æ•°è¢«é¢‘ç¹è·¨æ¨¡å—è°ƒç”¨
- å°†éªŒè¯æœ‰ä»·å€¼çš„å‡½æ•°æå‡ä¸ºæš´éœ²æ¥å£
- ç§»é™¤ä¸å†ä½¿ç”¨çš„æš´éœ²æ¥å£
```

### **æš´éœ²è¾¹ç•Œæ£€æŸ¥æ¸…å•**

#### **æš´éœ²å‰æ£€æŸ¥**
- [ ] å‡½æ•°æ˜¯å¦æœ‰æ˜ç¡®çš„ä¸šåŠ¡è¯­ä¹‰ï¼Ÿ
- [ ] å‡½æ•°æ˜¯å¦ä¼šè¢«è·¨æ–‡ä»¶/è·¨åŒ…è°ƒç”¨ï¼Ÿ
- [ ] å‡½æ•°çš„æ¥å£æ˜¯å¦ç›¸å¯¹ç¨³å®šï¼Ÿ
- [ ] å‡½æ•°æ˜¯å¦ä»£è¡¨å¯å¤ç”¨çš„ä¸šåŠ¡æŠ½è±¡ï¼Ÿ
- [ ] ç»´æŠ¤è¿™ä¸ªå‡½æ•°çš„rag-apiæ–‡æ¡£ROIæ˜¯å¦ä¸ºæ­£ï¼Ÿ

## ğŸ¯ SFTè®­ç»ƒä»·å€¼

è¿™ä¸ªæ¨¡æ¿ä½“ç°äº†ï¼š
- **AIæ—¶ä»£çš„æ–‡æ¡£æ–°èŒƒå¼**ï¼šrag-apiæ ‡ç­¾ä¸ºAIæ£€ç´¢å¢å¼ºè€Œè®¾è®¡
- **å®Œæ•´çš„ä¸šåŠ¡é—­ç¯**ï¼šä»æ•°æ®æ¨¡å‹åˆ°ä¸šåŠ¡é€»è¾‘åˆ°å‰ç«¯äº¤äº’
- **ç»éªŒæ²‰æ·€**ï¼šæ¯ä¸ªrag-apiæ ‡ç­¾éƒ½åŒ…å«ä½¿ç”¨ç»éªŒå’Œæœ€ä½³å®è·µ
- **ç”Ÿæ€æ€ç»´**ï¼šä¸ä»…å…³å¿ƒåŠŸèƒ½å®ç°ï¼Œæ›´å…³å¿ƒå¦‚ä½•è¢«æ›´å¥½åœ°ä½¿ç”¨
- **è¾¹ç•Œæ§åˆ¶**ï¼šé€šè¿‡æš´éœ²è¾¹ç•Œæ§åˆ¶ç¡®ä¿ä¿¡æ¯è´¨é‡å’Œæ£€ç´¢æ•ˆç‡

## âš¡ æç®€åŸåˆ™ç¡®è®¤

**æœ€ç»ˆå†³ç­–ï¼šé‡‡ç”¨æç®€æ–¹æ¡ˆ**
- âŒ **æ‹’ç»åŒ…çº§æ¦‚è§ˆ**ï¼šé¿å…ä¿¡æ¯é‡å¤å’Œç»´æŠ¤è´Ÿæ‹…
- âœ… **ç›´æ¥ç²¾å‡†æè¿°**ï¼šæ¯ä¸ªrag-apiæ ‡ç­¾éƒ½æœ‰ç‹¬ç‰¹ä»·å€¼
- âœ… **å¤§é“è‡³ç®€**ï¼šå»æ‰åºŸè¯ï¼Œçªå‡ºæ ¸å¿ƒä¸šåŠ¡ä»·å€¼
- âœ… **å°±è¿‘ç»´æŠ¤**ï¼šä»£ç å³æ–‡æ¡£ï¼Œä¿®æ”¹æ—¶æ³¨é‡Šå°±åœ¨çœ¼å‰

**ç¤ºä¾‹ï¼šæ­£ç¡®çš„æç®€æ–¹å¼**
```go
// <rag-api>
// FFmpegè·¯å¾„è§£æå™¨ï¼šæŒ‰ä¼˜å…ˆçº§è·å–å¯ç”¨è·¯å¾„ï¼ˆDBâ†’æœ¬åœ°â†’PATHï¼‰
func videoFfmpegResolveFFmpeg(ctx *runner.Context) (installPath string, err error)
// </rag-api>

// <rag-api>
// å­¦ç”Ÿé€‰è¯¾ï¼šå¤šé€‰è¯¾ç¨‹å®æ—¶è®¡ç®—å­¦åˆ†ï¼Œçº¯ä¸šåŠ¡é€»è¾‘å¯è·¨æ¨¡å—å¤ç”¨
func SchoolCourseSelectBusiness(ctx *runner.Context, req *SchoolCourseSelectReq) (*SchoolCourseSelectResp, error)
// </rag-api>
```

**æ ¸å¿ƒåŸåˆ™ï¼šæ¯ä¸ªrag-apiæ ‡ç­¾éƒ½ç›´æ¥ã€ç²¾å‡†ã€æœ‰ç‹¬ç‰¹ä»·å€¼ã€‚å®å¯å°‘æš´éœ²ä¹Ÿä¸è¦ä¿¡æ¯è¿‡è½½ï¼**

**ç”¨è¿™ä¸ªæç®€æ¨¡æ¿æ„é€ çš„SFTæ•°æ®ï¼Œå°†å¸®åŠ©AIç”Ÿæˆæ›´é«˜è´¨é‡ã€æ›´å®ç”¨çš„ä»£ç ï¼** ğŸš€