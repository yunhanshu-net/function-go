---
description: OnInputFuzzyå›è°ƒä¸­Statisticsèšåˆè®¡ç®—çš„ä½¿ç”¨è§„èŒƒå’Œå¸¸è§åœºæ™¯ï¼ŒåŒ…å«æ­£ç¡®ç”¨æ³•å’Œç¦æ­¢ç¤ºä¾‹
globs:
alwaysApply: true
---

# OnInputFuzzyèšåˆè®¡ç®—ä½¿ç”¨è§„èŒƒ

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

**Statistics**ï¼šåœ¨OnInputFuzzyå›è°ƒä¸­æä¾›**å‰ç«¯å®æ—¶èšåˆè®¡ç®—**å’Œä¿¡æ¯å±•ç¤ºçš„åŠŸèƒ½ã€‚

**å·¥ä½œåŸç†**ï¼š
- ç”¨æˆ·åœ¨å‰ç«¯é€‰æ‹©å•†å“æ—¶ï¼Œå‰ç«¯å®æ—¶è®¡ç®—å¹¶å±•ç¤ºç»Ÿè®¡ä¿¡æ¯
- **å…³é”®**ï¼šèšåˆè®¡ç®—åŸºäº**ç”¨æˆ·å½“å‰é€‰æ‹©çš„æ•°æ®**ï¼Œä¸æ˜¯åç«¯æ•°æ®åº“çš„å…¨é‡ç»Ÿè®¡
- ä¾‹å¦‚ï¼šç”¨æˆ·é€‰æ‹©3ä¸ªå•†å“ï¼Œ`count(ä»·æ ¼)`æ˜¾ç¤º3ï¼Œä¸æ˜¯æ•°æ®åº“ä¸­æ‰€æœ‰å•†å“æ•°é‡
- å¸®åŠ©ç”¨æˆ·åœ¨å¡«å†™è¡¨å•è¿‡ç¨‹ä¸­å®æ—¶äº†è§£é€‰æ‹©ç»“æœ

**å‰ç«¯èšåˆ vs åç«¯ç»Ÿè®¡**ï¼š
- **å‰ç«¯èšåˆ**ï¼š`count(ä»·æ ¼)` = ç”¨æˆ·é€‰æ‹©çš„å•†å“æ•°é‡ï¼ˆå®æ—¶å˜åŒ–ï¼‰
- **åç«¯ç»Ÿè®¡**ï¼šéœ€è¦åç«¯æŸ¥è¯¢æ•°æ®åº“å¹¶è¿”å›ç»Ÿè®¡ç»“æœï¼ˆç›¸å¯¹å›ºå®šï¼‰
- **å•é€‰åœºæ™¯**ï¼šå‰ç«¯èšåˆæ°¸è¿œæ˜¯1ï¼Œæ¯«æ— æ„ä¹‰ï¼›åº”ä½¿ç”¨é™æ€ä¿¡æ¯

**å…³é”®åŸåˆ™**ï¼š
- **æœ‰æ•°ç»„æ‰èšåˆ**ï¼šåªæœ‰Listå†…å­—æ®µ/å¤šé€‰åœºæ™¯æ‰åšçœŸæ­£çš„èšåˆè®¡ç®—
- **æ— æ•°ç»„åªå±•ç¤º**ï¼šå•é€‰/Formå†…åœºæ™¯åªè¿”å›æœ‰ç”¨çš„é™æ€ä¿¡æ¯
- **ç”¨æˆ·ä»·å€¼å¯¼å‘**ï¼šæ¯ä¸ªç»Ÿè®¡ä¿¡æ¯éƒ½è¦å¯¹ç”¨æˆ·æœ‰å®é™…ä»·å€¼
- **ä¿¡æ¯ç²¾ç®€**ï¼š3-5ä¸ªé‡è¦ä¿¡æ¯å³å¯ï¼Œé¿å…ä¿¡æ¯è¿‡è½½

**åˆ¤æ–­æ ‡å‡†**ï¼š

| ç»„ä»¶ç±»å‹ | æ•°æ®ç»“æ„ | ç”¨æˆ·é€‰æ‹© | èšåˆè®¡ç®— | åŸå› è¯´æ˜ |
|---|---|---|---|---|
| `list` å†…çš„ `select` | `int/string` | å¯æ·»åŠ å¤šè¡Œ | âœ… å¯ä»¥èšåˆ | ç”¨æˆ·å¯ä»¥é€‰æ‹©å¤šä¸ªé¡¹ç›® |
| `multiselect` | `[]int/[]string` | å¯é€‰æ‹©å¤šä¸ª | âœ… å¯ä»¥èšåˆ | ç›¸å½“äºListåŠŸèƒ½ |
| `select` | `int/string` | åªèƒ½é€‰æ‹©ä¸€ä¸ª | âŒ ä¸èƒ½èšåˆ | èšåˆç»“æœæ°¸è¿œæ˜¯1 |

## âœ… æ­£ç¡®ä½¿ç”¨åœºæ™¯

### 1. Listç»„ä»¶åœºæ™¯ - çœŸæ­£èšåˆè®¡ç®—ï¼ˆæœ€ä½³å®è·µï¼‰

**å‚è€ƒç¤ºä¾‹**ï¼š`simple_cashier_system.go` ä¸­çš„å®Œæ•´æ”¶é“¶å°ç³»ç»Ÿ

```go
// ================ å®Œæ•´çš„æ•°æ®ç»“æ„å®šä¹‰ ================

// SimpleCashierProductQuantity å•†å“æ•°é‡ç»“æ„ä½“
type SimpleCashierProductQuantity struct {
    ProductID int `json:"product_id" runner:"name:å•†å“" widget:"type:select" validate:"required"`
    Quantity  int `json:"quantity" runner:"name:æ•°é‡" widget:"type:number;min:1" data:"example:1;default_value:1" validate:"required,min=1"`
}

// SimpleCashierCartItem è´­ç‰©è½¦å•†å“
type SimpleCashierCartItem struct {
    ProductID   int     `json:"product_id" runner:"name:å•†å“ID" widget:"type:number"`
    ProductName string  `json:"product_name" runner:"name:å•†å“åç§°" widget:"type:input"`
    Price       float64 `json:"price" runner:"name:å•ä»·" widget:"type:number;precision:2"`
    Quantity    int     `json:"quantity" runner:"name:æ•°é‡" widget:"type:number;min:1"`
    TotalPrice  float64 `json:"total_price" runner:"name:å°è®¡" widget:"type:number;precision:2"`
}

// SimpleCashierDeskReq ç®€åŒ–æ”¶é“¶å°è¯·æ±‚
type SimpleCashierDeskReq struct {
    // å•†å“æ•°é‡åˆ—è¡¨ï¼ˆåªéœ€è¦å•†å“IDå’Œæ•°é‡ï¼‰
    ProductQuantities []SimpleCashierProductQuantity `json:"product_quantities" runner:"name:å•†å“æ¸…å•" widget:"type:list"`
    // ä¼šå‘˜å¡é€‰æ‹©
    MemberId int `json:"member_id" runner:"name:ä¼šå‘˜å¡" widget:"type:select"`
    // å¤‡æ³¨ä¿¡æ¯
    Remarks string `json:"remarks" runner:"name:å¤‡æ³¨" widget:"type:input;mode:text_area"`
}

// SimpleCashierDeskResp ç®€åŒ–æ”¶é“¶å°å“åº”
type SimpleCashierDeskResp struct {
    // æ”¯ä»˜ç»“æœ - æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œç”¨æˆ·ç¬¬ä¸€æ—¶é—´çœ‹åˆ°
    PaymentResult string `json:"payment_result" runner:"name:æ”¯ä»˜ç»“æœ" widget:"type:input;mode:text_area"`
    // è®¢å•ä¿¡æ¯
    OrderNumber string `json:"order_number" runner:"name:è®¢å•å·" widget:"type:input"`
    // ä»·æ ¼ä¿¡æ¯ - é‡è¦ä¿¡æ¯æ”¾å‰é¢
    TotalAmount    float64 `json:"total_amount" runner:"name:å•†å“æ€»é¢" widget:"type:number;precision:2"`
    DiscountAmount float64 `json:"discount_amount" runner:"name:æŠ˜æ‰£é‡‘é¢" widget:"type:number;precision:2"`
    FinalAmount    float64 `json:"final_amount" runner:"name:å®ä»˜é‡‘é¢" widget:"type:number;precision:2"`
    // å•†å“æ¸…å•
    ProductList []SimpleCashierCartItem `json:"product_list" runner:"name:å•†å“æ¸…å•" widget:"type:list"`
    // ä¼šå‘˜ä¿¡æ¯ - è¯¦ç»†ä¿¡æ¯æ”¾æœ€å
    MemberInfo *SimpleCashierMemberCard `json:"member_info" runner:"name:ä¼šå‘˜ä¿¡æ¯" widget:"type:form"`
}

// ================ å®Œæ•´çš„å¤„ç†å‡½æ•° ================

// SimpleCashierDesk ç®€åŒ–æ”¶é“¶å°å¤„ç†å‡½æ•°
func SimpleCashierDesk(ctx *runner.Context, req *SimpleCashierDeskReq, resp response.Response) error {
    db := ctx.MustGetOrInitDB()

    // 1. éªŒè¯ä¼šå‘˜å¡
    if req.MemberId == 0 {
        return resp.Form(&SimpleCashierDeskResp{
            PaymentResult: "è¯·é€‰æ‹©ä¼šå‘˜å¡",
        }).Build()
    }

    var member SimpleCashierMemberCard
    if err := db.Where("id = ?", req.MemberId).First(&member).Error; err != nil {
        return resp.Form(&SimpleCashierDeskResp{
            PaymentResult: "ä¼šå‘˜å¡ä¸å­˜åœ¨",
        }).Build()
    }

    // 2. éªŒè¯å•†å“æ¸…å•
    if len(req.ProductQuantities) == 0 {
        return resp.Form(&SimpleCashierDeskResp{
            PaymentResult: "è¯·é€‰æ‹©å•†å“",
        }).Build()
    }

    // 3. è·å–å•†å“ä¿¡æ¯å¹¶éªŒè¯
    var totalAmount float64
    productList := make([]SimpleCashierCartItem, 0)

    for _, pq := range req.ProductQuantities {
        var product SimpleCashierProduct
        if err := db.Where("id = ?", pq.ProductID).First(&product).Error; err != nil {
            return resp.Form(&SimpleCashierDeskResp{
                PaymentResult: fmt.Sprintf("å•†å“ID %d ä¸å­˜åœ¨", pq.ProductID),
            }).Build()
        }

        // æ£€æŸ¥åº“å­˜
        if product.Stock < pq.Quantity {
            return resp.Form(&SimpleCashierDeskResp{
                PaymentResult: fmt.Sprintf("å•†å“ %s åº“å­˜ä¸è¶³ï¼Œéœ€è¦ %dï¼Œåº“å­˜ %d", product.Name, pq.Quantity, product.Stock),
            }).Build()
        }

        // è®¡ç®—å°è®¡
        itemTotal := SimpleCashierRoundMoney(product.Price * float64(pq.Quantity))
        item := SimpleCashierCartItem{
            ProductID:   pq.ProductID,
            ProductName: product.Name,
            Price:       product.Price,
            Quantity:    pq.Quantity,
            TotalPrice:  itemTotal,
        }
        productList = append(productList, item)
        totalAmount += itemTotal
    }

    // 4. è®¡ç®—ä¼šå‘˜æŠ˜æ‰£ï¼ˆ9æŠ˜ï¼‰
    discountAmount := SimpleCashierRoundMoney(totalAmount * 0.1)
    finalAmount := SimpleCashierRoundMoney(totalAmount - discountAmount)

    // 5. æ£€æŸ¥ä½™é¢
    if member.Balance < finalAmount {
        return resp.Form(&SimpleCashierDeskResp{
            PaymentResult: fmt.Sprintf("ä½™é¢ä¸è¶³ï¼Œéœ€è¦Â¥%.2fï¼Œä½™é¢Â¥%.2f", finalAmount, member.Balance),
        }).Build()
    }

    // 6. å¤„ç†æ”¯ä»˜ï¼ˆäº‹åŠ¡å¤„ç†ï¼‰
    var orderNumber string
    err := db.Transaction(func(tx *gorm.DB) error {
        // ç”Ÿæˆè®¢å•å·
        orderNumber = fmt.Sprintf("ORD%s%d", time.Now().Format("20060102"), time.Now().UnixNano())
        
        // åˆ›å»ºè®¢å•ã€è®¢å•æ˜ç»†ã€æ‰£å‡ä½™é¢ã€æ›´æ–°åº“å­˜ã€è®°å½•æ“ä½œæ—¥å¿—
        // ... å®Œæ•´çš„äº‹åŠ¡å¤„ç†é€»è¾‘
        
        return nil
    })

    if err != nil {
        return resp.Form(&SimpleCashierDeskResp{
            PaymentResult: "æ”¯ä»˜å¤±è´¥: " + err.Error(),
        }).Build()
    }

    return resp.Form(&SimpleCashierDeskResp{
        OrderNumber:    orderNumber,
        ProductList:    productList,
        TotalAmount:    totalAmount,
        DiscountAmount: discountAmount,
        FinalAmount:    finalAmount,
        MemberInfo:     &member,
        PaymentResult:  "æ”¯ä»˜æˆåŠŸï¼",
    }).Build()
}

// ================ å®Œæ•´çš„å‡½æ•°é…ç½® ================

// SimpleCashierDeskOption ç®€åŒ–æ”¶é“¶å°é…ç½®
var SimpleCashierDeskOption = &runner.FormFunctionOptions{
    BaseConfig: runner.BaseConfig{
        EnglishName:  "simple_cashier_desk",
        ChineseName:  "ç®€åŒ–æ”¶é“¶å°",
        ApiDesc:      "å•†å“æœç´¢é€‰æ‹©ã€æ•°é‡è¾“å…¥ã€ä¼šå‘˜å¡æ”¯ä»˜ä¸€ä½“åŒ–æ”¶é“¶ç³»ç»Ÿ",
        Tags:         []string{"æ”¶é“¶ç³»ç»Ÿ", "å•†å“ç®¡ç†", "ä¼šå‘˜æœåŠ¡"},
        Request:      &SimpleCashierDeskReq{},
        Response:     &SimpleCashierDeskResp{},
        CreateTables: []interface{}{&SimpleCashierProduct{}, &SimpleCashierMemberCard{}, &SimpleCashierOrder{}, &SimpleCashierOrderItem{}, &SimpleCashierMemberOperationRecord{}},
        
        Group:        SimpleCashierGroup,
    },

    // ================ å®Œæ•´çš„OnInputFuzzyå›è°ƒ ================
    OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
        "product_id": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
            keyword := fmt.Sprintf("%v", req.Value)
            var products []SimpleCashierProduct

            db := ctx.MustGetOrInitDB()
            db.Where("name LIKE ? OR code LIKE ?", "%"+keyword+"%", "%"+keyword+"%").
                Where("status = ?", "ä¸Šæ¶").
                Where("stock > ?", 0).
                Limit(20).
                Find(&products)

            items := make([]*usercall.InputFuzzyItem, 0)
            for _, p := range products {
                items = append(items, &usercall.InputFuzzyItem{
                    Value: p.ID,
                    Label: fmt.Sprintf("%s - Â¥%.2f (åº“å­˜:%d)", p.Name, p.Price, p.Stock),
                    DisplayInfo: map[string]interface{}{
                        "å•†å“åç§°": p.Name,
                        "ä»·æ ¼":   p.Price,
                        "åº“å­˜":   p.Stock,
                    },
                })
            }

            return &usercall.OnInputFuzzyResp{
                Statistics: map[string]interface{}{
                    // âœ… å‰ç«¯å®æ—¶èšåˆè®¡ç®— - ç”¨æˆ·æ¯æ·»åŠ ä¸€è¡Œå•†å“ï¼Œå‰ç«¯ç«‹å³è®¡ç®—
                    "å•†å“åŸä»·(å…ƒ)": "sum(ä»·æ ¼,*quantity)",      // ç”¨æˆ·é€‰æ‹©çš„æ‰€æœ‰å•†å“æ€»ä»·
                    "ä¼šå‘˜ä»·æ ¼(å…ƒ)": "sum(ä»·æ ¼,*quantity,*0.9)",  // ä¼šå‘˜9æŠ˜åçš„æ€»ä»·
                    "ä¼˜æƒ é‡‘é¢(å…ƒ)": "sum(ä»·æ ¼,*quantity,*0.1)",  // èŠ‚çœçš„é‡‘é¢
                    "å•†å“ç§ç±»": "count(ä»·æ ¼)",                  // é€‰äº†å‡ ç§å•†å“
                    "å•†å“æ€»æ•°": "sum(quantity)",               // å•†å“æ€»æ•°é‡
                    
                    // âœ… æœ‰ç”¨çš„é™æ€ä¿¡æ¯
                    "ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ ",
                    "é…é€è¯´æ˜": "æ»¡99å…ƒåŒ…é‚®",
                },
                Values: items,
            }, nil
        },

        "member_id": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
            keyword := fmt.Sprintf("%v", req.Value)
            var members []SimpleCashierMemberCard

            db := ctx.MustGetOrInitDB()
            db.Where("card_number LIKE ? OR phone LIKE ?", "%"+keyword+"%", "%"+keyword+"%").
                Where("status = ?", "æ­£å¸¸").
                Limit(10).
                Find(&members)

            items := make([]*usercall.InputFuzzyItem, 0)
            for _, m := range members {
                items = append(items, &usercall.InputFuzzyItem{
                    Value: m.ID,
                    Label: fmt.Sprintf("%s - %s (ä½™é¢:Â¥%.2f)", m.CardNumber, m.CustomerName, m.Balance),
                    DisplayInfo: map[string]interface{}{
                        "å¡å·":   m.CardNumber,
                        "å®¢æˆ·å§“å": m.CustomerName,
                        "ä½™é¢":   m.Balance,
                    },
                })
            }

            return &usercall.OnInputFuzzyResp{Values: items}, nil
        },
    },
}

// ================ APIæ³¨å†Œ ================
func init() {
    runner.Post("/form_table_example/simple_cashier_desk", SimpleCashierDesk, SimpleCashierDeskOption)
}

// ç”¨æˆ·ä½“éªŒï¼š
// 1. ç”¨æˆ·æ·»åŠ ï¼šè‹¹æœ Ã— 2ä¸ª â†’ å‰ç«¯æ˜¾ç¤ºï¼šå•†å“åŸä»·: Â¥17.00, ä¼šå‘˜ä»·æ ¼: Â¥15.30
// 2. ç”¨æˆ·å†æ·»åŠ ï¼šé¦™è•‰ Ã— 3ä¸ª â†’ å‰ç«¯å®æ—¶æ›´æ–°ï¼šå•†å“åŸä»·: Â¥37.40, ä¼šå‘˜ä»·æ ¼: Â¥33.66
// 3. ç”¨æˆ·å®æ—¶çœ‹åˆ°è´­ç‰©è½¦æ€»ä»·å˜åŒ–ï¼Œå¸®åŠ©å†³ç­–
// 4. é€‰æ‹©ä¼šå‘˜å¡åï¼Œç³»ç»ŸéªŒè¯ä½™é¢æ˜¯å¦å……è¶³
// 5. ç‚¹å‡»æ”¯ä»˜ï¼Œç³»ç»Ÿå®Œæˆï¼šåˆ›å»ºè®¢å•â†’æ‰£å‡åº“å­˜â†’æ‰£å‡ä½™é¢â†’è®°å½•æ“ä½œæ—¥å¿—
```

### 2. å¤šé€‰åœºæ™¯ - çœŸæ­£èšåˆè®¡ç®—

**ä¸ºä»€ä¹ˆå¯ä»¥èšåˆ**ï¼š`multiselect` ç»„ä»¶å…è®¸ç”¨æˆ·é€‰æ‹©å¤šä¸ªå•†å“ï¼Œå‰ç«¯èšåˆè®¡ç®—æœ‰å®é™…æ„ä¹‰

```go
// ç”¨æˆ·å¯ä»¥å¤šé€‰å•†å“
type MultiProductReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"` // å¤šé€‰ï¼ç”¨æˆ·å¯ä»¥é€‰æ‹©å¤šä¸ªå•†å“
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… å¯¹ç”¨æˆ·æœ‰ä»·å€¼çš„èšåˆè®¡ç®—
                "é€‰ä¸­å•†å“æ•°": "count(ä»·æ ¼)",           // é€‰äº†å‡ ä¸ªå•†å“
                "é€‰ä¸­å•†å“æ€»ä»·": "sum(ä»·æ ¼,*quantity)", // æ€»ä»·æ ¼
                "æœ€ä½å•ä»·": "min(ä»·æ ¼)",              // é€‰ä¸­å•†å“ä¸­æœ€ä¾¿å®œçš„
                "å¹³å‡å•ä»·": "avg(ä»·æ ¼)",              // é€‰ä¸­å•†å“å¹³å‡ä»·æ ¼
                
                // âœ… é™æ€ä¿¡æ¯
                "ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ ",
            },
        }, nil
    },
}
```

### 3. å•é€‰åœºæ™¯ - é™æ€ä¿¡æ¯å±•ç¤º

**ä¸ºä»€ä¹ˆä¸èƒ½èšåˆ**ï¼š`select` ç»„ä»¶åªèƒ½é€‰æ‹©ä¸€ä¸ªå•†å“ï¼Œèšåˆè®¡ç®—æ°¸è¿œæ˜¯1ï¼Œæ¯«æ— æ„ä¹‰

```go
// ç”¨æˆ·åªèƒ½é€‰æ‹©ä¸€ä¸ªå•†å“
type ProductSelectReq struct {
    ProductID int `json:"product_id" widget:"type:select"` // å•é€‰ï¼ç”¨æˆ·åªèƒ½é€‰æ‹©ä¸€ä¸ªå•†å“
    Quantity  int `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_id": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… æœ‰ä»·å€¼çš„é™æ€ä¿¡æ¯ï¼ˆä¸æ˜¯èšåˆï¼‰
                "é…é€æ–¹å¼": "é¡ºä¸°å¿«é€’",
                "ä¿è´¨æœŸ": "12ä¸ªæœˆ",
                "é€€æ¢æ”¿ç­–": "7å¤©æ— ç†ç”±é€€æ¢",
                "å®¢æœç”µè¯": "400-123-4567",
            },
        }, nil
    },
}
```

### 4. éListå¤šé€‰åœºæ™¯ - çœŸæ­£èšåˆè®¡ç®—

**ä¸ºä»€ä¹ˆå¯ä»¥èšåˆ**ï¼š`multiselect` ç»„ä»¶å…è®¸å¤šé€‰ï¼Œç›¸å½“äºListåŠŸèƒ½ï¼Œèšåˆè®¡ç®—æœ‰å®é™…æ„ä¹‰

```go
// æœ€å¤–å±‚å¤šé€‰å•†å“
type AggregationDemoMultiSelectReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"` // å¤šé€‰ï¼ç”¨æˆ·å¯ä»¥é€‰æ‹©å¤šä¸ªå•†å“
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… å¤šé€‰èšåˆè®¡ç®—
                "é€‰ä¸­å•†å“æ€»ä»·": "sum(ä»·æ ¼,*quantity)",
                "å•†å“ç§ç±»æ•°": "count(ä»·æ ¼)",
                "æœ€ä½å•ä»·": "min(ä»·æ ¼)",
                "æœ€é«˜å•ä»·": "max(ä»·æ ¼)",
                
                // âœ… é™æ€ä¿¡æ¯
                "æ‰¹å‘ä¼˜æƒ ": "æ»¡10ä»¶8æŠ˜",
                "é…é€è¯´æ˜": "å…¨å›½åŒ…é‚®",
            },
        }, nil
    },
}
```

### 5. Formå†…åµŒå¥—åœºæ™¯ - åŠ¨æ€ä¿¡æ¯è¿”å›

**ä¸ºä»€ä¹ˆä¸èƒ½èšåˆ**ï¼šFormå†…çš„å•é€‰å­—æ®µï¼Œç”¨æˆ·åªèƒ½é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼Œèšåˆæ— æ„ä¹‰ï¼Œåªèƒ½è¿”å›åŠ¨æ€ä¿¡æ¯

```go
// Formå†…åµŒå¥—é€‰æ‹© - æ¸¸æˆé…ç½®ç¤ºä¾‹
type AggregationDemoStructSingleSelectReq struct {
    GameConfig AggregationDemoStructSingleSelectConfig `json:"game_config" widget:"type:form"`
    ConfigBonus int `json:"config_bonus" widget:"type:number"`
}

type AggregationDemoStructSingleSelectConfig struct {
    Theme      string `json:"theme" widget:"type:select"`      // å•é€‰ï¼åªèƒ½é€‰ä¸€ä¸ªä¸»é¢˜
    Language   string `json:"language" widget:"type:select"`   // å•é€‰ï¼åªèƒ½é€‰ä¸€ä¸ªè¯­è¨€
    Difficulty string `json:"difficulty" widget:"type:select"` // å•é€‰ï¼åªèƒ½é€‰ä¸€ä¸ªéš¾åº¦
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "theme": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… æœ‰ç”¨çš„åŠ¨æ€ä¿¡æ¯
                "ä¸»é¢˜ç‰¹è‰²": "ç§‘å¹»é£æ ¼ç•Œé¢",
                "å…¼å®¹æ€§": "æ”¯æŒæ‰€æœ‰è®¾å¤‡",
                "æ¨èæŒ‡æ•°": "â˜…â˜…â˜…â˜…â˜…",
            },
        }, nil
    },
    "language": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… è¯­è¨€ç›¸å…³ä¿¡æ¯
                "è¯­è¨€åŒ…å¤§å°": "15MB",
                "æ”¯æŒè¯­éŸ³": "æ˜¯",
                "æ›´æ–°é¢‘ç‡": "æ¯æœˆæ›´æ–°",
            },
        }, nil
    },
}
```

### 6. Formå†…åµŒå¥—å¤šé€‰åœºæ™¯ - çœŸæ­£èšåˆè®¡ç®—

**ä¸ºä»€ä¹ˆå¯ä»¥èšåˆ**ï¼šFormå†…çš„å¤šé€‰å­—æ®µï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©å¤šä¸ªé€‰é¡¹ï¼Œèšåˆè®¡ç®—æœ‰å®é™…æ„ä¹‰

```go
// Formå†…åµŒå¥—å¤šé€‰ - ç”¨æˆ·åå¥½é…ç½®
type AggregationDemoStructMultiSelectReq struct {
    UserProfile AggregationDemoStructMultiSelectProfile `json:"user_profile" widget:"type:form"`
    ProfileScore int `json:"profile_score" widget:"type:number"`
}

type AggregationDemoStructMultiSelectProfile struct {
    Relationship        []string `json:"relationship" widget:"type:multiselect"`        // å¤šé€‰ï¼å¯ä»¥é€‰æ‹©å¤šä¸ªå…³ç³»ç±»å‹
    Preferences         []string `json:"preferences" widget:"type:multiselect"`         // å¤šé€‰ï¼å¯ä»¥é€‰æ‹©å¤šä¸ªåå¥½
    RecommendedProducts []int    `json:"recommended_products" widget:"type:multiselect"` // å¤šé€‰ï¼å¯ä»¥é€‰æ‹©å¤šä¸ªæ¨èå•†å“
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "relationship": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… å…³ç³»ç±»å‹èšåˆ
                "é€‰æ‹©æ•°é‡": "count(å…³ç³»ç±»å‹)",
                "æ¨èæ´»åŠ¨": "æ ¹æ®å…³ç³»æ¨èç›¸åº”æ´»åŠ¨",
                "ä¼˜æƒ æ”¿ç­–": "å¤šé€‰äº«æ›´å¤šä¼˜æƒ ",
            },
        }, nil
    },
    "recommended_products": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… å•†å“æ¨èèšåˆ
                "æ¨èå•†å“æ•°": "count(ä»·æ ¼)",
                "æ€»ä»·å€¼": "sum(ä»·æ ¼)",
                "å¹³å‡ä»·æ ¼": "avg(ä»·æ ¼)",
                "ä»·æ ¼åŒºé—´": "min(ä»·æ ¼) - max(ä»·æ ¼)",
                
                // âœ… é™æ€ä¿¡æ¯
                "æ¨èç†ç”±": "åŸºäºç”¨æˆ·ç”»åƒæ™ºèƒ½æ¨è",
            },
        }, nil
    },
}
```

### 7. Listç»„ä»¶å¤šé€‰åœºæ™¯ - çœŸæ­£èšåˆè®¡ç®—

**ä¸ºä»€ä¹ˆå¯ä»¥èšåˆ**ï¼šListç»„ä»¶å†…çš„å¤šé€‰å­—æ®µï¼Œç”¨æˆ·å¯ä»¥æ·»åŠ å¤šè¡Œä¸”æ¯è¡Œå¯ä»¥å¤šé€‰ï¼ŒåŒé‡èšåˆè®¡ç®—

```go
// Listç»„ä»¶å¤šé€‰ - æ‰¹é‡å•†å“é€‰æ‹©
type AggregationDemoListMultiSelectReq struct {
    MultiSelectItems []AggregationDemoProductMultiSelect `json:"multi_select_items" widget:"type:list"` // Listï¼ç”¨æˆ·å¯ä»¥æ·»åŠ å¤šè¡Œ
    Remarks string `json:"remarks" widget:"type:input;mode:text_area"`
}

type AggregationDemoProductMultiSelect struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"` // å¤šé€‰ï¼æ¯è¡Œå¯ä»¥é€‰æ‹©å¤šä¸ªå•†å“
    Quantity   int   `json:"quantity" widget:"type:number" data:"default_value:1"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… Listå†…å¤šé€‰èšåˆè®¡ç®—
                "é€‰ä¸­å•†å“æ•°": "count(ä»·æ ¼)",
                "æ‰¹é‡æ€»ä»·": "sum(ä»·æ ¼,*quantity)",
                "æ‰¹é‡æ€»é‡": "sum(é‡é‡,*quantity)",
                "ä»·æ ¼åŒºé—´": "min(ä»·æ ¼) - max(ä»·æ ¼)",
                
                // âœ… é™æ€ä¿¡æ¯
                "æ‰¹å‘ä¼˜æƒ ": "æ»¡50ä»¶äº«8æŠ˜",
                "é…é€è¯´æ˜": "æ‰¹é‡è®¢å•åŒ…é‚®",
            },
        }, nil
    },
}
```

### 8. æ¡ä»¶å±•ç¤ºåœºæ™¯ - åŸºäºæœç´¢çš„åŠ¨æ€ä¿¡æ¯

**ä¸ºä»€ä¹ˆä¸èƒ½èšåˆ**ï¼šåŸºäºæœç´¢å…³é”®è¯çš„å•é€‰å­—æ®µï¼Œèšåˆæ— æ„ä¹‰ï¼Œåªèƒ½è¿”å›åŠ¨æ€ä¿¡æ¯

```go
// æ¡ä»¶å±•ç¤º - åŸºäºæœç´¢å…³é”®è¯çš„ä¿¡æ¯å±•ç¤º
type ConditionalDisplayReq struct {
    ProductSearch string `json:"product_search" widget:"type:select"` // å•é€‰ï¼åŸºäºæœç´¢çš„é€‰æ‹©
    Category      string `json:"category" widget:"type:select"`       // å•é€‰ï¼åˆ†ç±»é€‰æ‹©
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_search": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
        keyword := fmt.Sprintf("%v", req.Value)
        
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… åŸºäºæœç´¢å…³é”®è¯çš„åŠ¨æ€ä¿¡æ¯
                "æœç´¢å…³é”®è¯": keyword,
                "åŒ¹é…å•†å“æ•°": "æ ¹æ®å…³é”®è¯åŒ¹é…åˆ°çš„å•†å“æ•°é‡",
                "æ¨èåˆ†ç±»": "æ ¹æ®æœç´¢æ¨èçš„åˆ†ç±»",
                "çƒ­é—¨ç¨‹åº¦": "è¯¥å…³é”®è¯çš„æœç´¢çƒ­åº¦",
                
                // âœ… é™æ€ä¸šåŠ¡ä¿¡æ¯
                "æœç´¢å»ºè®®": "å¯å°è¯•ç›¸å…³å…³é”®è¯",
                "å®¢æœçƒ­çº¿": "400-123-4567",
            },
        }, nil
    },
}
```

## âŒ ç¦æ­¢çš„é”™è¯¯ç”¨æ³•

### ğŸš« é”™è¯¯1ï¼šå•é€‰åœºæ™¯å¼ºè¡Œèšåˆ

```go
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šå•é€‰å•†å“å´æ˜¾ç¤ºèšåˆç»Ÿè®¡
type WrongSingleSelectReq struct {
    ProductID int `json:"product_id" widget:"type:select"`  // åªèƒ½é€‰ä¸€ä¸ªå•†å“
    Quantity  int `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_id": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âŒ å‰ç«¯èšåˆè®¡ç®—æ¯«æ— æ„ä¹‰
                "å•†å“æ€»æ•°": "count(ä»·æ ¼)",      // æ°¸è¿œæ˜¾ç¤º1ï¼Œç”¨æˆ·ä¼šè¯¯ä»¥ä¸ºç³»ç»Ÿåªæœ‰1ä¸ªå•†å“
                "æœ€ä½ä»·æ ¼": "min(ä»·æ ¼)",       // æ°¸è¿œæ˜¯ç”¨æˆ·é€‰çš„å•†å“ä»·æ ¼ï¼Œæ¯«æ— å‚è€ƒä»·å€¼
                "æœ€é«˜ä»·æ ¼": "max(ä»·æ ¼)",       // æ°¸è¿œæ˜¯ç”¨æˆ·é€‰çš„å•†å“ä»·æ ¼ï¼Œæ¯«æ— å‚è€ƒä»·å€¼
                "å¹³å‡ä»·æ ¼": "avg(ä»·æ ¼)",       // æ°¸è¿œæ˜¯ç”¨æˆ·é€‰çš„å•†å“ä»·æ ¼ï¼Œæ¯«æ— å‚è€ƒä»·å€¼
            },
        }, nil
    },
}

// ç”¨æˆ·ä½“éªŒé—®é¢˜ï¼š
// ç”¨æˆ·é€‰æ‹©"è‹¹æœ Â¥8.5" â†’ å‰ç«¯æ˜¾ç¤ºï¼šå•†å“æ€»æ•°: 1, æœ€ä½ä»·æ ¼: Â¥8.5, æœ€é«˜ä»·æ ¼: Â¥8.5, å¹³å‡ä»·æ ¼: Â¥8.5
// ç”¨æˆ·å›°æƒ‘ï¼šç³»ç»Ÿå°±è¿™ä¸€ä¸ªå•†å“å—ï¼Ÿä¸ºä»€ä¹ˆæœ€ä½æœ€é«˜å¹³å‡éƒ½ä¸€æ ·ï¼Ÿè¿™äº›ä¿¡æ¯å®Œå…¨æ²¡æœ‰ä»·å€¼ï¼

// âœ… æ­£ç¡®åšæ³•ï¼šæä¾›æœ‰ç”¨çš„é™æ€ä¿¡æ¯
type CorrectSingleSelectReq struct {
    ProductID int `json:"product_id" widget:"type:select"`  // åªèƒ½é€‰ä¸€ä¸ªå•†å“
    Quantity  int `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_id": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                "é…é€æ–¹å¼": "é¡ºä¸°å¿«é€’",
                "ä¿è´¨æœŸ": "12ä¸ªæœˆ", 
                "ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ ",
            },
        }, nil
    },
}
```

### ğŸš« é”™è¯¯2ï¼šè¯•å›¾è·å–è¡¨å•å…¶ä»–å­—æ®µå€¼

```go
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šå›è°ƒæ‰§è¡Œæ—¶æ— æ³•è·å–è¡¨å•å…¶ä»–å­—æ®µ
type WrongFieldAccessReq struct {
    ProductIDs []int  `json:"product_ids" widget:"type:multiselect"`
    OrderType  string `json:"order_type" widget:"type:select"`     // å…¶ä»–è¡¨å•å­—æ®µ
    UserLevel  string `json:"user_level" widget:"type:select"`     // å…¶ä»–è¡¨å•å­—æ®µ
    Quantity   int    `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
        // âŒ å›è°ƒæ‰§è¡Œæ—¶ç”¨æˆ·è¿˜æ²¡å¡«å†™è¡¨å•ï¼Œè·å–ä¸åˆ°å…¶ä»–å­—æ®µ
        orderType := getOrderTypeFromForm() // ä¸å­˜åœ¨çš„å‡½æ•°ï¼
        userLevel := getUserLevel()         // è·å–ä¸åˆ°ï¼
        
        // âŒ åŸºäºä¸å­˜åœ¨çš„æ•°æ®åšæ¡ä»¶åˆ¤æ–­
        if orderType == "æ‰¹å‘" {
            return &usercall.OnInputFuzzyResp{
                Statistics: map[string]interface{}{
                    "æ‰¹å‘ä¼˜æƒ ": "æ»¡100ä»¶8æŠ˜",
                },
            }, nil
        }
        
        return nil, nil
    },
}

// âœ… æ­£ç¡®ï¼šåªèƒ½è¿”å›é™æ€ä¿¡æ¯æˆ–åŸºäºæœç´¢å…³é”®è¯çš„ä¿¡æ¯
type CorrectFieldAccessReq struct {
    ProductIDs []int  `json:"product_ids" widget:"type:multiselect"`
    OrderType  string `json:"order_type" widget:"type:select"`
    UserLevel  string `json:"user_level" widget:"type:select"`
    Quantity   int    `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
        keyword := fmt.Sprintf("%v", req.Value)
        
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                "æ‰¹å‘ä¼˜æƒ ": "æ»¡100ä»¶8æŠ˜",  // é™æ€ä¸šåŠ¡è§„åˆ™
                "é›¶å”®ä¼˜æƒ ": "æ»¡99å…ƒåŒ…é‚®", // é™æ€ä¸šåŠ¡è§„åˆ™
                "æœç´¢å…³é”®è¯": keyword,   // å¯ä»¥æ˜¾ç¤ºæœç´¢å…³é”®è¯
            },
        }, nil
    },
}
```

### ğŸš« é”™è¯¯3ï¼šä¿¡æ¯è¿‡è½½

```go
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šä¿¡æ¯å¤ªå¤šï¼Œç”¨æˆ·çœ‹ä¸è¿‡æ¥
type WrongOverloadReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"`
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âŒ ä¿¡æ¯è¿‡è½½ï¼Œç”¨æˆ·æ ¹æœ¬çœ‹ä¸è¿‡æ¥
                "å•†å“æ€»æ•°": "count(ä»·æ ¼)",
                "æœ€ä½ä»·æ ¼": "min(ä»·æ ¼)",
                "æœ€é«˜ä»·æ ¼": "max(ä»·æ ¼)",
                "å¹³å‡ä»·æ ¼": "avg(ä»·æ ¼)",
                "ä»·æ ¼æ€»å’Œ": "sum(ä»·æ ¼)",
                "æ€»é‡é‡": "sum(é‡é‡)",
                "å¹³å‡é‡é‡": "avg(é‡é‡)",
                "æœ€è½»é‡é‡": "min(é‡é‡)",
                "æœ€é‡é‡é‡": "max(é‡é‡)",
                "æ€»åº“å­˜": "sum(åº“å­˜)",
                "å¹³å‡åº“å­˜": "avg(åº“å­˜)",
                "æœ€ä½åº“å­˜": "min(åº“å­˜)",
                "æœ€é«˜åº“å­˜": "max(åº“å­˜)",
                "é…é€æ–¹å¼": "é¡ºä¸°å¿«é€’",
                "ä¿è´¨æœŸ": "12ä¸ªæœˆ",
                "å®¢æœç”µè¯": "400-123-4567",
                "è¥ä¸šæ—¶é—´": "9:00-22:00",
                "é€€æ¢æ”¿ç­–": "7å¤©æ— ç†ç”±é€€æ¢",
                "ç§¯åˆ†æ”¿ç­–": "æ¶ˆè´¹1å…ƒå¾—1ç§¯åˆ†",
                // ... è¿˜æœ‰æ›´å¤šï¼Œç”¨æˆ·æ ¹æœ¬çœ‹ä¸å®Œ
            },
        }, nil
    },
}

// âœ… æ­£ç¡®ï¼šç²¾é€‰3-5ä¸ªæœ€é‡è¦çš„ä¿¡æ¯
type CorrectConciseReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"`
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                "é€‰ä¸­å•†å“æ€»ä»·": "sum(ä»·æ ¼,*quantity)",
                "ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ ",
                "é…é€æ–¹å¼": "é¡ºä¸°å¿«é€’",
                "æ»¡å‡æ´»åŠ¨": "æ»¡100å‡10",
            },
        }, nil
    },
}
```

### ğŸš« é”™è¯¯4ï¼šæ— æ„ä¹‰çš„æŠ€æœ¯ç‚«æŠ€

```go
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šä¸ºäº†å±•ç¤ºèšåˆå‡½æ•°è€Œå¼ºè¡Œä½¿ç”¨
type WrongTechShowOffReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"`
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âŒ ä¸ºäº†æŠ€æœ¯ç‚«æŠ€è€Œå¼ºè¡Œä½¿ç”¨å¤æ‚åŠŸèƒ½
                "ä»·æ ¼æ–¹å·®": "variance(ä»·æ ¼)",        // ä¸æ”¯æŒä¸”æ— æ„ä¹‰
                "ä»·æ ¼æ ‡å‡†å·®": "stddev(ä»·æ ¼)",        // ä¸æ”¯æŒä¸”æ— æ„ä¹‰
                "ä¸­ä½æ•°": "median(ä»·æ ¼)",            // ä¸æ”¯æŒä¸”æ— æ„ä¹‰
                "å¤æ‚å…¬å¼": "sum(ä»·æ ¼,*quantity,*0.9,*1.1,*0.8)", // è¿‡äºå¤æ‚ï¼Œç”¨æˆ·çœ‹ä¸æ‡‚
                "é«˜çº§ç»Ÿè®¡": "percentile(ä»·æ ¼,95)",   // ä¸æ”¯æŒçš„å‡½æ•°
            },
        }, nil
    },
}

// âœ… æ­£ç¡®ï¼šç®€å•æœ‰ç”¨çš„ä¿¡æ¯
type CorrectSimpleReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"`
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                "ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ ",
                "æ»¡å‡æ´»åŠ¨": "æ»¡100å‡10",
                "é…é€è¯´æ˜": "å…¨å›½åŒ…é‚®",
            },
        }, nil
    },
}
```

### ğŸš« é”™è¯¯5ï¼šä¸æ”¯æŒçš„æ¡ä»¶èšåˆ

```go
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šä½¿ç”¨ä¸æ”¯æŒçš„ifæ¡ä»¶
type WrongConditionalReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"`
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âŒ ä¸æ”¯æŒifæ¡ä»¶è¯­æ³•
                "æ°´æœæ•°é‡": "count(ä»·æ ¼, if(åˆ†ç±»=='æ°´æœ',1,0))", // âŒ ä¸æ”¯æŒifæ¡ä»¶
                "è´µå•†å“æ•°": "count(ä»·æ ¼, if(ä»·æ ¼>10,1,0))",   // âŒ ä¸æ”¯æŒifæ¡ä»¶
                "æŠ˜æ‰£å•†å“": "sum(ä»·æ ¼, if(ä»·æ ¼>50,0.8,1))",  // âŒ ä¸æ”¯æŒifæ¡ä»¶
            },
        }, nil
    },
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ”¯æŒçš„èšåˆå‡½æ•°
type CorrectAggregationReq struct {
    ProductIDs []int `json:"product_ids" widget:"type:multiselect"`
    Quantity   int   `json:"quantity" widget:"type:number"`
}

OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_ids": func(...) (*usercall.OnInputFuzzyResp, error) {
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                "é€‰ä¸­å•†å“æ•°": "count(ä»·æ ¼)",
                "å•†å“æ€»ä»·": "sum(ä»·æ ¼,*quantity)",
                "å¹³å‡ä»·æ ¼": "avg(ä»·æ ¼)",
                "æœ€ä½ä»·æ ¼": "min(ä»·æ ¼)",
                "æœ€é«˜ä»·æ ¼": "max(ä»·æ ¼)",
            },
        }, nil
    },
}
```

## ğŸ“‹ æ”¯æŒçš„èšåˆå‡½æ•°

### åŸºç¡€èšåˆå‡½æ•°
- `sum(å­—æ®µå)` - æ±‚å’Œ
- `avg(å­—æ®µå)` - å¹³å‡å€¼
- `min(å­—æ®µå)` - æœ€å°å€¼
- `max(å­—æ®µå)` - æœ€å¤§å€¼
- `count(å­—æ®µå)` - è®¡æ•°

### ä¹˜æ³•è¿ç®—
- `sum(å­—æ®µå,*å˜é‡å)` - å­—æ®µå€¼ä¹˜ä»¥å˜é‡åæ±‚å’Œ
- `sum(å­—æ®µå,*å˜é‡å,*ç³»æ•°)` - å­—æ®µå€¼ä¹˜ä»¥å˜é‡å’Œç³»æ•°åæ±‚å’Œ

### åŠ¨æ€æ–‡æœ¬èšåˆå‡½æ•° â­ æ–°åŠŸèƒ½
- `text(å­—æ®µå)` - åŠ¨æ€å±•ç¤ºé€‰ä¸­itemçš„æ–‡æœ¬ä¿¡æ¯ï¼Œæ”¯æŒå‰ç«¯äº¤äº’

**é‡è¦**ï¼šå˜é‡æ¥è‡ªå½“å‰è¯·æ±‚ç»“æ„ä½“çš„åŒçº§å­—æ®µï¼Œä¸æ˜¯DisplayInfoä¸­çš„å­—æ®µã€‚

### é™æ€ä¿¡æ¯
ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²å€¼ï¼Œä¸éœ€è¦èšåˆå‡½æ•°ï¼š
```go
"ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ ",
"é…é€è¯´æ˜": "å…¨å›½åŒ…é‚®",
```

## ğŸ¯ åˆ¤æ–­æ ‡å‡†

**ä½¿ç”¨Statisticså‰é—®è‡ªå·±**ï¼š
1. ç”¨æˆ·çœ‹åˆ°è¿™ä¸ªç»Ÿè®¡ä¿¡æ¯åï¼Œèƒ½å¸®åŠ©ä»–åšå‡ºæ›´å¥½çš„å†³ç­–å—ï¼Ÿ
2. è¿™ä¸ªä¿¡æ¯å¯¹å½“å‰çš„ä¸šåŠ¡åœºæ™¯æœ‰å®é™…ä»·å€¼å—ï¼Ÿ
3. ä¿¡æ¯æ•°é‡æ˜¯å¦é€‚ä¸­ï¼ˆ3-5ä¸ªï¼‰ï¼Ÿ

**è®°ä½**ï¼šStatisticsè¦ä¹ˆæä¾›æœ‰ä»·å€¼çš„èšåˆè®¡ç®—ï¼Œè¦ä¹ˆæä¾›æœ‰ç”¨çš„ä¸šåŠ¡ä¿¡æ¯ï¼Œç»ä¸ä¸ºäº†æŠ€æœ¯å±•ç¤ºè€Œå¼ºè¡Œä½¿ç”¨ã€‚

## ğŸ†• text() èšåˆå‡½æ•°è¯¦è§£

### ğŸ¯ æ ¸å¿ƒä»·å€¼
`text()` å‡½æ•°è§£å†³äº†ä¼ ç»Ÿèšåˆå‡½æ•°çš„å±€é™æ€§ï¼Œè®©å‰ç«¯èƒ½å¤ŸåŠ¨æ€å±•ç¤ºé€‰ä¸­itemçš„è¯¦ç»†ä¿¡æ¯ï¼Œå®ç°çœŸæ­£çš„äº¤äº’å¼æ•°æ®å±•ç¤ºã€‚

### ğŸ”§ å·¥ä½œåŸç†
- **è§¦å‘æ—¶æœº**ï¼šç”¨æˆ·é€‰æ‹©æŸä¸ªitemå
- **æ•°æ®æ¥æº**ï¼šåŸºäºç”¨æˆ·å½“å‰é€‰æ‹©çš„æ•°æ®
- **å±•ç¤ºæ–¹å¼**ï¼šå‰ç«¯åŠ¨æ€æ¸²æŸ“ï¼Œæ”¯æŒå®æ—¶æ›´æ–°
- **äº¤äº’ä½“éªŒ**ï¼šç”¨æˆ·é€‰æ‹©ä¸åŒitemï¼Œæ˜¾ç¤ºä¸åŒä¿¡æ¯

### ğŸ“ ä½¿ç”¨åœºæ™¯

#### 1. æ‚£è€…é—®è¯Šå·é€‰æ‹©åœºæ™¯
```go
OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "registration_number": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
        // ... æŸ¥è¯¢é€»è¾‘
        
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… ä¼ ç»Ÿèšåˆï¼šæ•°é‡ç»Ÿè®¡
                "æ‰¾åˆ°è®°å½•": fmt.Sprintf("%d æ¡", len(items)),
                
                // ğŸ†• text() èšåˆï¼šåŠ¨æ€å±•ç¤ºé€‰ä¸­æ‚£è€…ä¿¡æ¯
                "æ‚£è€…å§“å": "text(æ‚£è€…å§“å)",
                "å°±è¯Šæ¬¡æ•°": "text(å°±è¯Šæ¬¡æ•°)",
                "ä¸Šæ¬¡å°±è¯Š": "text(ä¸Šæ¬¡å°±è¯Šæ—¶é—´)",
                "ä¸Šæ¬¡åŒ»å˜±": "text(ä¸Šæ¬¡åŒ»å˜±è®°å½•)",
                "æŒ‚å·å¤‡æ³¨": "text(æŒ‚å·å¤‡æ³¨)",
            },
            Values: items,
        }, nil
    },
}
```

#### 2. å•†å“é€‰æ‹©åœºæ™¯
```go
OnInputFuzzyMap: map[string]runner.OnInputFuzzy{
    "product_id": func(ctx *runner.Context, req *usercall.OnInputFuzzyReq) (*usercall.OnInputFuzzyResp, error) {
        // ... æŸ¥è¯¢é€»è¾‘
        
        return &usercall.OnInputFuzzyResp{
            Statistics: map[string]interface{}{
                // âœ… ä¼ ç»Ÿèšåˆï¼šä»·æ ¼è®¡ç®—
                "å•†å“æ€»ä»·": "sum(å•ä»·,*quantity)",
                "è¯å“ç§ç±»": "count(å•ä»·)",
                
                // ğŸ†• text() èšåˆï¼šåŠ¨æ€å±•ç¤ºé€‰ä¸­å•†å“è¯¦æƒ…
                "å•†å“åç§°": "text(å•†å“åç§°)",
                "è§„æ ¼ä¿¡æ¯": "text(è§„æ ¼)",
                "ç”Ÿäº§å‚å®¶": "text(ç”Ÿäº§å‚å®¶)",
                "åº“å­˜çŠ¶æ€": "text(åº“å­˜çŠ¶æ€)",
            },
            Values: items,
        }, nil
    },
}
```

### ğŸ’¡ è®¾è®¡ä¼˜åŠ¿

#### 1. **åŠ¨æ€ä¿¡æ¯å±•ç¤º**
- ç”¨æˆ·é€‰æ‹©ä¸åŒitemï¼Œæ˜¾ç¤ºä¸åŒä¿¡æ¯
- æ¯”é™æ€Statisticsæ›´æœ‰ä»·å€¼
- æ”¯æŒå¤æ‚çš„æ•°æ®å…³è”å±•ç¤º

#### 2. **ç”¨æˆ·ä½“éªŒæå‡**
- å®æ—¶åé¦ˆé€‰ä¸­itemçš„è¯¦ç»†ä¿¡æ¯
- å‡å°‘ç”¨æˆ·é¢å¤–æŸ¥è¯¢æ“ä½œ
- æä¾›ä¸Šä¸‹æ–‡ç›¸å…³çš„ä¿¡æ¯

#### 3. **ä¸šåŠ¡é€»è¾‘å¢å¼º**
- å¯ä»¥å±•ç¤ºå…³è”æ•°æ®ï¼ˆå¦‚æ‚£è€…å°±è¯Šå†å²ï¼‰
- æ”¯æŒæ¡ä»¶åŒ–ä¿¡æ¯å±•ç¤º
- å®ç°çœŸæ­£çš„æ™ºèƒ½æç¤º

### âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹

#### 1. **å­—æ®µå¯¹åº”å…³ç³»**
- `text(å­—æ®µå)` ä¸­çš„å­—æ®µåå¿…é¡»ä¸DisplayInfoä¸­çš„keyå®Œå…¨ä¸€è‡´
- å‰ç«¯ä¼šæ ¹æ®è¿™ä¸ªå¯¹åº”å…³ç³»åŠ¨æ€å±•ç¤ºä¿¡æ¯

#### 2. **æ€§èƒ½è€ƒè™‘**
- é¿å…åœ¨DisplayInfoä¸­æ”¾ç½®è¿‡å¤šæ•°æ®
- ä¼˜å…ˆå±•ç¤ºç”¨æˆ·æœ€éœ€è¦çš„ä¿¡æ¯
- å¤æ‚å…³è”æŸ¥è¯¢è€ƒè™‘ç¼“å­˜ç­–ç•¥

#### 3. **ä¿¡æ¯ä¸€è‡´æ€§**
- ç¡®ä¿DisplayInfoä¸­çš„æ•°æ®ä¸text()èšåˆç»“æœä¸€è‡´
- é¿å…ä¿¡æ¯å†²çªæˆ–è¯¯å¯¼ç”¨æˆ·

### ğŸ† æœ€ä½³å®è·µ

#### 1. **ç»„åˆä½¿ç”¨ç­–ç•¥**
```go
Statistics: map[string]interface{}{
    // ä¼ ç»Ÿèšåˆï¼šæ•°é‡ã€é‡‘é¢ç­‰ç»Ÿè®¡
    "æ‰¾åˆ°è®°å½•": fmt.Sprintf("%d æ¡", len(items)),
    "å•†å“æ€»ä»·": "sum(å•ä»·,*quantity)",
    
    // text() èšåˆï¼šé€‰ä¸­itemçš„è¯¦ç»†ä¿¡æ¯
    "æ‚£è€…å§“å": "text(æ‚£è€…å§“å)",
    "å°±è¯Šå†å²": "text(å°±è¯Šæ¬¡æ•°)",
    "åŒ»å˜±è®°å½•": "text(ä¸Šæ¬¡åŒ»å˜±)",
}
```

#### 2. **ä¿¡æ¯å±‚æ¬¡è®¾è®¡**
- **ç¬¬ä¸€å±‚**ï¼šä¼ ç»Ÿèšåˆï¼ˆæ•°é‡ã€é‡‘é¢ç­‰ï¼‰
- **ç¬¬äºŒå±‚**ï¼štext() èšåˆï¼ˆé€‰ä¸­itemçš„å…³é”®ä¿¡æ¯ï¼‰
- **ç¬¬ä¸‰å±‚**ï¼šDisplayInfoï¼ˆå®Œæ•´çš„è¯¦ç»†ä¿¡æ¯ï¼‰

#### 3. **ä¸šåŠ¡åœºæ™¯é€‚é…**
- **é—®è¯Šåœºæ™¯**ï¼šæ‚£è€…ä¿¡æ¯ã€å°±è¯Šå†å²ã€åŒ»å˜±è®°å½•
- **å•†å“åœºæ™¯**ï¼šå•†å“è¯¦æƒ…ã€åº“å­˜çŠ¶æ€ã€ä»·æ ¼ä¿¡æ¯
- **ç”¨æˆ·åœºæ™¯**ï¼šç”¨æˆ·ä¿¡æ¯ã€æƒé™çŠ¶æ€ã€æ“ä½œè®°å½•

## ğŸ† æœ€ä½³å®è·µå‚è€ƒ

**æ¨èå­¦ä¹ **ï¼š`simple_cashier_system.go` - ç®€åŒ–æ”¶é“¶ç³»ç»Ÿ

è¿™ä¸ªæ–‡ä»¶æ˜¯èšåˆè®¡ç®—åŠŸèƒ½çš„æœ€ä½³å®è·µç¤ºä¾‹ï¼Œå®Œç¾å±•ç°äº†ï¼š

### âœ… ä¼˜ç§€çš„è®¾è®¡ç‰¹ç‚¹

1. **Listç»„ä»¶èšåˆè®¡ç®—**ï¼š
   - ç”¨æˆ·æ·»åŠ å¤šè¡Œå•†å“æ—¶ï¼Œå‰ç«¯å®æ—¶è®¡ç®—æ€»ä»·ã€æŠ˜æ‰£ä»·ã€ä¼˜æƒ é‡‘é¢
   - æ¯ä¸ªç»Ÿè®¡ä¿¡æ¯éƒ½å¯¹æ”¶é“¶å‘˜æœ‰å®é™…ä»·å€¼

2. **ä¿¡æ¯ç²¾ç®€ä¸”å®ç”¨**ï¼š
   - åªæ˜¾ç¤º5ä¸ªæ ¸å¿ƒç»Ÿè®¡ï¼šåŸä»·ã€ä¼šå‘˜ä»·ã€ä¼˜æƒ é‡‘é¢ã€å•†å“ç§ç±»ã€å•†å“æ€»æ•°
   - é¿å…äº†ä¿¡æ¯è¿‡è½½ï¼Œç”¨æˆ·ä¸€ç›®äº†ç„¶

3. **é™æ€ä¿¡æ¯æœ‰ä»·å€¼**ï¼š
   - "ä¼šå‘˜æŠ˜æ‰£": "9æŠ˜ä¼˜æƒ " - æ˜ç¡®çš„æŠ˜æ‰£è¯´æ˜
   - "é…é€è¯´æ˜": "æ»¡99å…ƒåŒ…é‚®" - å®ç”¨çš„ä¸šåŠ¡è§„åˆ™

4. **å‰ç«¯å®æ—¶ä½“éªŒ**ï¼š
   - ç”¨æˆ·æ¯æ¬¡æ·»åŠ å•†å“ï¼Œå‰ç«¯ç«‹å³æ›´æ–°æ‰€æœ‰ç»Ÿè®¡æ•°æ®
   - å¸®åŠ©æ”¶é“¶å‘˜å’Œé¡¾å®¢å®æ—¶äº†è§£è´­ä¹°æƒ…å†µ

### ğŸ“š å­¦ä¹ è¦ç‚¹

- **ä¸šåŠ¡åœºæ™¯é©±åŠ¨**ï¼šæ‰€æœ‰èšåˆä¿¡æ¯éƒ½æœåŠ¡äºæ”¶é“¶åœºæ™¯
- **ç”¨æˆ·ä»·å€¼ä¼˜å…ˆ**ï¼šæ¯ä¸ªç»Ÿè®¡éƒ½èƒ½å¸®åŠ©ç”¨æˆ·åšå†³ç­–
- **æŠ€æœ¯æœåŠ¡ä¸šåŠ¡**ï¼šèšåˆè®¡ç®—å®Œç¾æ”¯æ’‘äº†æ”¶é“¶ä¸šåŠ¡æµç¨‹

**å»ºè®®**ï¼šåœ¨å®ç°ç±»ä¼¼åŠŸèƒ½æ—¶ï¼Œå‚è€ƒè¿™ä¸ªæ”¶é“¶ç³»ç»Ÿçš„è®¾è®¡æ€è·¯å’Œä¿¡æ¯é€‰æ‹©åŸåˆ™ã€‚

## ğŸš€ æ–°åŠŸèƒ½å±•æœ›

### text() èšåˆå‡½æ•°çš„åº”ç”¨å‰æ™¯

#### 1. **åŒ»ç–—åœºæ™¯**
- æ‚£è€…é€‰æ‹©ï¼šåŠ¨æ€å±•ç¤ºå°±è¯Šå†å²ã€è¿‡æ•å²ã€ç”¨è¯è®°å½•
- åŒ»ç”Ÿé€‰æ‹©ï¼šæ˜¾ç¤ºä¸“ä¸šç‰¹é•¿ã€å‡ºè¯Šæ—¶é—´ã€è”ç³»æ–¹å¼
- è¯å“é€‰æ‹©ï¼šå±•ç¤ºè§„æ ¼ã€ç”¨æ³•ã€æ³¨æ„äº‹é¡¹

#### 2. **ç”µå•†åœºæ™¯**
- å•†å“é€‰æ‹©ï¼šåŠ¨æ€å±•ç¤ºåº“å­˜ã€ä»·æ ¼ã€è¯„ä»·ã€è§„æ ¼
- ç”¨æˆ·é€‰æ‹©ï¼šæ˜¾ç¤ºä¼šå‘˜ç­‰çº§ã€æ¶ˆè´¹è®°å½•ã€åå¥½åˆ†æ
- è®¢å•é€‰æ‹©ï¼šå±•ç¤ºç‰©æµçŠ¶æ€ã€æ”¯ä»˜ä¿¡æ¯ã€å•†å“è¯¦æƒ…

#### 3. **ä¼ä¸šåœºæ™¯**
- å‘˜å·¥é€‰æ‹©ï¼šæ˜¾ç¤ºéƒ¨é—¨ã€èŒä½ã€è”ç³»æ–¹å¼ã€å·¥ä½œçŠ¶æ€
- å®¢æˆ·é€‰æ‹©ï¼šå±•ç¤ºåˆä½œå†å²ã€ä¿¡ç”¨ç­‰çº§ã€è”ç³»è®°å½•
- é¡¹ç›®é€‰æ‹©ï¼šæ˜¾ç¤ºè¿›åº¦ã€è´Ÿè´£äººã€é¢„ç®—ã€é£é™©ç­‰çº§

### ğŸ”® æŠ€æœ¯å‘å±•æ–¹å‘

#### 1. **æ™ºèƒ½æ¨è**
- åŸºäºç”¨æˆ·é€‰æ‹©å†å²ï¼ŒåŠ¨æ€æ¨èç›¸å…³ä¿¡æ¯
- å®ç°çœŸæ­£çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥ä¿¡æ¯å±•ç¤º

#### 2. **æ•°æ®å…³è”**
- æ”¯æŒè·¨è¡¨æ•°æ®å…³è”å±•ç¤º
- å®ç°å¤æ‚ä¸šåŠ¡é€»è¾‘çš„ä¿¡æ¯èšåˆ

#### 3. **ç”¨æˆ·ä½“éªŒ**
- å‡å°‘ç”¨æˆ·æ“ä½œæ­¥éª¤
- æä¾›æ›´æ™ºèƒ½ã€æ›´ä¸ªæ€§åŒ–çš„ä¿¡æ¯å±•ç¤º